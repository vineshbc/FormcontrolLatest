{"remainingRequest":"/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/babel-loader/lib/index.js!/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/ts-loader/index.js??ref--14-2!/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/mobiotics/Projects/hancom/FormcontrolLatest/src/FormDesigner/components/organisms/FDHeader/index.vue?vue&type=script&lang=ts&","dependencies":[{"path":"/home/mobiotics/Projects/hancom/FormcontrolLatest/src/FormDesigner/components/organisms/FDHeader/index.vue","mtime":1612197584000},{"path":"/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IHsgX19kZWNvcmF0ZSB9IGZyb20gInRzbGliIjsKaW1wb3J0IHsgQ29tcG9uZW50IH0gZnJvbSAndnVlLXByb3BlcnR5LWRlY29yYXRvcic7CmltcG9ydCB7IFN0YXRlLCBBY3Rpb24gfSBmcm9tICd2dWV4LWNsYXNzJzsKaW1wb3J0IHsgQ29udHJvbFByb3BlcnR5RGF0YSB9IGZyb20gJ0AvRm9ybURlc2lnbmVyL21vZGVscy9Db250cm9sc1RhYmxlUHJvcGVydGllcy9Db250cm9sUHJvcGVydHlEYXRhJzsKaW1wb3J0IEN1dExvZ28gZnJvbSAnLi4vLi4vLi4vLi4vYXNzZXRzL2N1dC5zdmcnOwppbXBvcnQgRmlsZVNhdmVMb2dvIGZyb20gJy4uLy4uLy4uLy4uL2Fzc2V0cy9maWxlLXNhdmUuc3ZnJzsKaW1wb3J0IENvcHlMb2dvIGZyb20gJy4uLy4uLy4uLy4uL2Fzc2V0cy9jb3B5LnN2Zyc7CmltcG9ydCBQYXN0ZUxvZ28gZnJvbSAnLi4vLi4vLi4vLi4vYXNzZXRzL3Bhc3RlLnN2Zyc7CmltcG9ydCBGaW5kTG9nbyBmcm9tICcuLi8uLi8uLi8uLi9hc3NldHMvZmluZC5zdmcnOwppbXBvcnQgVW5kb0xvZ28gZnJvbSAnLi4vLi4vLi4vLi4vYXNzZXRzL3VuZG8uc3ZnJzsKaW1wb3J0IFJlZG9Mb2dvIGZyb20gJy4uLy4uLy4uLy4uL2Fzc2V0cy9yZWRvLnN2Zyc7CmltcG9ydCBEZXNpZ25Nb2RlTG9nbyBmcm9tICcuLi8uLi8uLi8uLi9hc3NldHMvZGVzaWduLW1vZGUuc3ZnJzsKaW1wb3J0IFBqRXhwbG9yZXJMb2dvIGZyb20gJy4uLy4uLy4uLy4uL2Fzc2V0cy9wai1leHBsb3Jlci5zdmcnOwppbXBvcnQgUGpQcm9wZXJ0eUxvZ28gZnJvbSAnLi4vLi4vLi4vLi4vYXNzZXRzL3BqLXByb3BlcnR5LnN2Zyc7CmltcG9ydCBPYmpCcm93c2VyTG9nbyBmcm9tICcuLi8uLi8uLi8uLi9hc3NldHMvb2JqLWJyb3dzZXIuc3ZnJzsKaW1wb3J0IFRvb2xCb3hMb2dvIGZyb20gJy4uLy4uLy4uLy4uL2Fzc2V0cy90b29sLWJveC5zdmcnOwppbXBvcnQgVXNlckZvcm1Mb2dvIGZyb20gJy4uLy4uLy4uLy4uL2Fzc2V0cy91c2VyLWZyb20uc3ZnJzsKaW1wb3J0IEhlbHBMb2dvIGZyb20gJy4uLy4uLy4uLy4uL2Fzc2V0cy9oZWxwLnN2Zyc7CmltcG9ydCBDb2RlTG9nbyBmcm9tICcuLi8uLi8uLi8uLi9hc3NldHMvdmlldy1jb2RlLnN2Zyc7CmltcG9ydCBPYmplY3RMb2dvIGZyb20gJy4uLy4uLy4uLy4uL2Fzc2V0cy92aWV3LW9iamVjdC5zdmcnOwppbXBvcnQgRkRTVkdJbWFnZSBmcm9tICdAL0Zvcm1EZXNpZ25lci9jb21wb25lbnRzL2F0b21zL0ZEU1ZHSW1hZ2UvaW5kZXgudnVlJzsKaW1wb3J0IHsgRXZlbnRCdXMgfSBmcm9tICdAL0Zvcm1EZXNpZ25lci9ldmVudC1idXMnOwppbXBvcnQgRkRDb21tb25NZXRob2QgZnJvbSAnQC9hcGkvYWJzdHJhY3QvRm9ybURlc2lnbmVyL0ZEQ29tbW9uTWV0aG9kJzsKbGV0IEhlYWRlciA9IGNsYXNzIEhlYWRlciBleHRlbmRzIEZEQ29tbW9uTWV0aG9kIHsKICBjb25zdHJ1Y3RvcigpIHsKICAgIHN1cGVyKC4uLmFyZ3VtZW50cyk7CiAgICB0aGlzLmRpc3BsYXlTdWJNZW51ID0gZmFsc2U7CiAgICB0aGlzLnByb3BDb250cm9sRGF0YSA9IHt9OwogICAgdGhpcy51c2VyRm9ybUlkID0gJ0lEX1VTRVJGT1JNMSc7CiAgICB0aGlzLmdyaWRTaXplID0gOTsKICB9CgogIGluc2VydFVzZXJGb3JtKCkgewogICAgdGhpcy5wcm9wQ29udHJvbERhdGEgPSB0aGlzLnVzZXJmb3JtRGF0YTsKICAgIGNvbnN0IHVzZXJmb3JtID0gbmV3IENvbnRyb2xQcm9wZXJ0eURhdGEoKTsKICAgIGNvbnN0IHVzZXJGb3JtSWQgPSBgSURfVVNFUkZPUk0ke09iamVjdC5rZXlzKHRoaXMudXNlcmZvcm1EYXRhKS5sZW5ndGggKyAxfWA7CiAgICBjb25zdCBOYW1lID0gYFVzZXJGb3JtJHtPYmplY3Qua2V5cyh0aGlzLnVzZXJmb3JtRGF0YSkubGVuZ3RoICsgMX1gOwogICAgY29uc3QgQ2FwdGlvbiA9IGBVc2VyRm9ybSR7T2JqZWN0LmtleXModGhpcy51c2VyZm9ybURhdGEpLmxlbmd0aCArIDF9YDsKICAgIGNvbnN0IElEID0gT2JqZWN0LmtleXModGhpcy51c2VyZm9ybURhdGEpLmxlbmd0aCArIDE7CiAgICB0aGlzLmFkZENvbnRyb2woewogICAgICB0YXJnZXQ6IHRoaXMsCiAgICAgIGtleTogdXNlckZvcm1JZCwKICAgICAgdmFsdWU6IHsKICAgICAgICBwcm9wZXJ0aWVzOiB7IC4uLnVzZXJmb3JtLmRhdGEuVXNlckZvcm0sCiAgICAgICAgICBOYW1lOiBOYW1lLAogICAgICAgICAgSUQ6IElELAogICAgICAgICAgQ2FwdGlvbjogQ2FwdGlvbgogICAgICAgIH0sCiAgICAgICAgY29udHJvbHM6IFtdLAogICAgICAgIGV4dHJhRGF0YXM6IHsKICAgICAgICAgIGRpc3BsYXk6ICdub25lJwogICAgICAgIH0sCiAgICAgICAgdHlwZTogJ1VzZXJmb3JtJwogICAgICB9CiAgICB9KTsKICB9CgogIHN1Yk1lbnVEaXNwbGF5KCkgewogICAgdGhpcy5kaXNwbGF5U3ViTWVudSA9ICF0aGlzLmRpc3BsYXlTdWJNZW51OwogIH0KCiAgY2xpY2tDaGFuZ2VNb2RlKCkgewogICAgdGhpcy5jaGFuZ2VSdW5Nb2RlKCF0aGlzLmlzUnVuTW9kZSk7CiAgfQoKICBtYWtlRXF1YWwodHlwZSkgewogICAgY29uc3QgdXNyRnJtRGF0YSA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF07CiAgICBjb25zdCBjdHJsU2VsID0gdGhpcy5zZWxlY3RlZENvbnRyb2xzW3RoaXMudXNlckZvcm1JZF0uc2VsZWN0ZWQ7CiAgICBjb25zdCBjdHJsQ29udGFpbmVyID0gdGhpcy5zZWxlY3RlZENvbnRyb2xzW3RoaXMudXNlckZvcm1JZF0uY29udGFpbmVyWzBdOwogICAgY29uc3QgY29udHJvbHMgPSB1c3JGcm1EYXRhW2N0cmxDb250YWluZXJdLmNvbnRyb2xzOwogICAgbGV0IGRpdnN0eWxlID0gW107CiAgICBsZXQgZ2V0R3JvdXBJbmRleCA9IC0xOwogICAgRXZlbnRCdXMuJGVtaXQoJ2dldEdyb3VwU2l6ZScsIGRpdnN0YXlsZUFycmF5ID0+IHsKICAgICAgZGl2c3R5bGUgPSBkaXZzdGF5bGVBcnJheTsKICAgIH0pOwoKICAgIGlmIChjdHJsU2VsWzBdLnN0YXJ0c1dpdGgoJ2dyb3VwJykpIHsKICAgICAgZ2V0R3JvdXBJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFNlbFswXSk7CiAgICB9CgogICAgbGV0IHByb3BWYWx1ZSA9IDA7CiAgICBjb25zdCBsZWZ0QXJyYXkgPSBbXTsKICAgIGNvbnN0IHJpZ2h0QXJyYXkgPSBbXTsKCiAgICBmb3IgKGxldCBpbmRleCA9IDE7IGluZGV4IDwgY3RybFNlbC5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgY29uc3Qgc2VsTGVmdCA9IGN0cmxTZWxbMF0uc3RhcnRzV2l0aCgnZ3JvdXAnKSA/IHBhcnNlSW50KGRpdnN0eWxlW2dldEdyb3VwSW5kZXhdLmxlZnQpIDogdXNyRnJtRGF0YVtjdHJsU2VsWzBdXS5wcm9wZXJ0aWVzLkxlZnQ7CiAgICAgIGNvbnN0IHNlbFRvcCA9IGN0cmxTZWxbMF0uc3RhcnRzV2l0aCgnZ3JvdXAnKSA/IHBhcnNlSW50KGRpdnN0eWxlW2dldEdyb3VwSW5kZXhdLnRvcCkgOiB1c3JGcm1EYXRhW2N0cmxTZWxbMF1dLnByb3BlcnRpZXMuVG9wOwoKICAgICAgaWYgKCFjdHJsU2VsW2luZGV4XS5zdGFydHNXaXRoKCdncm91cCcpKSB7CiAgICAgICAgY29uc3QgY3RybFByb3AgPSB1c3JGcm1EYXRhW2N0cmxTZWxbaW5kZXhdXS5wcm9wZXJ0aWVzOwoKICAgICAgICBpZiAodHlwZSA9PT0gJ0xlZnQnKSB7CiAgICAgICAgICBpZiAoY3RybFByb3AuTGVmdCA8PSBzZWxMZWZ0KSB7CiAgICAgICAgICAgIGxlZnRBcnJheS5wdXNoKGN0cmxTZWxbaW5kZXhdKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJpZ2h0QXJyYXkucHVzaChjdHJsU2VsW2luZGV4XSk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnVG9wJykgewogICAgICAgICAgaWYgKGN0cmxQcm9wLlRvcCA8PSBzZWxUb3ApIHsKICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybFNlbFtpbmRleF0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmlnaHRBcnJheS5wdXNoKGN0cmxTZWxbaW5kZXhdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ2dldEdyb3VwU2l6ZScsIGRpdnN0YXlsZUFycmF5ID0+IHsKICAgICAgICAgIGRpdnN0eWxlID0gZGl2c3RheWxlQXJyYXk7CiAgICAgICAgfSk7CiAgICAgICAgY29uc3QgZ2V0SW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IGN0cmxTZWxbaW5kZXhdKTsKICAgICAgICBjb25zdCBncm91cExlZnQgPSBwYXJzZUludChkaXZzdHlsZVtnZXRJbmRleF0ubGVmdCk7CiAgICAgICAgY29uc3QgZ3JvdXBUb3AgPSBwYXJzZUludChkaXZzdHlsZVtnZXRJbmRleF0udG9wKTsKICAgICAgICBjb25zdCBncm91cENvbnJvbCA9IHRoaXMuZ2V0R3JvdXBDb250cm9sKGN0cmxTZWxbaW5kZXhdKTsKCiAgICAgICAgaWYgKHR5cGUgPT09ICdMZWZ0JykgewogICAgICAgICAgaWYgKGdyb3VwTGVmdCA8PSBzZWxMZWZ0KSB7CiAgICAgICAgICAgIGZvciAobGV0IGN0cmwgb2YgZ3JvdXBDb25yb2wpIHsKICAgICAgICAgICAgICBjb25zdCBwcm9wID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXVtjdHJsXS5wcm9wZXJ0aWVzOwoKICAgICAgICAgICAgICBpZiAoTWF0aC5mbG9vcihwcm9wLkxlZnQpID09PSBncm91cExlZnQpIHsKICAgICAgICAgICAgICAgIGxlZnRBcnJheS5wdXNoKGN0cmwpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChsZXQgY3RybCBvZiBncm91cENvbnJvbCkgewogICAgICAgICAgICAgIGNvbnN0IHByb3AgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdW2N0cmxdLnByb3BlcnRpZXM7CgogICAgICAgICAgICAgIGlmIChNYXRoLmZsb29yKHByb3AuTGVmdCkgPT09IGdyb3VwTGVmdCkgewogICAgICAgICAgICAgICAgcmlnaHRBcnJheS5wdXNoKGN0cmwpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ1RvcCcpIHsKICAgICAgICAgIGlmIChncm91cFRvcCA8PSBzZWxUb3ApIHsKICAgICAgICAgICAgZm9yIChsZXQgY3RybCBvZiBncm91cENvbnJvbCkgewogICAgICAgICAgICAgIGNvbnN0IHByb3AgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdW2N0cmxdLnByb3BlcnRpZXM7CgogICAgICAgICAgICAgIGlmIChNYXRoLmZsb29yKHByb3AuVG9wKSA9PT0gZ3JvdXBUb3ApIHsKICAgICAgICAgICAgICAgIGxlZnRBcnJheS5wdXNoKGN0cmwpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZm9yIChsZXQgY3RybCBvZiBncm91cENvbnJvbCkgewogICAgICAgICAgICAgIGNvbnN0IHByb3AgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdW2N0cmxdLnByb3BlcnRpZXM7CgogICAgICAgICAgICAgIGlmIChNYXRoLmZsb29yKHByb3AuVG9wKSA9PT0gZ3JvdXBUb3ApIHsKICAgICAgICAgICAgICAgIHJpZ2h0QXJyYXkucHVzaChjdHJsKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBpZiAoY3RybFNlbFswXS5zdGFydHNXaXRoKCdncm91cCcpKSB7CiAgICAgIGNvbnN0IGdldEluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBjdHJsU2VsWzBdKTsKICAgICAgY29uc3QgZ3JvdXBMZWZ0ID0gcGFyc2VJbnQoZGl2c3R5bGVbZ2V0SW5kZXhdLmxlZnQpOwogICAgICBjb25zdCBncm91cFRvcCA9IHBhcnNlSW50KGRpdnN0eWxlW2dldEluZGV4XS50b3ApOwogICAgICBjb25zdCBncm91cENvbnJvbCA9IHRoaXMuZ2V0R3JvdXBDb250cm9sKGN0cmxTZWxbMF0pOwoKICAgICAgaWYgKHR5cGUgPT09ICdMZWZ0JykgewogICAgICAgIGZvciAobGV0IGN0cmwgb2YgZ3JvdXBDb25yb2wpIHsKICAgICAgICAgIGNvbnN0IHByb3AgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdW2N0cmxdLnByb3BlcnRpZXM7CgogICAgICAgICAgaWYgKE1hdGguZmxvb3IocHJvcC5MZWZ0KSA9PT0gZ3JvdXBMZWZ0KSB7CiAgICAgICAgICAgIGxlZnRBcnJheS5wdXNoKGN0cmwpOwogICAgICAgICAgICByaWdodEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdUb3AnKSB7CiAgICAgICAgZm9yIChsZXQgY3RybCBvZiBncm91cENvbnJvbCkgewogICAgICAgICAgY29uc3QgcHJvcCA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY3RybF0ucHJvcGVydGllczsKCiAgICAgICAgICBpZiAoTWF0aC5mbG9vcihwcm9wLlRvcCkgPT09IGdyb3VwVG9wKSB7CiAgICAgICAgICAgIGxlZnRBcnJheS5wdXNoKGN0cmwpOwogICAgICAgICAgICByaWdodEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9IGVsc2UgewogICAgICBsZWZ0QXJyYXkudW5zaGlmdChjdHJsU2VsWzBdKTsKICAgICAgcmlnaHRBcnJheS5wdXNoKGN0cmxTZWxbMF0pOwogICAgfQoKICAgIGlmICh0eXBlID09PSAnTGVmdCcpIHsKICAgICAgbGVmdEFycmF5LnNvcnQoKGEsIGIpID0+IHsKICAgICAgICByZXR1cm4gdXNyRnJtRGF0YVthXS5wcm9wZXJ0aWVzLkxlZnQgLSB1c3JGcm1EYXRhW2JdLnByb3BlcnRpZXMuTGVmdDsKICAgICAgfSk7CiAgICAgIHJpZ2h0QXJyYXkuc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiB1c3JGcm1EYXRhW2FdLnByb3BlcnRpZXMuTGVmdCAtIHVzckZybURhdGFbYl0ucHJvcGVydGllcy5MZWZ0OwogICAgICB9KTsKICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ1RvcCcpIHsKICAgICAgbGVmdEFycmF5LnNvcnQoKGEsIGIpID0+IHsKICAgICAgICByZXR1cm4gdXNyRnJtRGF0YVthXS5wcm9wZXJ0aWVzLlRvcCAtIHVzckZybURhdGFbYl0ucHJvcGVydGllcy5Ub3A7CiAgICAgIH0pOwogICAgICByaWdodEFycmF5LnNvcnQoKGEsIGIpID0+IHsKICAgICAgICByZXR1cm4gdXNyRnJtRGF0YVthXS5wcm9wZXJ0aWVzLlRvcCAtIHVzckZybURhdGFbYl0ucHJvcGVydGllcy5Ub3A7CiAgICAgIH0pOwogICAgfQoKICAgIGxldCBsZWZ0Q29udHJvbCA9IHsgLi4udXNyRnJtRGF0YVtsZWZ0QXJyYXlbMF1dLnByb3BlcnRpZXMKICAgIH07CgogICAgaWYgKGxlZnRDb250cm9sLkdyb3VwSUQgIT09ICcnKSB7CiAgICAgIGNvbnN0IGdyb3VwSW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IGxlZnRDb250cm9sLkdyb3VwSUQpOwogICAgICBjb25zdCBncm91cFNpemUgPSBkaXZzdHlsZVtncm91cEluZGV4XTsKICAgICAgbGVmdENvbnRyb2wgPSB7IC4uLmxlZnRDb250cm9sLAogICAgICAgIFdpZHRoOiBwYXJzZUludChkaXZzdHlsZVtncm91cEluZGV4XS53aWR0aCksCiAgICAgICAgSGVpZ2h0OiBwYXJzZUludChkaXZzdHlsZVtncm91cEluZGV4XS5oZWlnaHQpLAogICAgICAgIExlZnQ6IHBhcnNlSW50KGRpdnN0eWxlW2dyb3VwSW5kZXhdLmxlZnQpLAogICAgICAgIFRvcDogcGFyc2VJbnQoZGl2c3R5bGVbZ3JvdXBJbmRleF0udG9wKQogICAgICB9OwogICAgfQoKICAgIGxldCByaWdodENvbnRyb2wgPSB7IC4uLnVzckZybURhdGFbcmlnaHRBcnJheVtyaWdodEFycmF5Lmxlbmd0aCAtIDFdXS5wcm9wZXJ0aWVzCiAgICB9OwoKICAgIGlmIChyaWdodENvbnRyb2wuR3JvdXBJRCAhPT0gJycpIHsKICAgICAgY29uc3QgZ3JvdXBJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gcmlnaHRDb250cm9sLkdyb3VwSUQpOwogICAgICBjb25zdCBncm91cFNpemUgPSBkaXZzdHlsZVtncm91cEluZGV4XTsKICAgICAgcmlnaHRDb250cm9sID0geyAuLi5sZWZ0Q29udHJvbCwKICAgICAgICBXaWR0aDogcGFyc2VJbnQoZGl2c3R5bGVbZ3JvdXBJbmRleF0ud2lkdGgpLAogICAgICAgIEhlaWdodDogcGFyc2VJbnQoZGl2c3R5bGVbZ3JvdXBJbmRleF0uaGVpZ2h0KSwKICAgICAgICBMZWZ0OiBwYXJzZUludChkaXZzdHlsZVtncm91cEluZGV4XS5sZWZ0KSwKICAgICAgICBUb3A6IHBhcnNlSW50KGRpdnN0eWxlW2dyb3VwSW5kZXhdLnRvcCkKICAgICAgfTsKICAgIH0KCiAgICBsZXQgdG90YWxTaXplID0gMDsKCiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgY3RybFNlbC5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgaWYgKHR5cGUgPT09ICdMZWZ0JykgewogICAgICAgIGlmICghY3RybFNlbFtpbmRleF0uc3RhcnRzV2l0aCgnZ3JvdXAnKSkgewogICAgICAgICAgY29uc3QgY3RybFByb3AgPSB1c3JGcm1EYXRhW2N0cmxTZWxbaW5kZXhdXS5wcm9wZXJ0aWVzOwogICAgICAgICAgdG90YWxTaXplID0gdG90YWxTaXplICsgY3RybFByb3AuV2lkdGg7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNvbnN0IGdyb3VwSW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IGN0cmxTZWxbaW5kZXhdKTsKICAgICAgICAgIHRvdGFsU2l6ZSA9IHRvdGFsU2l6ZSArIHBhcnNlSW50KGRpdnN0eWxlW2dyb3VwSW5kZXhdLndpZHRoKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ1RvcCcpIHsKICAgICAgICBpZiAoIWN0cmxTZWxbaW5kZXhdLnN0YXJ0c1dpdGgoJ2dyb3VwJykpIHsKICAgICAgICAgIGNvbnN0IGN0cmxQcm9wID0gdXNyRnJtRGF0YVtjdHJsU2VsW2luZGV4XV0ucHJvcGVydGllczsKICAgICAgICAgIHRvdGFsU2l6ZSA9IHRvdGFsU2l6ZSArIGN0cmxQcm9wLkhlaWdodDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgZ3JvdXBJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFNlbFtpbmRleF0pOwogICAgICAgICAgdG90YWxTaXplID0gdG90YWxTaXplICsgcGFyc2VJbnQoZGl2c3R5bGVbZ3JvdXBJbmRleF0uaGVpZ2h0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBsZXQgZGlmZnJlbmNlID0gMDsKCiAgICBpZiAodHlwZSA9PT0gJ0xlZnQnKSB7CiAgICAgIGRpZmZyZW5jZSA9IChyaWdodENvbnRyb2wuTGVmdCArIHJpZ2h0Q29udHJvbC5XaWR0aCAtIGxlZnRDb250cm9sLkxlZnQgLSB0b3RhbFNpemUpIC8gKGN0cmxTZWwubGVuZ3RoIC0gMSk7CiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdUb3AnKSB7CiAgICAgIGRpZmZyZW5jZSA9IChyaWdodENvbnRyb2wuVG9wICsgcmlnaHRDb250cm9sLkhlaWdodCAtIGxlZnRDb250cm9sLlRvcCAtIHRvdGFsU2l6ZSkgLyAoY3RybFNlbC5sZW5ndGggLSAxKTsKICAgIH0KCiAgICBjb25zdCB1bmlxdWUgPSAoKSA9PiB7CiAgICAgIHZhciBhID0gbGVmdEFycmF5LmNvbmNhdChyaWdodEFycmF5KTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYS5sZW5ndGg7ICsraSkgewogICAgICAgIGZvciAodmFyIGogPSBpICsgMTsgaiA8IGEubGVuZ3RoOyArK2opIHsKICAgICAgICAgIGlmIChhW2ldID09PSBhW2pdKSB7CiAgICAgICAgICAgIGEuc3BsaWNlKGotLSwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gYTsKICAgIH07CgogICAgY29uc3QgY29tYmluZUFycmF5ID0gdW5pcXVlKCk7CgogICAgZm9yIChsZXQgaW5kZXggPSAxOyBpbmRleCA8IGNvbWJpbmVBcnJheS5sZW5ndGggLSAxOyBpbmRleCsrKSB7CiAgICAgIGNvbnN0IHByZXZDdHJsUHJvcCA9IHVzckZybURhdGFbY29tYmluZUFycmF5W2luZGV4IC0gMV1dLnByb3BlcnRpZXM7CiAgICAgIGNvbnN0IGN0cmxQcm9wID0gdXNyRnJtRGF0YVtjb21iaW5lQXJyYXlbaW5kZXhdXS5wcm9wZXJ0aWVzOwogICAgICBsZXQgcHJldkluZGV4ID0gLTE7CiAgICAgIGNvbnN0IGNvbnRyb2xQcm9wSW5kZXggPSAtMTsKCiAgICAgIGlmICh0eXBlID09PSAnTGVmdCcpIHsKICAgICAgICBpZiAocHJldkN0cmxQcm9wLkdyb3VwSUQgPT09ICcnICYmIGN0cmxQcm9wLkdyb3VwSUQgPT09ICcnKSB7CiAgICAgICAgICBwcm9wVmFsdWUgPSBwcmV2Q3RybFByb3AuTGVmdCArIHByZXZDdHJsUHJvcC5XaWR0aCArIGRpZmZyZW5jZTsKICAgICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KHR5cGUsIHByb3BWYWx1ZSwgY29tYmluZUFycmF5W2luZGV4XSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChwcmV2Q3RybFByb3AuR3JvdXBJRCAhPT0gJycpIHsKICAgICAgICAgICAgcHJldkluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBwcmV2Q3RybFByb3AuR3JvdXBJRCk7CiAgICAgICAgICAgIHByb3BWYWx1ZSA9IHBhcnNlSW50KGRpdnN0eWxlW3ByZXZJbmRleF0ubGVmdCkgKyBwYXJzZUludChkaXZzdHlsZVtwcmV2SW5kZXhdLndpZHRoKSArIGRpZmZyZW5jZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHByb3BWYWx1ZSA9IHByZXZDdHJsUHJvcC5MZWZ0ICsgcHJldkN0cmxQcm9wLldpZHRoICsgZGlmZnJlbmNlOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjdHJsUHJvcC5Hcm91cElEICE9PSAnJykgewogICAgICAgICAgICBjb25zdCBnZXRJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFByb3AuR3JvdXBJRCk7CiAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCd1cGRhc3RlR3JvdXBTaXplJywgdHlwZSwgcHJvcFZhbHVlLCBnZXRJbmRleCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSh0eXBlLCBwcm9wVmFsdWUsIGNvbWJpbmVBcnJheVtpbmRleF0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodHlwZSA9PT0gJ1RvcCcpIHsKICAgICAgICAgIGlmIChwcmV2Q3RybFByb3AuR3JvdXBJRCA9PT0gJycgJiYgY3RybFByb3AuR3JvdXBJRCA9PT0gJycpIHsKICAgICAgICAgICAgcHJvcFZhbHVlID0gcHJldkN0cmxQcm9wLlRvcCArIHByZXZDdHJsUHJvcC5IZWlnaHQgKyBkaWZmcmVuY2U7CiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KHR5cGUsIHByb3BWYWx1ZSwgY29tYmluZUFycmF5W2luZGV4XSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAocHJldkN0cmxQcm9wLkdyb3VwSUQgIT09ICcnKSB7CiAgICAgICAgICAgICAgcHJldkluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBwcmV2Q3RybFByb3AuR3JvdXBJRCk7CiAgICAgICAgICAgICAgcHJvcFZhbHVlID0gcGFyc2VJbnQoZGl2c3R5bGVbcHJldkluZGV4XS50b3ApICsgcGFyc2VJbnQoZGl2c3R5bGVbcHJldkluZGV4XS5oZWlnaHQpICsgZGlmZnJlbmNlOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIHByb3BWYWx1ZSA9IHByZXZDdHJsUHJvcC5Ub3AgKyBwcmV2Q3RybFByb3AuSGVpZ2h0ICsgZGlmZnJlbmNlOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZiAoY3RybFByb3AuR3JvdXBJRCAhPT0gJycpIHsKICAgICAgICAgICAgICBjb25zdCBnZXRJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFByb3AuR3JvdXBJRCk7CiAgICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ3VwZGFzdGVHcm91cFNpemUnLCB0eXBlLCBwcm9wVmFsdWUsIGdldEluZGV4KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSh0eXBlLCBwcm9wVmFsdWUsIGNvbWJpbmVBcnJheVtpbmRleF0pOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBicmluZ0Zyb250KCkgewogICAgY29uc3QgdXNlckRhdGEgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdOwogICAgY29uc3QgaGlnaFByb3JDb250cm9sID0gW107CiAgICBjb25zdCBsb3dQcm9yQ29udHJvbCA9IFtdOwogICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5nZXRDb250YWluZXJMaXN0KHRoaXMuZ2V0U2VsZWN0ZWRDb250cm9sc0RhdGFzWzBdKVswXTsKICAgIGNvbnN0IGNvbnRhaW5lckNvbnRyb2xzID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXVtjb250YWluZXJdLmNvbnRyb2xzOwoKICAgIGZvciAoY29uc3QgaW5kZXggaW4gY29udGFpbmVyQ29udHJvbHMpIHsKICAgICAgY29uc3QgY250cmxEYXRhID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXVtjb250YWluZXJDb250cm9sc1tpbmRleF1dOwoKICAgICAgaWYgKGNudHJsRGF0YS50eXBlID09PSAnTXVsdGlQYWdlJyB8fCBjbnRybERhdGEudHlwZSA9PT0gJ0ZyYW1lJyB8fCBjbnRybERhdGEudHlwZSA9PT0gJ0xpc3RCb3gnKSB7CiAgICAgICAgaGlnaFByb3JDb250cm9sLnB1c2goY29udGFpbmVyQ29udHJvbHNbaW5kZXhdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsb3dQcm9yQ29udHJvbC5wdXNoKGNvbnRhaW5lckNvbnRyb2xzW2luZGV4XSk7CiAgICAgIH0KICAgIH0KCiAgICBsb3dQcm9yQ29udHJvbC5zb3J0KChhLCBiKSA9PiB7CiAgICAgIHJldHVybiB1c2VyRGF0YVthXS5leHRyYURhdGFzLnpJbmRleCAtIHVzZXJEYXRhW2JdLmV4dHJhRGF0YXMuekluZGV4OwogICAgfSk7CiAgICBsZXQgZ2V0TG93UHJvcEhpZ2hlc3RJbmRleCA9IGxvd1Byb3JDb250cm9sW2xvd1Byb3JDb250cm9sLmxlbmd0aCAtIDFdOwogICAgaGlnaFByb3JDb250cm9sLnNvcnQoKGEsIGIpID0+IHsKICAgICAgcmV0dXJuIHVzZXJEYXRhW2FdLmV4dHJhRGF0YXMuekluZGV4IC0gdXNlckRhdGFbYl0uZXh0cmFEYXRhcy56SW5kZXg7CiAgICB9KTsKICAgIGxldCBnZXRIaWdoUHJvcEhpZ2hlc3RJbmRleCA9IGhpZ2hQcm9yQ29udHJvbFtoaWdoUHJvckNvbnRyb2wubGVuZ3RoIC0gMV07CiAgICBjb25zdCBsb3dTZXJpZXNDb250cm9sID0gW107CiAgICBjb25zdCBoaWdoU2VyaWVzQ29udHJvbCA9IFtdOwogICAgY29uc3QgZ2V0U2VsQ29udHJvbCA9IFsuLi50aGlzLmdldFNlbGVjdGVkQ29udHJvbHNEYXRhc107CiAgICBnZXRTZWxDb250cm9sLnNvcnQoKGEsIGIpID0+IHsKICAgICAgcmV0dXJuIHVzZXJEYXRhW2FdLmV4dHJhRGF0YXMuekluZGV4IC0gdXNlckRhdGFbYl0uZXh0cmFEYXRhcy56SW5kZXg7CiAgICB9KTsKCiAgICBmb3IgKGNvbnN0IHNlbENvbnRyb2wgb2YgZ2V0U2VsQ29udHJvbCkgewogICAgICBpZiAobG93UHJvckNvbnRyb2wuaW5jbHVkZXMoc2VsQ29udHJvbCkpIHsKICAgICAgICBsb3dTZXJpZXNDb250cm9sLnB1c2goc2VsQ29udHJvbCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaGlnaFNlcmllc0NvbnRyb2wucHVzaChzZWxDb250cm9sKTsKICAgICAgfQogICAgfQoKICAgIGNvbnN0IHNldExvd1Byb3BIaWdoSW5kZXggPSBjb250cm9sID0+IHsKICAgICAgaWYgKGxvd1Nlcmllc0NvbnRyb2wubGVuZ3RoID4gMCAmJiBsb3dTZXJpZXNDb250cm9sLmluY2x1ZGVzKGNvbnRyb2wpKSB7CiAgICAgICAgbG93U2VyaWVzQ29udHJvbC5wb3AoKTsKICAgICAgICBjb25zdCBJbmRleCA9IGxvd1Byb3JDb250cm9sLmZpbmRJbmRleCh2YWwgPT4gdXNlckRhdGFbZ2V0TG93UHJvcEhpZ2hlc3RJbmRleF0uZXh0cmFEYXRhcy56SW5kZXggLSAxID09PSB1c2VyRGF0YVt2YWxdLmV4dHJhRGF0YXMuekluZGV4KTsKICAgICAgICBnZXRMb3dQcm9wSGlnaGVzdEluZGV4ID0gSW5kZXggIT09IC0xID8gbG93UHJvckNvbnRyb2xbSW5kZXhdIDogJyc7CgogICAgICAgIGlmIChJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIHNldExvd1Byb3BIaWdoSW5kZXgoZ2V0TG93UHJvcEhpZ2hlc3RJbmRleCk7CiAgICAgICAgfQogICAgICB9CiAgICB9OwoKICAgIHNldExvd1Byb3BIaWdoSW5kZXgoZ2V0TG93UHJvcEhpZ2hlc3RJbmRleCk7CiAgICBsb3dTZXJpZXNDb250cm9sLnNvcnQoKGEsIGIpID0+IHsKICAgICAgcmV0dXJuIHVzZXJEYXRhW2FdLmV4dHJhRGF0YXMuekluZGV4IC0gdXNlckRhdGFbYl0uZXh0cmFEYXRhcy56SW5kZXg7CiAgICB9KTsKCiAgICBpZiAobG93U2VyaWVzQ29udHJvbC5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnN0IGxvd2VzdFpJbmRleCA9IHVzZXJEYXRhW2xvd1Nlcmllc0NvbnRyb2xbMF1dLmV4dHJhRGF0YXMuekluZGV4OwogICAgICBsZXQgbmV4dFNlcmllcyA9IFtdOwogICAgICBsZXQgY291bnQgPSBsb3dTZXJpZXNDb250cm9sLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGRpZmYgPSB1c2VyRGF0YVtnZXRMb3dQcm9wSGlnaGVzdEluZGV4XS5leHRyYURhdGFzLnpJbmRleCAtIHVzZXJEYXRhW2xvd1Nlcmllc0NvbnRyb2xbbG93U2VyaWVzQ29udHJvbC5sZW5ndGggLSAxXV0uZXh0cmFEYXRhcy56SW5kZXg7CgogICAgICBmb3IgKGNvbnN0IGN0cmwgb2YgbG93U2VyaWVzQ29udHJvbCkgewogICAgICAgIGNvbnN0IG5leHRDb250cm9sID0gbG93U2VyaWVzQ29udHJvbC5maW5kSW5kZXgodmFsID0+ICd6SW5kZXgnIGluIHVzZXJEYXRhW3ZhbF0uZXh0cmFEYXRhcyAmJiB1c2VyRGF0YVtjdHJsXS5leHRyYURhdGFzLnpJbmRleCArIDEgPT09IHVzZXJEYXRhW3ZhbF0uZXh0cmFEYXRhcy56SW5kZXgpOwoKICAgICAgICBpZiAobmV4dENvbnRyb2wgIT09IC0xKSB7CiAgICAgICAgICBuZXh0U2VyaWVzLnB1c2goY3RybCk7CiAgICAgICAgICBjb3VudCA9IGNvdW50IC0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY29uc3QgZGlmZmVyZW5jZSA9IHVzZXJEYXRhW2dldExvd1Byb3BIaWdoZXN0SW5kZXhdLmV4dHJhRGF0YXMuekluZGV4IC0gY291bnQ7CiAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXMoY3RybCwgJ3pJbmRleCcsIGRpZmZlcmVuY2UpOwoKICAgICAgICAgIGlmIChuZXh0U2VyaWVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXh0U2VyaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgY29uc3QgZGlmZiA9IHVzZXJEYXRhW2N0cmxdLmV4dHJhRGF0YXMuekluZGV4IC0gKG5leHRTZXJpZXMubGVuZ3RoIC0gaSk7CiAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKG5leHRTZXJpZXNbaV0sICd6SW5kZXgnLCBkaWZmKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dFNlcmllcyA9IFtdOwogICAgICAgICAgfQoKICAgICAgICAgIGNvdW50ID0gY291bnQgLSAxOwogICAgICAgIH0KICAgICAgfQoKICAgICAgbGV0IGNvdW50ZXIgPSAwOwoKICAgICAgZm9yIChjb25zdCBjdHJsIG9mIGxvd1Byb3JDb250cm9sKSB7CiAgICAgICAgaWYgKCF0aGlzLmdldFNlbGVjdGVkQ29udHJvbHNEYXRhcy5pbmNsdWRlcyhjdHJsKSkgewogICAgICAgICAgY291bnRlciA9IGNvdW50ZXIgKyAxOwogICAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKGN0cmwsICd6SW5kZXgnLCBjb3VudGVyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBzZXRIaWdoUHJvcEhpZ2hJbmRleCA9IGNvbnRyb2wgPT4gewogICAgICBpZiAoaGlnaFNlcmllc0NvbnRyb2wubGVuZ3RoID4gMCAmJiBoaWdoU2VyaWVzQ29udHJvbC5pbmNsdWRlcyhjb250cm9sKSkgewogICAgICAgIGhpZ2hTZXJpZXNDb250cm9sLnBvcCgpOwogICAgICAgIGNvbnN0IEluZGV4ID0gaGlnaFByb3JDb250cm9sLmZpbmRJbmRleCh2YWwgPT4gdXNlckRhdGFbZ2V0SGlnaFByb3BIaWdoZXN0SW5kZXhdLmV4dHJhRGF0YXMuekluZGV4IC0gMSA9PT0gdXNlckRhdGFbdmFsXS5leHRyYURhdGFzLnpJbmRleCk7CiAgICAgICAgZ2V0SGlnaFByb3BIaWdoZXN0SW5kZXggPSBJbmRleCAhPT0gLTEgPyBoaWdoUHJvckNvbnRyb2xbSW5kZXhdIDogJyc7CgogICAgICAgIGlmIChJbmRleCAhPT0gLTEpIHsKICAgICAgICAgIHNldEhpZ2hQcm9wSGlnaEluZGV4KGdldEhpZ2hQcm9wSGlnaGVzdEluZGV4KTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CgogICAgc2V0SGlnaFByb3BIaWdoSW5kZXgoZ2V0SGlnaFByb3BIaWdoZXN0SW5kZXgpOwogICAgaGlnaFNlcmllc0NvbnRyb2wuc29ydCgoYSwgYikgPT4gewogICAgICByZXR1cm4gdXNlckRhdGFbYV0uZXh0cmFEYXRhcy56SW5kZXggLSB1c2VyRGF0YVtiXS5leHRyYURhdGFzLnpJbmRleDsKICAgIH0pOwoKICAgIGlmIChoaWdoU2VyaWVzQ29udHJvbC5sZW5ndGggPiAwKSB7CiAgICAgIGNvbnN0IGhpZ2hlc3RaSW5kZXggPSB1c2VyRGF0YVtoaWdoU2VyaWVzQ29udHJvbFswXV0uZXh0cmFEYXRhcy56SW5kZXg7CiAgICAgIGxldCBuZXh0U2VyaWVzID0gW107CiAgICAgIGxldCBjb3VudCA9IGhpZ2hTZXJpZXNDb250cm9sLmxlbmd0aCAtIDE7CiAgICAgIGNvbnN0IGRpZmYgPSB1c2VyRGF0YVtnZXRIaWdoUHJvcEhpZ2hlc3RJbmRleF0uZXh0cmFEYXRhcy56SW5kZXggLSB1c2VyRGF0YVtoaWdoU2VyaWVzQ29udHJvbFtoaWdoU2VyaWVzQ29udHJvbC5sZW5ndGggLSAxXV0uZXh0cmFEYXRhcy56SW5kZXg7CgogICAgICBmb3IgKGNvbnN0IGN0cmwgb2YgaGlnaFNlcmllc0NvbnRyb2wpIHsKICAgICAgICBjb25zdCBuZXh0Q29udHJvbCA9IGhpZ2hTZXJpZXNDb250cm9sLmZpbmRJbmRleCh2YWwgPT4gJ3pJbmRleCcgaW4gdXNlckRhdGFbdmFsXS5leHRyYURhdGFzICYmIHVzZXJEYXRhW2N0cmxdLmV4dHJhRGF0YXMuekluZGV4ICsgMSA9PT0gdXNlckRhdGFbdmFsXS5leHRyYURhdGFzLnpJbmRleCk7CgogICAgICAgIGlmIChuZXh0Q29udHJvbCAhPT0gLTEpIHsKICAgICAgICAgIG5leHRTZXJpZXMucHVzaChjdHJsKTsKICAgICAgICAgIGNvdW50ID0gY291bnQgLSAxOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zdCBkaWZmZXJlbmNlID0gdXNlckRhdGFbZ2V0SGlnaFByb3BIaWdoZXN0SW5kZXhdLmV4dHJhRGF0YXMuekluZGV4IC0gY291bnQ7CiAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXMoY3RybCwgJ3pJbmRleCcsIGRpZmZlcmVuY2UpOwoKICAgICAgICAgIGlmIChuZXh0U2VyaWVzLmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBuZXh0U2VyaWVzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgICAgY29uc3QgZGlmZiA9IHVzZXJEYXRhW2N0cmxdLmV4dHJhRGF0YXMuekluZGV4IC0gKG5leHRTZXJpZXMubGVuZ3RoIC0gaSk7CiAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKG5leHRTZXJpZXNbaV0sICd6SW5kZXgnLCBkaWZmKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dFNlcmllcyA9IFtdOwogICAgICAgICAgfQoKICAgICAgICAgIGNvdW50ID0gY291bnQgLSAxOwogICAgICAgIH0KICAgICAgfQoKICAgICAgbGV0IGNvdW50ZXIgPSAwOwoKICAgICAgZm9yIChjb25zdCBjdHJsIG9mIGhpZ2hQcm9yQ29udHJvbCkgewogICAgICAgIGlmICghdGhpcy5nZXRTZWxlY3RlZENvbnRyb2xzRGF0YXMuaW5jbHVkZXMoY3RybCkpIHsKICAgICAgICAgIGNvdW50ZXIgPSBjb3VudGVyICsgMTsKICAgICAgICAgIHRoaXMudXBkYXRlRXh0cmFEYXRhcyhjdHJsLCAnekluZGV4JywgY291bnRlcik7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBzZW5kQmFjaygpIHsKICAgIGNvbnN0IHVzZXJEYXRhID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXTsKICAgIGNvbnN0IGhpZ2hQcm9yQ29udHJvbCA9IFtdOwogICAgY29uc3QgbG93UHJvckNvbnRyb2wgPSBbXTsKICAgIGNvbnN0IGNvbnRhaW5lciA9IHRoaXMuZ2V0Q29udGFpbmVyTGlzdCh0aGlzLmdldFNlbGVjdGVkQ29udHJvbHNEYXRhc1swXSlbMF07CiAgICBjb25zdCBjb250YWluZXJDb250cm9scyA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY29udGFpbmVyXS5jb250cm9sczsKCiAgICBmb3IgKGNvbnN0IGluZGV4IGluIGNvbnRhaW5lckNvbnRyb2xzKSB7CiAgICAgIGNvbnN0IGNudHJsRGF0YSA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY29udGFpbmVyQ29udHJvbHNbaW5kZXhdXTsKCiAgICAgIGlmIChjbnRybERhdGEudHlwZSA9PT0gJ011bHRpUGFnZScgfHwgY250cmxEYXRhLnR5cGUgPT09ICdGcmFtZScgfHwgY250cmxEYXRhLnR5cGUgPT09ICdMaXN0Qm94JykgewogICAgICAgIGhpZ2hQcm9yQ29udHJvbC5wdXNoKGNvbnRhaW5lckNvbnRyb2xzW2luZGV4XSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbG93UHJvckNvbnRyb2wucHVzaChjb250YWluZXJDb250cm9sc1tpbmRleF0pOwogICAgICB9CiAgICB9CgogICAgbG93UHJvckNvbnRyb2wuc29ydCgoYSwgYikgPT4gewogICAgICByZXR1cm4gdXNlckRhdGFbYl0uZXh0cmFEYXRhcy56SW5kZXggLSB1c2VyRGF0YVthXS5leHRyYURhdGFzLnpJbmRleDsKICAgIH0pOwogICAgbGV0IGdldExvd1Byb3BIaWdoZXN0SW5kZXggPSBsb3dQcm9yQ29udHJvbFtsb3dQcm9yQ29udHJvbC5sZW5ndGggLSAxXTsKICAgIGhpZ2hQcm9yQ29udHJvbC5zb3J0KChhLCBiKSA9PiB7CiAgICAgIHJldHVybiB1c2VyRGF0YVtiXS5leHRyYURhdGFzLnpJbmRleCAtIHVzZXJEYXRhW2FdLmV4dHJhRGF0YXMuekluZGV4OwogICAgfSk7CiAgICBsZXQgZ2V0SGlnaFByb3BIaWdoZXN0SW5kZXggPSBoaWdoUHJvckNvbnRyb2xbaGlnaFByb3JDb250cm9sLmxlbmd0aCAtIDFdOwogICAgY29uc3QgbG93U2VyaWVzQ29udHJvbCA9IFtdOwogICAgY29uc3QgaGlnaFNlcmllc0NvbnRyb2wgPSBbXTsKICAgIGNvbnN0IGdldFNlbENvbnRyb2wgPSBbLi4udGhpcy5nZXRTZWxlY3RlZENvbnRyb2xzRGF0YXNdOwogICAgZ2V0U2VsQ29udHJvbC5zb3J0KChhLCBiKSA9PiB7CiAgICAgIHJldHVybiB1c2VyRGF0YVthXS5leHRyYURhdGFzLnpJbmRleCAtIHVzZXJEYXRhW2JdLmV4dHJhRGF0YXMuekluZGV4OwogICAgfSk7CgogICAgZm9yIChjb25zdCBzZWxDb250cm9sIG9mIGdldFNlbENvbnRyb2wpIHsKICAgICAgaWYgKGxvd1Byb3JDb250cm9sLmluY2x1ZGVzKHNlbENvbnRyb2wpKSB7CiAgICAgICAgbG93U2VyaWVzQ29udHJvbC5wdXNoKHNlbENvbnRyb2wpOwogICAgICB9IGVsc2UgewogICAgICAgIGhpZ2hTZXJpZXNDb250cm9sLnB1c2goc2VsQ29udHJvbCk7CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBzZXRMb3dQcm9wSGlnaEluZGV4ID0gY29udHJvbCA9PiB7CiAgICAgIGlmIChsb3dTZXJpZXNDb250cm9sLmxlbmd0aCA+IDAgJiYgbG93U2VyaWVzQ29udHJvbC5pbmNsdWRlcyhjb250cm9sKSkgewogICAgICAgIGxvd1Nlcmllc0NvbnRyb2wucG9wKCk7CiAgICAgICAgY29uc3QgSW5kZXggPSBsb3dQcm9yQ29udHJvbC5maW5kSW5kZXgodmFsID0+IHVzZXJEYXRhW2dldExvd1Byb3BIaWdoZXN0SW5kZXhdLmV4dHJhRGF0YXMuekluZGV4ICsgMSA9PT0gdXNlckRhdGFbdmFsXS5leHRyYURhdGFzLnpJbmRleCk7CiAgICAgICAgZ2V0TG93UHJvcEhpZ2hlc3RJbmRleCA9IEluZGV4ICE9PSAtMSA/IGxvd1Byb3JDb250cm9sW0luZGV4XSA6ICcnOwoKICAgICAgICBpZiAoSW5kZXggIT09IC0xKSB7CiAgICAgICAgICBzZXRMb3dQcm9wSGlnaEluZGV4KGdldExvd1Byb3BIaWdoZXN0SW5kZXgpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBzZXRMb3dQcm9wSGlnaEluZGV4KGdldExvd1Byb3BIaWdoZXN0SW5kZXgpOwoKICAgIGlmIChsb3dTZXJpZXNDb250cm9sLmxlbmd0aCA+IDApIHsKICAgICAgbG93U2VyaWVzQ29udHJvbC5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgcmV0dXJuIHVzZXJEYXRhW2FdLmV4dHJhRGF0YXMuekluZGV4IC0gdXNlckRhdGFbYl0uZXh0cmFEYXRhcy56SW5kZXg7CiAgICAgIH0pOwogICAgICBsZXQgY291bnQgPSB1c2VyRGF0YVtnZXRMb3dQcm9wSGlnaGVzdEluZGV4XS5leHRyYURhdGFzLnpJbmRleDsKCiAgICAgIGZvciAoY29uc3QgY3RybCBvZiBsb3dTZXJpZXNDb250cm9sKSB7CiAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKGN0cmwsICd6SW5kZXgnLCBjb3VudCk7CiAgICAgICAgY291bnQgPSBjb3VudCArIDE7CiAgICAgIH0KCiAgICAgIGxldCBjb3VudGVyID0gdXNlckRhdGFbbG93U2VyaWVzQ29udHJvbFtsb3dTZXJpZXNDb250cm9sLmxlbmd0aCAtIDFdXS5leHRyYURhdGFzLnpJbmRleDsKCiAgICAgIGZvciAobGV0IGkgPSBsb3dQcm9yQ29udHJvbC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIGlmICghdGhpcy5nZXRTZWxlY3RlZENvbnRyb2xzRGF0YXMuaW5jbHVkZXMobG93UHJvckNvbnRyb2xbaV0pKSB7CiAgICAgICAgICBjb3VudGVyID0gY291bnRlciArIDE7CiAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXMobG93UHJvckNvbnRyb2xbaV0sICd6SW5kZXgnLCBjb3VudGVyKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KCiAgICBjb25zdCBzZXRIaWdoUHJvcEhpZ2hJbmRleCA9IGNvbnRyb2wgPT4gewogICAgICBpZiAoaGlnaFNlcmllc0NvbnRyb2wubGVuZ3RoID4gMCAmJiBoaWdoU2VyaWVzQ29udHJvbC5pbmNsdWRlcyhjb250cm9sKSkgewogICAgICAgIGhpZ2hTZXJpZXNDb250cm9sLnNoaWZ0KCk7CiAgICAgICAgY29uc3QgSW5kZXggPSBoaWdoUHJvckNvbnRyb2wuZmluZEluZGV4KHZhbCA9PiB1c2VyRGF0YVtnZXRIaWdoUHJvcEhpZ2hlc3RJbmRleF0uZXh0cmFEYXRhcy56SW5kZXggKyAxID09PSB1c2VyRGF0YVt2YWxdLmV4dHJhRGF0YXMuekluZGV4KTsKICAgICAgICBnZXRIaWdoUHJvcEhpZ2hlc3RJbmRleCA9IEluZGV4ICE9PSAtMSA/IGhpZ2hQcm9yQ29udHJvbFtJbmRleF0gOiAnJzsKCiAgICAgICAgaWYgKEluZGV4ICE9PSAtMSkgewogICAgICAgICAgc2V0SGlnaFByb3BIaWdoSW5kZXgoZ2V0SGlnaFByb3BIaWdoZXN0SW5kZXgpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKCiAgICBzZXRIaWdoUHJvcEhpZ2hJbmRleChnZXRIaWdoUHJvcEhpZ2hlc3RJbmRleCk7CgogICAgaWYgKGhpZ2hTZXJpZXNDb250cm9sLmxlbmd0aCA+IDApIHsKICAgICAgaGlnaFNlcmllc0NvbnRyb2wuc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiB1c2VyRGF0YVthXS5leHRyYURhdGFzLnpJbmRleCAtIHVzZXJEYXRhW2JdLmV4dHJhRGF0YXMuekluZGV4OwogICAgICB9KTsKICAgICAgbGV0IGNvdW50ID0gdXNlckRhdGFbZ2V0SGlnaFByb3BIaWdoZXN0SW5kZXhdLmV4dHJhRGF0YXMuekluZGV4OwoKICAgICAgZm9yIChjb25zdCBjdHJsIG9mIGhpZ2hTZXJpZXNDb250cm9sKSB7CiAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKGN0cmwsICd6SW5kZXgnLCBjb3VudCk7CiAgICAgICAgY291bnQgPSBjb3VudCArIDE7CiAgICAgIH0KCiAgICAgIGxldCBjb3VudGVyID0gdXNlckRhdGFbaGlnaFNlcmllc0NvbnRyb2xbaGlnaFNlcmllc0NvbnRyb2wubGVuZ3RoIC0gMV1dLmV4dHJhRGF0YXMuekluZGV4OwoKICAgICAgZm9yIChsZXQgaSA9IGhpZ2hQcm9yQ29udHJvbC5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIGlmICghdGhpcy5nZXRTZWxlY3RlZENvbnRyb2xzRGF0YXMuaW5jbHVkZXMoaGlnaFByb3JDb250cm9sW2ldKSkgewogICAgICAgICAgY291bnRlciA9IGNvdW50ZXIgKyAxOwogICAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKGhpZ2hQcm9yQ29udHJvbFtpXSwgJ3pJbmRleCcsIGNvdW50ZXIpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZ3JvdXBDb250cm9sKCkgewogICAgRXZlbnRCdXMuJGVtaXQoJ2dyb3VwQ29udHJvbCcsICdncm91cCcpOwogIH0KCiAgdW5Hcm91cENvbnRyb2woKSB7CiAgICBFdmVudEJ1cy4kZW1pdCgnZ3JvdXBDb250cm9sJywgJ3VuZ3JvdXAnKTsKICB9CgogIHNpemVUb0ZpdCgpIHsKICAgIGNvbnN0IHVzckZybURhdGEgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdOwogICAgY29uc3QgY3RybFNlbCA9IHRoaXMuc2VsZWN0ZWRDb250cm9sc1t0aGlzLnVzZXJGb3JtSWRdLnNlbGVjdGVkOwogICAgY29uc3Qgc2l6ZVRvRml0QXJyID0gW107CiAgICBjb25zdCBzaXplVG9GaXRWYWwgPSBbXTsKCiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgY3RybFNlbC5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgaWYgKCFjdHJsU2VsW2luZGV4XS5zdGFydHNXaXRoKCdncm91cCcpKSB7CiAgICAgICAgY29uc3QgY29udHJvbHByb3AgPSB1c3JGcm1EYXRhW2N0cmxTZWxbaW5kZXhdXS5wcm9wZXJ0aWVzOwoKICAgICAgICBpZiAoJ0F1dG9TaXplJyBpbiBjb250cm9scHJvcCkgewogICAgICAgICAgc2l6ZVRvRml0QXJyLnB1c2goY3RybFNlbFtpbmRleF0pOwogICAgICAgICAgc2l6ZVRvRml0VmFsLnB1c2goY29udHJvbHByb3AuQXV0b1NpemUpOwogICAgICAgICAgdGhpcy51cGRhdGVDb250cm9sUHJvcGVydHkoJ0F1dG9TaXplJywgdHJ1ZSwgY3RybFNlbFtpbmRleF0pOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgc2l6ZVRvRml0QXJyLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgIGlmICghc2l6ZVRvRml0QXJyW2luZGV4XS5zdGFydHNXaXRoKCdncm91cCcpKSB7CiAgICAgICAgICBjb25zdCBjb250cm9scHJvcCA9IHVzckZybURhdGFbc2l6ZVRvRml0QXJyW2luZGV4XV0ucHJvcGVydGllczsKCiAgICAgICAgICBpZiAoJ0F1dG9TaXplJyBpbiBjb250cm9scHJvcCkgewogICAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSgnQXV0b1NpemUnLCBzaXplVG9GaXRWYWxbaW5kZXhdLCBzaXplVG9GaXRBcnJbaW5kZXhdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sIDEwMCk7CiAgfQoKICBjb252ZXJ0VG9HcmlkU2l6ZSh2YWwpIHsKICAgIGNvbnN0IGdyaWRTaXplID0gOTsKICAgIHJldHVybiBNYXRoLnJvdW5kKHZhbCAvIGdyaWRTaXplKSAqIGdyaWRTaXplOwogIH0KCiAgc2l6ZVRvR3JpZCgpIHsKICAgIGxldCBkaXZzdHlsZSA9IFtdOwogICAgY29uc3QgdXNyRnJtRGF0YSA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF07CiAgICBjb25zdCBjdHJsU2VsID0gdGhpcy5zZWxlY3RlZENvbnRyb2xzW3RoaXMudXNlckZvcm1JZF0uc2VsZWN0ZWQ7CiAgICBsZXQgY3RybENvbnRhaW5lciA9IHRoaXMuc2VsZWN0ZWRDb250cm9sc1t0aGlzLnVzZXJGb3JtSWRdLmNvbnRhaW5lclswXTsKCiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgY3RybFNlbC5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgaWYgKCFjdHJsU2VsW2luZGV4XS5zdGFydHNXaXRoKCdncm91cCcpKSB7CiAgICAgICAgY29uc3QgY29udHJvbHByb3AgPSB1c3JGcm1EYXRhW2N0cmxTZWxbaW5kZXhdXS5wcm9wZXJ0aWVzOwogICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KCdMZWZ0JywgdGhpcy5jb252ZXJ0VG9HcmlkU2l6ZShjb250cm9scHJvcC5MZWZ0KSwgY3RybFNlbFtpbmRleF0pOwogICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KCdUb3AnLCB0aGlzLmNvbnZlcnRUb0dyaWRTaXplKGNvbnRyb2xwcm9wLlRvcCksIGN0cmxTZWxbaW5kZXhdKTsKICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSgnV2lkdGgnLCB0aGlzLmNvbnZlcnRUb0dyaWRTaXplKGNvbnRyb2xwcm9wLldpZHRoKSwgY3RybFNlbFtpbmRleF0pOwogICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KCdIZWlnaHQnLCB0aGlzLmNvbnZlcnRUb0dyaWRTaXplKGNvbnRyb2xwcm9wLkhlaWdodCksIGN0cmxTZWxbaW5kZXhdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBFdmVudEJ1cy4kZW1pdCgnZ2V0R3JvdXBTaXplJywgZGl2c3RheWxlQXJyYXkgPT4gewogICAgICAgICAgZGl2c3R5bGUgPSBkaXZzdGF5bGVBcnJheTsKICAgICAgICB9KTsKICAgICAgICBjb25zdCBnZXRJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFNlbFtpbmRleF0pOwogICAgICAgIEV2ZW50QnVzLiRlbWl0KCd1cGRhc3RlR3JvdXBTaXplJywgJ0dyb3VwSUQnLCAwLCBnZXRJbmRleCk7CiAgICAgIH0KICAgIH0KICB9CgogIGluY0RlY3NwYWNpbmcodHlwZSwgdmFsdWUpIHsKICAgIGNvbnN0IHVzckZybURhdGEgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdOwogICAgY29uc3QgY3RybFNlbCA9IHRoaXMuc2VsZWN0ZWRDb250cm9sc1t0aGlzLnVzZXJGb3JtSWRdLnNlbGVjdGVkOwogICAgY29uc3QgY3RybENvbnRhaW5lciA9IHRoaXMuc2VsZWN0ZWRDb250cm9sc1t0aGlzLnVzZXJGb3JtSWRdLmNvbnRhaW5lclswXTsKICAgIGNvbnN0IGNvbnRyb2xzID0gdXNyRnJtRGF0YVtjdHJsQ29udGFpbmVyXS5jb250cm9sczsKICAgIGxldCBkaXZzdHlsZSA9IFtdOwogICAgbGV0IGdldEdyb3VwSW5kZXggPSAtMTsKCiAgICBpZiAoY3RybFNlbFswXS5zdGFydHNXaXRoKCdncm91cCcpKSB7CiAgICAgIEV2ZW50QnVzLiRlbWl0KCdnZXRHcm91cFNpemUnLCBkaXZzdGF5bGVBcnJheSA9PiB7CiAgICAgICAgZGl2c3R5bGUgPSBkaXZzdGF5bGVBcnJheTsKICAgICAgfSk7CiAgICAgIGdldEdyb3VwSW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IGN0cmxTZWxbMF0pOwogICAgfQoKICAgIGNvbnN0IGxlZnRBcnJheSA9IFtdOwogICAgY29uc3QgcmlnaHRBcnJheSA9IFtdOwoKICAgIGZvciAobGV0IGluZGV4ID0gMTsgaW5kZXggPCBjdHJsU2VsLmxlbmd0aDsgaW5kZXgrKykgewogICAgICBjb25zdCBzZWxMZWZ0ID0gY3RybFNlbFswXS5zdGFydHNXaXRoKCdncm91cCcpID8gcGFyc2VJbnQoZGl2c3R5bGVbZ2V0R3JvdXBJbmRleF0ubGVmdCkgOiB1c3JGcm1EYXRhW2N0cmxTZWxbMF1dLnByb3BlcnRpZXMuTGVmdDsKICAgICAgY29uc3Qgc2VsVG9wID0gY3RybFNlbFswXS5zdGFydHNXaXRoKCdncm91cCcpID8gcGFyc2VJbnQoZGl2c3R5bGVbZ2V0R3JvdXBJbmRleF0udG9wKSA6IHVzckZybURhdGFbY3RybFNlbFswXV0ucHJvcGVydGllcy5Ub3A7CgogICAgICBpZiAoIWN0cmxTZWxbaW5kZXhdLnN0YXJ0c1dpdGgoJ2dyb3VwJykpIHsKICAgICAgICBjb25zdCBjdHJsUHJvcCA9IHVzckZybURhdGFbY3RybFNlbFtpbmRleF1dLnByb3BlcnRpZXM7CgogICAgICAgIGlmICh0eXBlID09PSAnTGVmdCcpIHsKICAgICAgICAgIGlmIChjdHJsUHJvcC5MZWZ0IDw9IHNlbExlZnQpIHsKICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybFNlbFtpbmRleF0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmlnaHRBcnJheS5wdXNoKGN0cmxTZWxbaW5kZXhdKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdUb3AnKSB7CiAgICAgICAgICBpZiAoY3RybFByb3AuVG9wIDw9IHNlbFRvcCkgewogICAgICAgICAgICBsZWZ0QXJyYXkucHVzaChjdHJsU2VsW2luZGV4XSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByaWdodEFycmF5LnB1c2goY3RybFNlbFtpbmRleF0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBFdmVudEJ1cy4kZW1pdCgnZ2V0R3JvdXBTaXplJywgZGl2c3RheWxlQXJyYXkgPT4gewogICAgICAgICAgZGl2c3R5bGUgPSBkaXZzdGF5bGVBcnJheTsKICAgICAgICB9KTsKICAgICAgICBjb25zdCBnZXRJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFNlbFtpbmRleF0pOwogICAgICAgIGNvbnN0IGdyb3VwTGVmdCA9IHBhcnNlSW50KGRpdnN0eWxlW2dldEluZGV4XS5sZWZ0KTsKICAgICAgICBjb25zdCBncm91cFRvcCA9IHBhcnNlSW50KGRpdnN0eWxlW2dldEluZGV4XS50b3ApOwogICAgICAgIGNvbnN0IGdyb3VwQ29ucm9sID0gdGhpcy5nZXRHcm91cENvbnRyb2woY3RybFNlbFtpbmRleF0pOwoKICAgICAgICBpZiAodHlwZSA9PT0gJ0xlZnQnKSB7CiAgICAgICAgICBpZiAoZ3JvdXBMZWZ0IDw9IHNlbExlZnQpIHsKICAgICAgICAgICAgZm9yIChsZXQgY3RybCBvZiBncm91cENvbnJvbCkgewogICAgICAgICAgICAgIGNvbnN0IHByb3AgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdW2N0cmxdLnByb3BlcnRpZXM7CgogICAgICAgICAgICAgIGlmIChNYXRoLmZsb29yKHByb3AuTGVmdCkgPT09IGdyb3VwTGVmdCkgewogICAgICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKGxldCBjdHJsIG9mIGdyb3VwQ29ucm9sKSB7CiAgICAgICAgICAgICAgY29uc3QgcHJvcCA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY3RybF0ucHJvcGVydGllczsKCiAgICAgICAgICAgICAgaWYgKE1hdGguZmxvb3IocHJvcC5MZWZ0KSA9PT0gZ3JvdXBMZWZ0KSB7CiAgICAgICAgICAgICAgICByaWdodEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnVG9wJykgewogICAgICAgICAgaWYgKGdyb3VwVG9wIDw9IHNlbFRvcCkgewogICAgICAgICAgICBmb3IgKGxldCBjdHJsIG9mIGdyb3VwQ29ucm9sKSB7CiAgICAgICAgICAgICAgY29uc3QgcHJvcCA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY3RybF0ucHJvcGVydGllczsKCiAgICAgICAgICAgICAgaWYgKE1hdGguZmxvb3IocHJvcC5Ub3ApID09PSBncm91cFRvcCkgewogICAgICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKGxldCBjdHJsIG9mIGdyb3VwQ29ucm9sKSB7CiAgICAgICAgICAgICAgY29uc3QgcHJvcCA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY3RybF0ucHJvcGVydGllczsKCiAgICAgICAgICAgICAgaWYgKE1hdGguZmxvb3IocHJvcC5Ub3ApID09PSBncm91cFRvcCkgewogICAgICAgICAgICAgICAgcmlnaHRBcnJheS5wdXNoKGN0cmwpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChjdHJsU2VsWzBdLnN0YXJ0c1dpdGgoJ2dyb3VwJykpIHsKICAgICAgY29uc3QgZ2V0SW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IGN0cmxTZWxbMF0pOwogICAgICBjb25zdCBncm91cExlZnQgPSBwYXJzZUludChkaXZzdHlsZVtnZXRJbmRleF0ubGVmdCk7CiAgICAgIGNvbnN0IGdyb3VwVG9wID0gcGFyc2VJbnQoZGl2c3R5bGVbZ2V0SW5kZXhdLnRvcCk7CiAgICAgIGNvbnN0IGdyb3VwQ29ucm9sID0gdGhpcy5nZXRHcm91cENvbnRyb2woY3RybFNlbFswXSk7CgogICAgICBpZiAodHlwZSA9PT0gJ0xlZnQnKSB7CiAgICAgICAgZm9yIChsZXQgY3RybCBvZiBncm91cENvbnJvbCkgewogICAgICAgICAgY29uc3QgcHJvcCA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY3RybF0ucHJvcGVydGllczsKCiAgICAgICAgICBpZiAoTWF0aC5mbG9vcihwcm9wLkxlZnQpID09PSBncm91cExlZnQpIHsKICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgIHJpZ2h0QXJyYXkucHVzaChjdHJsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ1RvcCcpIHsKICAgICAgICBmb3IgKGxldCBjdHJsIG9mIGdyb3VwQ29ucm9sKSB7CiAgICAgICAgICBjb25zdCBwcm9wID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXVtjdHJsXS5wcm9wZXJ0aWVzOwoKICAgICAgICAgIGlmIChNYXRoLmZsb29yKHByb3AuVG9wKSA9PT0gZ3JvdXBUb3ApIHsKICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgIHJpZ2h0QXJyYXkucHVzaChjdHJsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGxlZnRBcnJheS51bnNoaWZ0KGN0cmxTZWxbMF0pOwogICAgICByaWdodEFycmF5LnB1c2goY3RybFNlbFswXSk7CiAgICB9CgogICAgaWYgKHR5cGUgPT09ICdMZWZ0JykgewogICAgICBsZWZ0QXJyYXkuc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiB1c3JGcm1EYXRhW2JdLnByb3BlcnRpZXMuTGVmdCAtIHVzckZybURhdGFbYV0ucHJvcGVydGllcy5MZWZ0OwogICAgICB9KTsKICAgICAgcmlnaHRBcnJheS5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgcmV0dXJuIHVzckZybURhdGFbYV0ucHJvcGVydGllcy5MZWZ0IC0gdXNyRnJtRGF0YVtiXS5wcm9wZXJ0aWVzLkxlZnQ7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmICh0eXBlID09PSAnVG9wJykgewogICAgICBsZWZ0QXJyYXkuc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiB1c3JGcm1EYXRhW2JdLnByb3BlcnRpZXMuVG9wIC0gdXNyRnJtRGF0YVthXS5wcm9wZXJ0aWVzLlRvcDsKICAgICAgfSk7CiAgICAgIHJpZ2h0QXJyYXkuc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiB1c3JGcm1EYXRhW2FdLnByb3BlcnRpZXMuVG9wIC0gdXNyRnJtRGF0YVtiXS5wcm9wZXJ0aWVzLlRvcDsKICAgICAgfSk7CiAgICB9CgogICAgY29uc3QgZ3JvdXBJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFNlbFswXSk7CiAgICBjb25zdCBpc0dyb3VwID0gY3RybFNlbFswXS5zdGFydHNXaXRoKCdncm91cCcpOwogICAgY29uc3QgY3RybFByb3AgPSAhaXNHcm91cCAmJiB1c3JGcm1EYXRhW2N0cmxTZWxbMF1dLnByb3BlcnRpZXM7CiAgICBjb25zdCBuZXdPYmplY3QgPSB7CiAgICAgIExlZnQ6IGlzR3JvdXAgJiYgZ3JvdXBJbmRleCAhPT0gLTEgPyBwYXJzZUludChkaXZzdHlsZVtncm91cEluZGV4XS5sZWZ0KSA6IGN0cmxQcm9wID8gY3RybFByb3AuTGVmdCA6IDAsCiAgICAgIFRvcDogaXNHcm91cCAmJiBncm91cEluZGV4ICE9PSAtMSA/IHBhcnNlSW50KGRpdnN0eWxlW2dyb3VwSW5kZXhdLnRvcCkgOiBjdHJsUHJvcCA/IGN0cmxQcm9wLlRvcCA6IDAsCiAgICAgIFdpZHRoOiBpc0dyb3VwICYmIGdyb3VwSW5kZXggIT09IC0xID8gcGFyc2VJbnQoZGl2c3R5bGVbZ3JvdXBJbmRleF0ud2lkdGgpIDogY3RybFByb3AgPyBjdHJsUHJvcC5XaWR0aCA6IDAsCiAgICAgIEhlaWdodDogaXNHcm91cCAmJiBncm91cEluZGV4ICE9PSAtMSA/IHBhcnNlSW50KGRpdnN0eWxlW2dyb3VwSW5kZXhdLmhlaWdodCkgOiBjdHJsUHJvcCA/IGN0cmxQcm9wLkhlaWdodCA6IDAKICAgIH07CiAgICBsZXQgaW5jRGVjVmFsdWUgPSAwOwogICAgbGV0IHByb3BWYWx1ZSA9IDA7CgogICAgZm9yIChsZXQgaW5kZXggPSAxOyBpbmRleCA8IGxlZnRBcnJheS5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgY29uc3QgY3RybFByb3AgPSB1c3JGcm1EYXRhW2xlZnRBcnJheVtpbmRleF1dLnByb3BlcnRpZXM7CiAgICAgIGxldCBwcmV2SW5kZXggPSAtMTsKICAgICAgbGV0IGNvbnRyb2xQcm9wSW5kZXggPSAtMTsKCiAgICAgIGlmICh0eXBlID09PSAnTGVmdCcpIHsKICAgICAgICBpZiAoY3RybFByb3AuR3JvdXBJRCA9PT0gJycpIHsKICAgICAgICAgIHByb3BWYWx1ZSA9IHByb3BWYWx1ZSArIHZhbHVlOwogICAgICAgICAgaW5jRGVjVmFsdWUgPSBjdHJsUHJvcC5MZWZ0IC0gcHJvcFZhbHVlOwogICAgICAgICAgdGhpcy51cGRhdGVDb250cm9sUHJvcGVydHkodHlwZSwgdGhpcy5jb252ZXJ0VG9HcmlkU2l6ZShpbmNEZWNWYWx1ZSksIGxlZnRBcnJheVtpbmRleF0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoY3RybFByb3AuR3JvdXBJRCAhPT0gJycpIHsKICAgICAgICAgICAgY29udHJvbFByb3BJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFByb3AuR3JvdXBJRCk7CiAgICAgICAgICAgIGxldCBpbmNEZWNWYWx1ZSA9IDA7CiAgICAgICAgICAgIHByb3BWYWx1ZSA9IHByb3BWYWx1ZSArIHZhbHVlOwogICAgICAgICAgICBpbmNEZWNWYWx1ZSA9IHBhcnNlSW50KGRpdnN0eWxlW2NvbnRyb2xQcm9wSW5kZXhdLmxlZnQpIC0gcHJvcFZhbHVlOwogICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgndXBkYXN0ZUdyb3VwU2l6ZScsIHR5cGUsIHRoaXMuY29udmVydFRvR3JpZFNpemUoaW5jRGVjVmFsdWUpLCBjb250cm9sUHJvcEluZGV4KTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ1RvcCcpIHsKICAgICAgICBpZiAoY3RybFByb3AuR3JvdXBJRCA9PT0gJycpIHsKICAgICAgICAgIHByb3BWYWx1ZSA9IHByb3BWYWx1ZSArIHZhbHVlOwogICAgICAgICAgaW5jRGVjVmFsdWUgPSBjdHJsUHJvcC5Ub3AgLSBwcm9wVmFsdWU7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSh0eXBlLCB0aGlzLmNvbnZlcnRUb0dyaWRTaXplKGluY0RlY1ZhbHVlKSwgbGVmdEFycmF5W2luZGV4XSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChjdHJsUHJvcC5Hcm91cElEICE9PSAnJykgewogICAgICAgICAgICBjb250cm9sUHJvcEluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBjdHJsUHJvcC5Hcm91cElEKTsKICAgICAgICAgICAgbGV0IGluY0RlY1ZhbHVlID0gMDsKICAgICAgICAgICAgcHJvcFZhbHVlID0gcHJvcFZhbHVlICsgdmFsdWU7CiAgICAgICAgICAgIGluY0RlY1ZhbHVlID0gcGFyc2VJbnQoZGl2c3R5bGVbY29udHJvbFByb3BJbmRleF0udG9wKSAtIHByb3BWYWx1ZTsKICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ3VwZGFzdGVHcm91cFNpemUnLCB0eXBlLCB0aGlzLmNvbnZlcnRUb0dyaWRTaXplKGluY0RlY1ZhbHVlKSwgY29udHJvbFByb3BJbmRleCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgcHJvcFZhbHVlID0gMDsKCiAgICBmb3IgKGxldCBpbmRleCA9IDE7IGluZGV4IDwgcmlnaHRBcnJheS5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgY29uc3QgY3RybFByb3AgPSB1c3JGcm1EYXRhW3JpZ2h0QXJyYXlbaW5kZXhdXS5wcm9wZXJ0aWVzOwogICAgICBsZXQgcHJldkluZGV4ID0gLTE7CiAgICAgIGxldCBjb250cm9sUHJvcEluZGV4ID0gLTE7CgogICAgICBpZiAodHlwZSA9PT0gJ0xlZnQnKSB7CiAgICAgICAgaWYgKGN0cmxQcm9wLkdyb3VwSUQgPT09ICcnKSB7CiAgICAgICAgICBwcm9wVmFsdWUgPSBwcm9wVmFsdWUgKyB2YWx1ZTsKICAgICAgICAgIGluY0RlY1ZhbHVlID0gY3RybFByb3AuTGVmdCArIHByb3BWYWx1ZTsKICAgICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KHR5cGUsIHRoaXMuY29udmVydFRvR3JpZFNpemUoaW5jRGVjVmFsdWUpLCByaWdodEFycmF5W2luZGV4XSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChjdHJsUHJvcC5Hcm91cElEICE9PSAnJykgewogICAgICAgICAgICBjb250cm9sUHJvcEluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBjdHJsUHJvcC5Hcm91cElEKTsKICAgICAgICAgICAgcHJvcFZhbHVlID0gcHJvcFZhbHVlICsgdmFsdWU7CiAgICAgICAgICAgIGluY0RlY1ZhbHVlID0gcGFyc2VJbnQoZGl2c3R5bGVbY29udHJvbFByb3BJbmRleF0ubGVmdCkgKyBwcm9wVmFsdWU7CiAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCd1cGRhc3RlR3JvdXBTaXplJywgdHlwZSwgdGhpcy5jb252ZXJ0VG9HcmlkU2l6ZShpbmNEZWNWYWx1ZSksIGNvbnRyb2xQcm9wSW5kZXgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnVG9wJykgewogICAgICAgIGlmIChjdHJsUHJvcC5Hcm91cElEID09PSAnJykgewogICAgICAgICAgbGV0IGluY0RlY1ZhbHVlID0gMDsKICAgICAgICAgIHByb3BWYWx1ZSA9IHByb3BWYWx1ZSArIHZhbHVlOwogICAgICAgICAgaW5jRGVjVmFsdWUgPSBjdHJsUHJvcC5Ub3AgKyBwcm9wVmFsdWU7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSh0eXBlLCB0aGlzLmNvbnZlcnRUb0dyaWRTaXplKGluY0RlY1ZhbHVlKSwgcmlnaHRBcnJheVtpbmRleF0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoY3RybFByb3AuR3JvdXBJRCAhPT0gJycpIHsKICAgICAgICAgICAgY29udHJvbFByb3BJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFByb3AuR3JvdXBJRCk7CiAgICAgICAgICAgIGxldCBpbmNEZWNWYWx1ZSA9IDA7CiAgICAgICAgICAgIHByb3BWYWx1ZSA9IHByb3BWYWx1ZSArIHZhbHVlOwogICAgICAgICAgICBpbmNEZWNWYWx1ZSA9IHBhcnNlSW50KGRpdnN0eWxlW2NvbnRyb2xQcm9wSW5kZXhdLnRvcCkgKyBwcm9wVmFsdWU7CiAgICAgICAgICAgIEV2ZW50QnVzLiRlbWl0KCd1cGRhc3RlR3JvdXBTaXplJywgdHlwZSwgdGhpcy5jb252ZXJ0VG9HcmlkU2l6ZShpbmNEZWNWYWx1ZSksIGNvbnRyb2xQcm9wSW5kZXgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgZ2V0R3JvdXBDb250cm9sKGdyb3VwTmFtZSkgewogICAgY29uc3QgY3RybENvbnRhaW5lciA9IHRoaXMuc2VsZWN0ZWRDb250cm9sc1t0aGlzLnVzZXJGb3JtSWRdLmNvbnRhaW5lclswXTsKICAgIGNvbnN0IHVzckZybURhdGEgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdOwogICAgY29uc3QgY29udHJvbHMgPSBbXTsKCiAgICBmb3IgKGNvbnN0IGNvbnRyb2wgb2YgdXNyRnJtRGF0YVtjdHJsQ29udGFpbmVyXS5jb250cm9scykgewogICAgICBpZiAodXNyRnJtRGF0YVtjb250cm9sXS5wcm9wZXJ0aWVzLkdyb3VwSUQgPT09IGdyb3VwTmFtZSkgewogICAgICAgIGNvbnRyb2xzLnB1c2goY29udHJvbCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gY29udHJvbHM7CiAgfQoKICByZW1vdmVTcGFjZSh0eXBlKSB7CiAgICBjb25zdCB1c3JGcm1EYXRhID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXTsKICAgIGNvbnN0IGN0cmxTZWwgPSB0aGlzLnNlbGVjdGVkQ29udHJvbHNbdGhpcy51c2VyRm9ybUlkXS5zZWxlY3RlZDsKICAgIGNvbnN0IGN0cmxDb250YWluZXIgPSB0aGlzLnNlbGVjdGVkQ29udHJvbHNbdGhpcy51c2VyRm9ybUlkXS5jb250YWluZXJbMF07CiAgICBjb25zdCBjb250cm9scyA9IHVzckZybURhdGFbY3RybENvbnRhaW5lcl0uY29udHJvbHM7CiAgICBsZXQgZGl2c3R5bGUgPSBbXTsKICAgIGxldCBnZXRHcm91cEluZGV4ID0gLTE7CgogICAgaWYgKGN0cmxTZWxbMF0uc3RhcnRzV2l0aCgnZ3JvdXAnKSkgewogICAgICBFdmVudEJ1cy4kZW1pdCgnZ2V0R3JvdXBTaXplJywgZGl2c3RheWxlQXJyYXkgPT4gewogICAgICAgIGRpdnN0eWxlID0gZGl2c3RheWxlQXJyYXk7CiAgICAgIH0pOwogICAgICBnZXRHcm91cEluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBjdHJsU2VsWzBdKTsKICAgIH0KCiAgICBsZXQgcHJvcFZhbHVlID0gMDsKICAgIGNvbnN0IGxlZnRBcnJheSA9IFtdOwogICAgY29uc3QgcmlnaHRBcnJheSA9IFtdOwoKICAgIGZvciAobGV0IGluZGV4ID0gMTsgaW5kZXggPCBjdHJsU2VsLmxlbmd0aDsgaW5kZXgrKykgewogICAgICBjb25zdCBzZWxMZWZ0ID0gY3RybFNlbFswXS5zdGFydHNXaXRoKCdncm91cCcpID8gcGFyc2VJbnQoZGl2c3R5bGVbZ2V0R3JvdXBJbmRleF0ubGVmdCkgOiB1c3JGcm1EYXRhW2N0cmxTZWxbMF1dLnByb3BlcnRpZXMuTGVmdDsKICAgICAgY29uc3Qgc2VsVG9wID0gY3RybFNlbFswXS5zdGFydHNXaXRoKCdncm91cCcpID8gcGFyc2VJbnQoZGl2c3R5bGVbZ2V0R3JvdXBJbmRleF0udG9wKSA6IHVzckZybURhdGFbY3RybFNlbFswXV0ucHJvcGVydGllcy5Ub3A7CgogICAgICBpZiAoIWN0cmxTZWxbaW5kZXhdLnN0YXJ0c1dpdGgoJ2dyb3VwJykpIHsKICAgICAgICBjb25zdCBjdHJsUHJvcCA9IHVzckZybURhdGFbY3RybFNlbFtpbmRleF1dLnByb3BlcnRpZXM7CgogICAgICAgIGlmICh0eXBlID09PSAnTGVmdCcpIHsKICAgICAgICAgIGlmIChjdHJsUHJvcC5MZWZ0IDw9IHNlbExlZnQpIHsKICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybFNlbFtpbmRleF0pOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmlnaHRBcnJheS5wdXNoKGN0cmxTZWxbaW5kZXhdKTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdUb3AnKSB7CiAgICAgICAgICBpZiAoY3RybFByb3AuVG9wIDw9IHNlbFRvcCkgewogICAgICAgICAgICBsZWZ0QXJyYXkucHVzaChjdHJsU2VsW2luZGV4XSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByaWdodEFycmF5LnB1c2goY3RybFNlbFtpbmRleF0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBFdmVudEJ1cy4kZW1pdCgnZ2V0R3JvdXBTaXplJywgZGl2c3RheWxlQXJyYXkgPT4gewogICAgICAgICAgZGl2c3R5bGUgPSBkaXZzdGF5bGVBcnJheTsKICAgICAgICB9KTsKICAgICAgICBjb25zdCBnZXRJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFNlbFtpbmRleF0pOwogICAgICAgIGNvbnN0IGdyb3VwTGVmdCA9IHBhcnNlSW50KGRpdnN0eWxlW2dldEluZGV4XS5sZWZ0KTsKICAgICAgICBjb25zdCBncm91cFRvcCA9IHBhcnNlSW50KGRpdnN0eWxlW2dldEluZGV4XS50b3ApOwogICAgICAgIGNvbnN0IGdyb3VwQ29ucm9sID0gdGhpcy5nZXRHcm91cENvbnRyb2woY3RybFNlbFtpbmRleF0pOwoKICAgICAgICBpZiAodHlwZSA9PT0gJ0xlZnQnKSB7CiAgICAgICAgICBpZiAoZ3JvdXBMZWZ0IDw9IHNlbExlZnQpIHsKICAgICAgICAgICAgZm9yIChsZXQgY3RybCBvZiBncm91cENvbnJvbCkgewogICAgICAgICAgICAgIGNvbnN0IHByb3AgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdW2N0cmxdLnByb3BlcnRpZXM7CgogICAgICAgICAgICAgIGlmIChNYXRoLmZsb29yKHByb3AuTGVmdCkgPT09IGdyb3VwTGVmdCkgewogICAgICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKGxldCBjdHJsIG9mIGdyb3VwQ29ucm9sKSB7CiAgICAgICAgICAgICAgY29uc3QgcHJvcCA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY3RybF0ucHJvcGVydGllczsKCiAgICAgICAgICAgICAgaWYgKE1hdGguZmxvb3IocHJvcC5MZWZ0KSA9PT0gZ3JvdXBMZWZ0KSB7CiAgICAgICAgICAgICAgICByaWdodEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnVG9wJykgewogICAgICAgICAgaWYgKGdyb3VwVG9wIDw9IHNlbFRvcCkgewogICAgICAgICAgICBmb3IgKGxldCBjdHJsIG9mIGdyb3VwQ29ucm9sKSB7CiAgICAgICAgICAgICAgY29uc3QgcHJvcCA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY3RybF0ucHJvcGVydGllczsKCiAgICAgICAgICAgICAgaWYgKE1hdGguZmxvb3IocHJvcC5Ub3ApID09PSBncm91cFRvcCkgewogICAgICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBmb3IgKGxldCBjdHJsIG9mIGdyb3VwQ29ucm9sKSB7CiAgICAgICAgICAgICAgY29uc3QgcHJvcCA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY3RybF0ucHJvcGVydGllczsKCiAgICAgICAgICAgICAgaWYgKE1hdGguZmxvb3IocHJvcC5Ub3ApID09PSBncm91cFRvcCkgewogICAgICAgICAgICAgICAgcmlnaHRBcnJheS5wdXNoKGN0cmwpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmIChjdHJsU2VsWzBdLnN0YXJ0c1dpdGgoJ2dyb3VwJykpIHsKICAgICAgY29uc3QgZ2V0SW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IGN0cmxTZWxbMF0pOwogICAgICBjb25zdCBncm91cExlZnQgPSBwYXJzZUludChkaXZzdHlsZVtnZXRJbmRleF0ubGVmdCk7CiAgICAgIGNvbnN0IGdyb3VwVG9wID0gcGFyc2VJbnQoZGl2c3R5bGVbZ2V0SW5kZXhdLnRvcCk7CiAgICAgIGNvbnN0IGdyb3VwQ29ucm9sID0gdGhpcy5nZXRHcm91cENvbnRyb2woY3RybFNlbFswXSk7CgogICAgICBpZiAodHlwZSA9PT0gJ0xlZnQnKSB7CiAgICAgICAgZm9yIChsZXQgY3RybCBvZiBncm91cENvbnJvbCkgewogICAgICAgICAgY29uc3QgcHJvcCA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF1bY3RybF0ucHJvcGVydGllczsKCiAgICAgICAgICBpZiAoTWF0aC5mbG9vcihwcm9wLkxlZnQpID09PSBncm91cExlZnQpIHsKICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgIHJpZ2h0QXJyYXkucHVzaChjdHJsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ1RvcCcpIHsKICAgICAgICBmb3IgKGxldCBjdHJsIG9mIGdyb3VwQ29ucm9sKSB7CiAgICAgICAgICBjb25zdCBwcm9wID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXVtjdHJsXS5wcm9wZXJ0aWVzOwoKICAgICAgICAgIGlmIChNYXRoLmZsb29yKHByb3AuVG9wKSA9PT0gZ3JvdXBUb3ApIHsKICAgICAgICAgICAgbGVmdEFycmF5LnB1c2goY3RybCk7CiAgICAgICAgICAgIHJpZ2h0QXJyYXkucHVzaChjdHJsKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGxlZnRBcnJheS51bnNoaWZ0KGN0cmxTZWxbMF0pOwogICAgICByaWdodEFycmF5LnB1c2goY3RybFNlbFswXSk7CiAgICB9CgogICAgaWYgKHR5cGUgPT09ICdMZWZ0JykgewogICAgICBsZWZ0QXJyYXkuc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiB1c3JGcm1EYXRhW2JdLnByb3BlcnRpZXMuTGVmdCAtIHVzckZybURhdGFbYV0ucHJvcGVydGllcy5MZWZ0OwogICAgICB9KTsKICAgICAgcmlnaHRBcnJheS5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgcmV0dXJuIHVzckZybURhdGFbYV0ucHJvcGVydGllcy5MZWZ0IC0gdXNyRnJtRGF0YVtiXS5wcm9wZXJ0aWVzLkxlZnQ7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmICh0eXBlID09PSAnVG9wJykgewogICAgICBsZWZ0QXJyYXkuc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiB1c3JGcm1EYXRhW2JdLnByb3BlcnRpZXMuVG9wIC0gdXNyRnJtRGF0YVthXS5wcm9wZXJ0aWVzLlRvcDsKICAgICAgfSk7CiAgICAgIHJpZ2h0QXJyYXkuc29ydCgoYSwgYikgPT4gewogICAgICAgIHJldHVybiB1c3JGcm1EYXRhW2FdLnByb3BlcnRpZXMuVG9wIC0gdXNyRnJtRGF0YVtiXS5wcm9wZXJ0aWVzLlRvcDsKICAgICAgfSk7CiAgICB9CgogICAgZm9yIChsZXQgaW5kZXggPSAxOyBpbmRleCA8IGxlZnRBcnJheS5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgY29uc3QgcHJldkN0cmxQcm9wID0gdXNyRnJtRGF0YVtsZWZ0QXJyYXlbaW5kZXggLSAxXV0ucHJvcGVydGllczsKICAgICAgY29uc3QgY3RybFByb3AgPSB1c3JGcm1EYXRhW2xlZnRBcnJheVtpbmRleF1dLnByb3BlcnRpZXM7CiAgICAgIGxldCBwcmV2SW5kZXggPSAtMTsKICAgICAgbGV0IGNvbnRyb2xQcm9wSW5kZXggPSAtMTsKCiAgICAgIGlmICh0eXBlID09PSAnTGVmdCcpIHsKICAgICAgICBpZiAocHJldkN0cmxQcm9wLkdyb3VwSUQgPT09ICcnICYmIGN0cmxQcm9wLkdyb3VwSUQgPT09ICcnKSB7CiAgICAgICAgICBwcm9wVmFsdWUgPSBwcmV2Q3RybFByb3AuTGVmdCAtIGN0cmxQcm9wLldpZHRoOwogICAgICAgICAgdGhpcy51cGRhdGVDb250cm9sUHJvcGVydHkodHlwZSwgcHJvcFZhbHVlLCBsZWZ0QXJyYXlbaW5kZXhdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHByZXZDdHJsUHJvcC5Hcm91cElEICE9PSAnJykgewogICAgICAgICAgICBpZiAoY3RybFByb3AuR3JvdXBJRCA9PT0gJycpIHsKICAgICAgICAgICAgICBwcmV2SW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IHByZXZDdHJsUHJvcC5Hcm91cElEKTsKICAgICAgICAgICAgICBwcm9wVmFsdWUgPSBwYXJzZUludChkaXZzdHlsZVtwcmV2SW5kZXhdLmxlZnQpIC0gY3RybFByb3AuV2lkdGg7CiAgICAgICAgICAgICAgdGhpcy51cGRhdGVDb250cm9sUHJvcGVydHkodHlwZSwgcHJvcFZhbHVlLCBsZWZ0QXJyYXlbaW5kZXhdKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIGlmIChjdHJsUHJvcC5Hcm91cElEICE9PSAnJykgewogICAgICAgICAgICBjb250cm9sUHJvcEluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBjdHJsUHJvcC5Hcm91cElEKTsKCiAgICAgICAgICAgIGlmIChwcmV2Q3RybFByb3AuR3JvdXBJRCA9PT0gJycpIHsKICAgICAgICAgICAgICBwcm9wVmFsdWUgPSBwcmV2Q3RybFByb3AuTGVmdCAtIHBhcnNlSW50KGRpdnN0eWxlW2NvbnRyb2xQcm9wSW5kZXhdLndpZHRoKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBwcmV2SW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IHByZXZDdHJsUHJvcC5Hcm91cElEKTsKICAgICAgICAgICAgICBwcm9wVmFsdWUgPSBwYXJzZUludChkaXZzdHlsZVtwcmV2SW5kZXhdLmxlZnQpIC0gcGFyc2VJbnQoZGl2c3R5bGVbY29udHJvbFByb3BJbmRleF0ud2lkdGgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgndXBkYXN0ZUdyb3VwU2l6ZScsIHR5cGUsIHByb3BWYWx1ZSwgY29udHJvbFByb3BJbmRleCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdUb3AnKSB7CiAgICAgICAgaWYgKHByZXZDdHJsUHJvcC5Hcm91cElEID09PSAnJyAmJiBjdHJsUHJvcC5Hcm91cElEID09PSAnJykgewogICAgICAgICAgcHJvcFZhbHVlID0gcHJldkN0cmxQcm9wLlRvcCAtIGN0cmxQcm9wLkhlaWdodDsKICAgICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KHR5cGUsIHByb3BWYWx1ZSwgbGVmdEFycmF5W2luZGV4XSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChwcmV2Q3RybFByb3AuR3JvdXBJRCAhPT0gJycpIHsKICAgICAgICAgICAgaWYgKGN0cmxQcm9wLkdyb3VwSUQgPT09ICcnKSB7CiAgICAgICAgICAgICAgcHJldkluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBwcmV2Q3RybFByb3AuR3JvdXBJRCk7CiAgICAgICAgICAgICAgcHJvcFZhbHVlID0gcGFyc2VJbnQoZGl2c3R5bGVbcHJldkluZGV4XS50b3ApIC0gY3RybFByb3AuSGVpZ2h0OwogICAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KHR5cGUsIHByb3BWYWx1ZSwgbGVmdEFycmF5W2luZGV4XSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY3RybFByb3AuR3JvdXBJRCAhPT0gJycpIHsKICAgICAgICAgICAgY29udHJvbFByb3BJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gY3RybFByb3AuR3JvdXBJRCk7CgogICAgICAgICAgICBpZiAocHJldkN0cmxQcm9wLkdyb3VwSUQgPT09ICcnKSB7CiAgICAgICAgICAgICAgcHJvcFZhbHVlID0gcHJldkN0cmxQcm9wLlRvcCAtIHBhcnNlSW50KGRpdnN0eWxlW2NvbnRyb2xQcm9wSW5kZXhdLmhlaWdodCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgcHJldkluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBwcmV2Q3RybFByb3AuR3JvdXBJRCk7CiAgICAgICAgICAgICAgcHJvcFZhbHVlID0gcGFyc2VJbnQoZGl2c3R5bGVbcHJldkluZGV4XS50b3ApIC0gcGFyc2VJbnQoZGl2c3R5bGVbY29udHJvbFByb3BJbmRleF0uaGVpZ2h0KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ3VwZGFzdGVHcm91cFNpemUnLCB0eXBlLCBwcm9wVmFsdWUsIGNvbnRyb2xQcm9wSW5kZXgpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGZvciAobGV0IGluZGV4ID0gMTsgaW5kZXggPCByaWdodEFycmF5Lmxlbmd0aDsgaW5kZXgrKykgewogICAgICBjb25zdCBwcmV2Q3RybFByb3AgPSB1c3JGcm1EYXRhW3JpZ2h0QXJyYXlbaW5kZXggLSAxXV0ucHJvcGVydGllczsKICAgICAgY29uc3QgY3RybFByb3AgPSB1c3JGcm1EYXRhW3JpZ2h0QXJyYXlbaW5kZXhdXS5wcm9wZXJ0aWVzOwogICAgICBsZXQgcHJldkluZGV4ID0gLTE7CiAgICAgIGNvbnN0IGNvbnRyb2xQcm9wSW5kZXggPSAtMTsKCiAgICAgIGlmICh0eXBlID09PSAnTGVmdCcpIHsKICAgICAgICBpZiAocHJldkN0cmxQcm9wLkdyb3VwSUQgPT09ICcnICYmIGN0cmxQcm9wLkdyb3VwSUQgPT09ICcnKSB7CiAgICAgICAgICBwcm9wVmFsdWUgPSBwcmV2Q3RybFByb3AuTGVmdCArIHByZXZDdHJsUHJvcC5XaWR0aDsKICAgICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KHR5cGUsIHByb3BWYWx1ZSwgcmlnaHRBcnJheVtpbmRleF0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAocHJldkN0cmxQcm9wLkdyb3VwSUQgIT09ICcnKSB7CiAgICAgICAgICAgIHByZXZJbmRleCA9IGRpdnN0eWxlLmZpbmRJbmRleCh2YWwgPT4gdmFsLmdyb3VwTmFtZSA9PT0gcHJldkN0cmxQcm9wLkdyb3VwSUQpOwogICAgICAgICAgICBwcm9wVmFsdWUgPSBwYXJzZUludChkaXZzdHlsZVtwcmV2SW5kZXhdLmxlZnQpICsgcGFyc2VJbnQoZGl2c3R5bGVbcHJldkluZGV4XS53aWR0aCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBwcm9wVmFsdWUgPSBwcmV2Q3RybFByb3AuTGVmdCArIHByZXZDdHJsUHJvcC5XaWR0aDsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoY3RybFByb3AuR3JvdXBJRCAhPT0gJycpIHsKICAgICAgICAgICAgY29uc3QgZ2V0SW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IGN0cmxQcm9wLkdyb3VwSUQpOwogICAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgndXBkYXN0ZUdyb3VwU2l6ZScsIHR5cGUsIHByb3BWYWx1ZSwgZ2V0SW5kZXgpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy51cGRhdGVDb250cm9sUHJvcGVydHkodHlwZSwgcHJvcFZhbHVlLCByaWdodEFycmF5W2luZGV4XSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdUb3AnKSB7CiAgICAgICAgaWYgKHByZXZDdHJsUHJvcC5Hcm91cElEID09PSAnJyAmJiBjdHJsUHJvcC5Hcm91cElEID09PSAnJykgewogICAgICAgICAgcHJvcFZhbHVlID0gcHJldkN0cmxQcm9wLlRvcCArIHByZXZDdHJsUHJvcC5IZWlnaHQ7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSh0eXBlLCBwcm9wVmFsdWUsIHJpZ2h0QXJyYXlbaW5kZXhdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHByZXZDdHJsUHJvcC5Hcm91cElEICE9PSAnJykgewogICAgICAgICAgICBwcmV2SW5kZXggPSBkaXZzdHlsZS5maW5kSW5kZXgodmFsID0+IHZhbC5ncm91cE5hbWUgPT09IHByZXZDdHJsUHJvcC5Hcm91cElEKTsKICAgICAgICAgICAgcHJvcFZhbHVlID0gcGFyc2VJbnQoZGl2c3R5bGVbcHJldkluZGV4XS50b3ApICsgcGFyc2VJbnQoZGl2c3R5bGVbcHJldkluZGV4XS5oZWlnaHQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcHJvcFZhbHVlID0gcHJldkN0cmxQcm9wLlRvcCArIHByZXZDdHJsUHJvcC5IZWlnaHQ7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKGN0cmxQcm9wLkdyb3VwSUQgIT09ICcnKSB7CiAgICAgICAgICAgIGNvbnN0IGdldEluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBjdHJsUHJvcC5Hcm91cElEKTsKICAgICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ3VwZGFzdGVHcm91cFNpemUnLCB0eXBlLCBwcm9wVmFsdWUsIGdldEluZGV4KTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KHR5cGUsIHByb3BWYWx1ZSwgcmlnaHRBcnJheVtpbmRleF0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgdXBkYXRlUHJvcFZhbChwcm9wTmFtZSwgcHJvcFZhbHVlKSB7CiAgICBjb25zdCBjdHJsU2VsID0gdGhpcy5zZWxlY3RlZENvbnRyb2xzW3RoaXMudXNlckZvcm1JZF0uc2VsZWN0ZWQ7CiAgICBjb25zdCB1c3JGcm1EYXRhID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXTsKCiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgY3RybFNlbC5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgaWYgKCFjdHJsU2VsW2luZGV4XS5zdGFydHNXaXRoKCdncm91cCcpKSB7CiAgICAgICAgY29uc3QgY3VyUHJvcCA9IHVzckZybURhdGFbY3RybFNlbFtpbmRleF1dLnByb3BlcnRpZXM7CgogICAgICAgIGlmIChwcm9wTmFtZSA9PT0gJ3NlbENlbnRlcicpIHsKICAgICAgICAgIGNvbnN0IGN1ckNlbnRlciA9IGN1clByb3AuV2lkdGggLyAyOwogICAgICAgICAgY29uc3QgdmFsdWUgPSBwcm9wVmFsdWUgLSBjdXJDZW50ZXI7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSgnTGVmdCcsIHZhbHVlLCBjdHJsU2VsW2luZGV4XSk7CiAgICAgICAgfQoKICAgICAgICBpZiAocHJvcE5hbWUgPT09ICdzZWxNaWRkbGUnKSB7CiAgICAgICAgICBjb25zdCBjdXJNaWRkbGUgPSBjdXJQcm9wLkhlaWdodCAvIDI7CiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHByb3BWYWx1ZSAtIGN1ck1pZGRsZTsKICAgICAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KCdUb3AnLCB2YWx1ZSwgY3RybFNlbFtpbmRleF0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgZGl2c3R5bGUgPSBbXTsKICAgICAgICBFdmVudEJ1cy4kZW1pdCgnZ2V0R3JvdXBTaXplJywgZGl2c3RheWxlQXJyYXkgPT4gewogICAgICAgICAgZGl2c3R5bGUgPSBkaXZzdGF5bGVBcnJheTsKICAgICAgICB9KTsKICAgICAgICBjb25zdCBncm91cEluZGV4ID0gZGl2c3R5bGUuZmluZEluZGV4KHZhbCA9PiB2YWwuZ3JvdXBOYW1lID09PSBjdHJsU2VsW2luZGV4XSk7CiAgICAgICAgY29uc3QgY3VyUHJvcCA9IGRpdnN0eWxlW2dyb3VwSW5kZXhdOwogICAgICAgIGNvbnN0IGxlZnQgPSBwYXJzZUludChjdXJQcm9wLmxlZnQpOwogICAgICAgIGNvbnN0IHRvcCA9IHBhcnNlSW50KGN1clByb3AudG9wKTsKICAgICAgICBjb25zdCB3aWR0aCA9IHBhcnNlSW50KGN1clByb3Aud2lkdGgpOwogICAgICAgIGNvbnN0IGhlaWdodCA9IHBhcnNlSW50KGN1clByb3AuaGVpZ2h0KTsKICAgICAgICBsZXQgdmFsdWUgPSAtMTsKCiAgICAgICAgaWYgKHByb3BOYW1lID09PSAnc2VsQ2VudGVyJykgewogICAgICAgICAgdmFsdWUgPSBwcm9wVmFsdWUgLSB3aWR0aCAvIDI7CiAgICAgICAgICBFdmVudEJ1cy4kZW1pdCgndXBkYXN0ZUdyb3VwU2l6ZScsICdMZWZ0JywgdmFsdWUsIGdyb3VwSW5kZXgpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHByb3BOYW1lID09PSAnc2VsTWlkZGxlJykgewogICAgICAgICAgdmFsdWUgPSBwcm9wVmFsdWUgLSBoZWlnaHQgLyAyOwogICAgICAgICAgRXZlbnRCdXMuJGVtaXQoJ3VwZGFzdGVHcm91cFNpemUnLCAnVG9wJywgdmFsdWUsIGdyb3VwSW5kZXgpOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KCiAgY2VudHJlSW5Gb3JtKHZhbHVlKSB7CiAgICBsZXQgZGl2c3R5bGUgPSBbXTsKICAgIGNvbnN0IG1haW5Db250YWluZXIgPSB0aGlzLnNlbGVjdGVkQ29udHJvbHNbdGhpcy51c2VyRm9ybUlkXS5jb250YWluZXJbMF07CiAgICBjb25zdCB1c3JGcm1EYXRhID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXTsKICAgIGNvbnN0IGN0cmxQcm9wID0gdXNyRnJtRGF0YVttYWluQ29udGFpbmVyXS5wcm9wZXJ0aWVzOwoKICAgIGlmICh2YWx1ZSA9PT0gJ2hvcml6b250YWwnKSB7CiAgICAgIGNvbnN0IHNlbENlbnRlciA9IGN0cmxQcm9wLkxlZnQgKyBjdHJsUHJvcC5XaWR0aCAvIDI7CiAgICAgIHRoaXMudXBkYXRlUHJvcFZhbCgnc2VsQ2VudGVyJywgc2VsQ2VudGVyKTsKICAgIH0gZWxzZSBpZiAodmFsdWUgPT09ICd2ZXJ0aWNhbCcpIHsKICAgICAgY29uc3Qgc2VsTWlkZGxlID0gY3RybFByb3AuVG9wICsgY3RybFByb3AuSGVpZ2h0IC8gMjsKICAgICAgdGhpcy51cGRhdGVQcm9wVmFsKCdzZWxNaWRkbGUnLCBzZWxNaWRkbGUpOwogICAgfQogIH0KCiAgYXJyYW5nZUJ1dHRvbih0eXBlKSB7CiAgICBjb25zdCB1c3JGcm1EYXRhID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXTsKICAgIGNvbnN0IGN0cmxTZWwgPSB0aGlzLnNlbGVjdGVkQ29udHJvbHNbdGhpcy51c2VyRm9ybUlkXS5zZWxlY3RlZDsKICAgIGxldCBjdHJsQ29udGFpbmVyID0gdGhpcy5zZWxlY3RlZENvbnRyb2xzW3RoaXMudXNlckZvcm1JZF0uY29udGFpbmVyWzBdOwogICAgY3RybENvbnRhaW5lciA9IHVzckZybURhdGFbY3RybENvbnRhaW5lcl0udHlwZSA9PT0gJ1BhZ2UnID8gdGhpcy5zZWxlY3RlZENvbnRyb2xzW3RoaXMudXNlckZvcm1JZF0uY29udGFpbmVyWzFdIDogY3RybENvbnRhaW5lcjsKICAgIGNvbnN0IGJ1dHRvbkFycmF5ID0gW107CgogICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IGN0cmxTZWwubGVuZ3RoOyBpbmRleCsrKSB7CiAgICAgIGlmICghY3RybFNlbFtpbmRleF0uc3RhcnRzV2l0aCgnZ3JvdXAnKSkgewogICAgICAgIGNvbnN0IGNvbnRyb2xwcm9wID0gdXNyRnJtRGF0YVtjdHJsU2VsW2luZGV4XV07CgogICAgICAgIGlmIChjb250cm9scHJvcC50eXBlID09PSAnQ29tbWFuZEJ1dHRvbicpIHsKICAgICAgICAgIGJ1dHRvbkFycmF5LnB1c2goY3RybFNlbFtpbmRleF0pOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIGlmICh0eXBlID09PSAnYm90dG9tJykgewogICAgICBidXR0b25BcnJheS5zb3J0KChhLCBiKSA9PiB7CiAgICAgICAgcmV0dXJuIHVzckZybURhdGFbYV0ucHJvcGVydGllcy5MZWZ0IC0gdXNyRnJtRGF0YVtiXS5wcm9wZXJ0aWVzLkxlZnQ7CiAgICAgIH0pOwogICAgfSBlbHNlIGlmICh0eXBlID09PSAncmlnaHQnKSB7CiAgICAgIGJ1dHRvbkFycmF5LnNvcnQoKGEsIGIpID0+IHsKICAgICAgICByZXR1cm4gdXNyRnJtRGF0YVthXS5wcm9wZXJ0aWVzLlRvcCAtIHVzckZybURhdGFbYl0ucHJvcGVydGllcy5Ub3A7CiAgICAgIH0pOwogICAgfQoKICAgIGNvbnN0IGNvbnRhaW5lclByb3AgPSB1c3JGcm1EYXRhW2N0cmxDb250YWluZXJdLnByb3BlcnRpZXM7CiAgICBsZXQgdmFsdWUgPSAwOwogICAgY29uc3QgY29udGFpbmVySGVpZ2h0ID0gdXNyRnJtRGF0YVtjdHJsQ29udGFpbmVyXS50eXBlID09PSAnVXNlcmZvcm0nID8gNDcgOiB1c3JGcm1EYXRhW2N0cmxDb250YWluZXJdLnR5cGUgPT09ICdGcmFtZScgPyAyNyA6IHVzckZybURhdGFbY3RybENvbnRhaW5lcl0udHlwZSA9PT0gJ011bHRpUGFnZScgPyA0MCA6IDA7CiAgICBjb25zdCBjb250YWluZXJXaWR0aCA9IDIwOwoKICAgIGlmICh0eXBlID09PSAnYm90dG9tJykgewogICAgICB2YWx1ZSA9IGNvbnRhaW5lclByb3AuSGVpZ2h0IC0gY29udGFpbmVySGVpZ2h0IC0gdXNyRnJtRGF0YVtidXR0b25BcnJheVswXV0ucHJvcGVydGllcy5IZWlnaHQ7CiAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KCdUb3AnLCB2YWx1ZSwgYnV0dG9uQXJyYXlbMF0pOwogICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSgnTGVmdCcsIDMwLCBidXR0b25BcnJheVswXSk7CiAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdyaWdodCcpIHsKICAgICAgdmFsdWUgPSBjb250YWluZXJQcm9wLldpZHRoIC0gY29udGFpbmVyV2lkdGggLSB1c3JGcm1EYXRhW2J1dHRvbkFycmF5WzBdXS5wcm9wZXJ0aWVzLldpZHRoOwogICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSgnTGVmdCcsIHZhbHVlLCBidXR0b25BcnJheVswXSk7CiAgICAgIHRoaXMudXBkYXRlQ29udHJvbFByb3BlcnR5KCdUb3AnLCAyMCwgYnV0dG9uQXJyYXlbMF0pOwogICAgfQoKICAgIGZvciAobGV0IGluZGV4ID0gMTsgaW5kZXggPCBidXR0b25BcnJheS5sZW5ndGg7IGluZGV4KyspIHsKICAgICAgY29uc3QgcHJldkN0cmxQcm9wID0gdXNyRnJtRGF0YVtidXR0b25BcnJheVtpbmRleCAtIDFdXS5wcm9wZXJ0aWVzOwogICAgICBjb25zdCBjdHJsUHJvcCA9IHVzckZybURhdGFbYnV0dG9uQXJyYXlbaW5kZXhdXS5wcm9wZXJ0aWVzOwoKICAgICAgaWYgKHR5cGUgPT09ICdib3R0b20nKSB7CiAgICAgICAgbGV0IHByb3BWYWx1ZSA9IHByZXZDdHJsUHJvcC5MZWZ0ICsgcHJldkN0cmxQcm9wLldpZHRoICsgMTA7CiAgICAgICAgdmFsdWUgPSBjb250YWluZXJQcm9wLkhlaWdodCAtIGNvbnRhaW5lckhlaWdodCAtIHVzckZybURhdGFbYnV0dG9uQXJyYXlbaW5kZXhdXS5wcm9wZXJ0aWVzLkhlaWdodDsKCiAgICAgICAgaWYgKHByb3BWYWx1ZSArIGN0cmxQcm9wLldpZHRoIDw9IGNvbnRhaW5lclByb3AuV2lkdGggLSBjb250YWluZXJXaWR0aCkgewogICAgICAgICAgdGhpcy51cGRhdGVDb250cm9sUHJvcGVydHkoJ0xlZnQnLCBwcm9wVmFsdWUsIGJ1dHRvbkFycmF5W2luZGV4XSk7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSgnVG9wJywgdmFsdWUsIGJ1dHRvbkFycmF5W2luZGV4XSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHByb3BWYWx1ZSA9IGNvbnRhaW5lclByb3AuV2lkdGggLSBjb250YWluZXJXaWR0aCAtIGN0cmxQcm9wLldpZHRoOwogICAgICAgICAgdGhpcy51cGRhdGVDb250cm9sUHJvcGVydHkoJ0xlZnQnLCBwcm9wVmFsdWUsIGJ1dHRvbkFycmF5W2luZGV4XSk7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSgnVG9wJywgdmFsdWUsIGJ1dHRvbkFycmF5W2luZGV4XSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgaWYgKHR5cGUgPT09ICdyaWdodCcpIHsKICAgICAgICBsZXQgcHJvcFZhbHVlID0gcHJldkN0cmxQcm9wLlRvcCArIHByZXZDdHJsUHJvcC5IZWlnaHQgKyAxMDsKICAgICAgICB2YWx1ZSA9IGNvbnRhaW5lclByb3AuV2lkdGggLSBjb250YWluZXJXaWR0aCAtIHVzckZybURhdGFbYnV0dG9uQXJyYXlbaW5kZXhdXS5wcm9wZXJ0aWVzLldpZHRoOwoKICAgICAgICBpZiAocHJvcFZhbHVlICsgY3RybFByb3AuSGVpZ2h0IDw9IGNvbnRhaW5lclByb3AuSGVpZ2h0IC0gY29udGFpbmVySGVpZ2h0KSB7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSgnVG9wJywgcHJvcFZhbHVlLCBidXR0b25BcnJheVtpbmRleF0pOwogICAgICAgICAgdGhpcy51cGRhdGVDb250cm9sUHJvcGVydHkoJ0xlZnQnLCB2YWx1ZSwgYnV0dG9uQXJyYXlbaW5kZXhdKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcHJvcFZhbHVlID0gY29udGFpbmVyUHJvcC5IZWlnaHQgLSBjb250YWluZXJIZWlnaHQgLSBjdHJsUHJvcC5IZWlnaHQ7CiAgICAgICAgICB0aGlzLnVwZGF0ZUNvbnRyb2xQcm9wZXJ0eSgnVG9wJywgcHJvcFZhbHVlLCBidXR0b25BcnJheVtpbmRleF0pOwogICAgICAgICAgdGhpcy51cGRhdGVDb250cm9sUHJvcGVydHkoJ0xlZnQnLCB2YWx1ZSwgYnV0dG9uQXJyYXlbaW5kZXhdKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CgogIHVwZGF0ZUNvbnRyb2xQcm9wZXJ0eShwcm9wZXJ0eU5hbWUsIHByb3BlcnR5VmFsdWUsIGNvbnRyb2xJZCkgewogICAgdGhpcy51cGRhdGVDb250cm9sKHsKICAgICAgdXNlckZvcm1JZDogdGhpcy51c2VyRm9ybUlkLAogICAgICBjb250cm9sSWQ6IGNvbnRyb2xJZCwKICAgICAgcHJvcGVydHlOYW1lOiBwcm9wZXJ0eU5hbWUsCiAgICAgIHZhbHVlOiBwcm9wZXJ0eVZhbHVlCiAgICB9KTsKICB9CgogIGdldGRpc2FibGVTdHlsZShpZCkgewogICAgbGV0IGRpc2FibGVkID0gdHJ1ZTsKICAgIGNvbnN0IHNlbGVjdGVkID0gdGhpcy5zZWxlY3RlZENvbnRyb2xzW3RoaXMudXNlckZvcm1JZF0uc2VsZWN0ZWQ7CiAgICBjb25zdCBzZWxDb250YWluZXIgPSB0aGlzLnNlbGVjdGVkQ29udHJvbHNbdGhpcy51c2VyRm9ybUlkXS5jb250YWluZXI7CiAgICBjb25zdCB1c2VyRGF0YSA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF07CgogICAgaWYgKGlkID09PSAndW5Hcm91cCcpIHsKICAgICAgbGV0IGdyb3VwSWQgPSBmYWxzZTsKICAgICAgY29uc3Qgc2VsZWN0ZWRHcm91cEFycmF5ID0gc2VsZWN0ZWQuZmlsdGVyKHZhbCA9PiB2YWwuc3RhcnRzV2l0aCgnZ3JvdXAnKSAmJiB2YWwpOwoKICAgICAgaWYgKHNlbGVjdGVkR3JvdXBBcnJheS5sZW5ndGggPT09IDEgJiYgc2VsZWN0ZWQubGVuZ3RoID09PSAxKSB7CiAgICAgICAgZGlzYWJsZWQgPSBmYWxzZTsKICAgICAgfQogICAgfQoKICAgIGlmIChpZCA9PT0gJ2dyb3VwJykgewogICAgICBkaXNhYmxlZCA9IHNlbGVjdGVkLmxlbmd0aCA8PSAxOwogICAgfQoKICAgIGlmIChpZCA9PT0gJ3NpemVUb0dyaWQnIHx8IGlkID09PSAnY2VudHJlSW5Gb3JtJykgewogICAgICBkaXNhYmxlZCA9ICEoc2VsZWN0ZWQubGVuZ3RoID49IDEgJiYgc2VsZWN0ZWRbMF0gIT09IHNlbENvbnRhaW5lclswXSk7CiAgICB9CgogICAgaWYgKGlkID09PSAnc2l6ZVRvRml0JykgewogICAgICBjb25zdCBzZWxTZWxlY3RlZCA9IFtdOwoKICAgICAgZm9yIChjb25zdCBjb250cm9sIG9mIHRoaXMuc2VsZWN0ZWRDb250cm9sc1t0aGlzLnVzZXJGb3JtSWRdLnNlbGVjdGVkKSB7CiAgICAgICAgaWYgKCFjb250cm9sLnN0YXJ0c1dpdGgoJ2dyb3VwJykpIHsKICAgICAgICAgIGNvbnN0IHR5cGUgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdW2NvbnRyb2xdLnR5cGU7CgogICAgICAgICAgaWYgKHR5cGUgIT09ICdNdWx0aVBhZ2UnICYmIHR5cGUgIT09ICdGcmFtZScgJiYgdHlwZSAhPT0gJ0xpc3RCb3gnICYmIHR5cGUgIT09ICdQYWdlJyAmJiB0eXBlICE9PSAnVGFiU3RyaXAnICYmIHR5cGUgIT09ICdVc2VyZm9ybScpIHsKICAgICAgICAgICAgc2VsU2VsZWN0ZWQucHVzaChjb250cm9sKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGRpc2FibGVkID0gIShzZWxTZWxlY3RlZC5sZW5ndGggPj0gMSk7CiAgICB9CgogICAgaWYgKGlkID09PSAnb3JkZXInKSB7CiAgICAgIGRpc2FibGVkID0gIShzZWxlY3RlZC5sZW5ndGggPj0gMSAmJiB1c2VyRGF0YVtzZWxDb250YWluZXJbMF1dLmNvbnRyb2xzLmxlbmd0aCA+PSAyKTsKICAgIH0KCiAgICBpZiAoaWQgPT09ICdtYWtlRXF1YWwnKSB7CiAgICAgIGRpc2FibGVkID0gIShzZWxlY3RlZC5sZW5ndGggPj0gMyk7CiAgICB9CgogICAgaWYgKGlkID09PSAnaW5jRGVjc3BhY2luZycgfHwgaWQgPT09ICdyZW1vdmVTcGFjZScpIHsKICAgICAgZGlzYWJsZWQgPSAhKHNlbGVjdGVkLmxlbmd0aCA+PSAyKTsKICAgIH0KCiAgICBpZiAoaWQgPT09ICdhcnJhbmdlQnV0dG9uJykgewogICAgICBjb25zdCBidXR0b25BcnJheSA9IFtdOwoKICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHNlbGVjdGVkLmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgIGlmICghc2VsZWN0ZWRbaW5kZXhdLnN0YXJ0c1dpdGgoJ2dyb3VwJykpIHsKICAgICAgICAgIGNvbnN0IGNvbnRyb2xwcm9wID0gdXNlckRhdGFbc2VsZWN0ZWRbaW5kZXhdXTsKCiAgICAgICAgICBpZiAoY29udHJvbHByb3AudHlwZSA9PT0gJ0NvbW1hbmRCdXR0b24nKSB7CiAgICAgICAgICAgIGJ1dHRvbkFycmF5LnB1c2goc2VsZWN0ZWRbaW5kZXhdKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIGRpc2FibGVkID0gIShidXR0b25BcnJheS5sZW5ndGggPj0gMSk7CiAgICB9CgogICAgcmV0dXJuIGRpc2FibGVkOwogIH0KCiAgYnJpbmdGb3J3YXJkKCkgewogICAgY29uc3QgdXNlckRhdGEgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdOwogICAgY29uc3QgaGlnaFByb3JDb250cm9sID0gW107CiAgICBjb25zdCBsb3dQcm9yQ29udHJvbCA9IFtdOwogICAgY29uc3QgY29udGFpbmVyID0gdGhpcy5nZXRDb250YWluZXJMaXN0KHRoaXMuZ2V0U2VsZWN0ZWRDb250cm9sc0RhdGFzWzBdKVswXTsKICAgIGNvbnN0IGNvbnRhaW5lckNvbnRyb2xzID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXVtjb250YWluZXJdLmNvbnRyb2xzOwoKICAgIGZvciAoY29uc3QgaW5kZXggaW4gY29udGFpbmVyQ29udHJvbHMpIHsKICAgICAgY29uc3QgY250cmxEYXRhID0gdGhpcy51c2VyZm9ybURhdGFbdGhpcy51c2VyRm9ybUlkXVtjb250YWluZXJDb250cm9sc1tpbmRleF1dOwoKICAgICAgaWYgKGNudHJsRGF0YS50eXBlID09PSAnTXVsdGlQYWdlJyB8fCBjbnRybERhdGEudHlwZSA9PT0gJ0ZyYW1lJyB8fCBjbnRybERhdGEudHlwZSA9PT0gJ0xpc3RCb3gnKSB7CiAgICAgICAgaGlnaFByb3JDb250cm9sLnB1c2goY29udGFpbmVyQ29udHJvbHNbaW5kZXhdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBsb3dQcm9yQ29udHJvbC5wdXNoKGNvbnRhaW5lckNvbnRyb2xzW2luZGV4XSk7CiAgICAgIH0KICAgIH0KCiAgICBsZXQgbmV4dFNlbGN0ZWRTZXJpZXMgPSBbXTsKICAgIGxldCBuZXh0SGlnaENvbnRyb2xTZXJpZXMgPSBbXTsKICAgIGNvbnN0IGdldFNlbENvbnRyb2wgPSBbLi4udGhpcy5nZXRTZWxlY3RlZENvbnRyb2xzRGF0YXNdOwogICAgZ2V0U2VsQ29udHJvbC5zb3J0KChhLCBiKSA9PiB7CiAgICAgIHJldHVybiB1c2VyRGF0YVthXS5leHRyYURhdGFzLnpJbmRleCAtIHVzZXJEYXRhW2JdLmV4dHJhRGF0YXMuekluZGV4OwogICAgfSk7CgogICAgZm9yIChjb25zdCBzZWxDb250cm9sIG9mIGdldFNlbENvbnRyb2wpIHsKICAgICAgY29uc3QgdHlwZSA9IHVzZXJEYXRhW3NlbENvbnRyb2xdLnR5cGU7CiAgICAgIGNvbnN0IHRlbXBaSW5kZXggPSB1c2VyRGF0YVtzZWxDb250cm9sXS5leHRyYURhdGFzLnpJbmRleDsKICAgICAgY29uc3QgY29udHJvbEluZGV4ID0gT2JqZWN0LmtleXModXNlckRhdGEpLmZpbmRJbmRleCgodmFsLCBpbmRleCkgPT4gewogICAgICAgIHJldHVybiAnekluZGV4JyBpbiB1c2VyRGF0YVt2YWxdLmV4dHJhRGF0YXMgJiYgdXNlckRhdGFbdmFsXS5leHRyYURhdGFzLnpJbmRleCA9PT0gdGVtcFpJbmRleCArIDE7CiAgICAgIH0pOwogICAgICBjb25zdCBuZXh0U2VsZWN0ZWRDb250cm9sID0gY29udHJvbEluZGV4ICE9PSAtMSA/IE9iamVjdC5rZXlzKHVzZXJEYXRhKVtjb250cm9sSW5kZXhdIDogJyc7CiAgICAgIGNvbnN0IG5leHRDb250cm9sVHlwZSA9IHVzZXJEYXRhW25leHRTZWxlY3RlZENvbnRyb2xdLnR5cGU7CgogICAgICBpZiAobmV4dFNlbGVjdGVkQ29udHJvbCAhPT0gJycgJiYgIWhpZ2hQcm9yQ29udHJvbC5pbmNsdWRlcyhuZXh0U2VsZWN0ZWRDb250cm9sKSkgewogICAgICAgIGlmIChnZXRTZWxDb250cm9sLmluY2x1ZGVzKG5leHRTZWxlY3RlZENvbnRyb2wpKSB7CiAgICAgICAgICBpZiAoIW5leHRTZWxjdGVkU2VyaWVzLmluY2x1ZGVzKHNlbENvbnRyb2wpKSB7CiAgICAgICAgICAgIG5leHRTZWxjdGVkU2VyaWVzLnB1c2goc2VsQ29udHJvbCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFuZXh0U2VsY3RlZFNlcmllcy5pbmNsdWRlcyhuZXh0U2VsZWN0ZWRDb250cm9sKSkgewogICAgICAgICAgICBuZXh0U2VsY3RlZFNlcmllcy5wdXNoKG5leHRTZWxlY3RlZENvbnRyb2wpOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoT2JqZWN0LmtleXMobmV4dFNlbGN0ZWRTZXJpZXMpLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgICBjb25zdCB0ZW1wRXhjaGFnZUluZGV4ID0gdXNlckRhdGFbbmV4dFNlbGN0ZWRTZXJpZXNbMF1dLmV4dHJhRGF0YXMuekluZGV4OwogICAgICAgICAgICBjb25zdCBzd2FwVGFiSW5kZXggPSB1c2VyRGF0YVtuZXh0U2VsZWN0ZWRDb250cm9sXS5leHRyYURhdGFzLnpJbmRleDsKCiAgICAgICAgICAgIGlmIChzd2FwVGFiSW5kZXggPD0gdXNlckRhdGFbY29udGFpbmVyXS5jb250cm9scy5sZW5ndGgKICAgICAgICAgICAgLyogJiYgc3dhcFRhYkluZGV4ID4gMCAqLwogICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdXNlckRhdGFbY29udGFpbmVyXS5jb250cm9scy5maW5kSW5kZXgodmFsID0+IHVzZXJEYXRhW3ZhbF0uZXh0cmFEYXRhcy56SW5kZXggPT09IHN3YXBUYWJJbmRleCk7CiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXModXNlckRhdGFbY29udGFpbmVyXS5jb250cm9sc1tpbmRleF0sICd6SW5kZXgnLCB0ZW1wRXhjaGFnZUluZGV4KTsKICAgICAgICAgICAgICAgIHRoaXMudXBkYXRlRXh0cmFEYXRhcyhuZXh0U2VsY3RlZFNlcmllc1swXSwgJ3pJbmRleCcsIHN3YXBUYWJJbmRleCAtIChuZXh0U2VsY3RlZFNlcmllcy5sZW5ndGggLSAxKSk7CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm9yIChsZXQgaiA9IDE7IGogPCBuZXh0U2VsY3RlZFNlcmllcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUluZGV4ID0gdXNlckRhdGFbbmV4dFNlbGN0ZWRTZXJpZXNbal1dLmV4dHJhRGF0YXMuekluZGV4ICsgMTsKICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXMobmV4dFNlbGN0ZWRTZXJpZXNbal0sICd6SW5kZXgnLCB1cGRhdGVJbmRleCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHRTZWxjdGVkU2VyaWVzID0gW107CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBzd2FwVGFiSW5kZXggPSB1c2VyRGF0YVtuZXh0U2VsZWN0ZWRDb250cm9sXS5leHRyYURhdGFzLnpJbmRleDsKCiAgICAgICAgICAgIGlmIChzd2FwVGFiSW5kZXggPD0gdXNlckRhdGFbY29udGFpbmVyXS5jb250cm9scy5sZW5ndGgKICAgICAgICAgICAgLyogJiYgc3dhcFRhYkluZGV4ID4gMCAqLwogICAgICAgICAgICApIHsKICAgICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdXNlckRhdGFbY29udGFpbmVyXS5jb250cm9scy5maW5kSW5kZXgodmFsID0+IHVzZXJEYXRhW3ZhbF0uZXh0cmFEYXRhcy56SW5kZXggPT09IHN3YXBUYWJJbmRleCk7CiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXMoc2VsQ29udHJvbCwgJ3pJbmRleCcsIHN3YXBUYWJJbmRleCk7CiAgICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXMobmV4dFNlbGVjdGVkQ29udHJvbCwgJ3pJbmRleCcsIHRlbXBaSW5kZXgpOwogICAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGdldFNlbENvbnRyb2wuaW5jbHVkZXMobmV4dFNlbGVjdGVkQ29udHJvbCkgJiYgKHR5cGUgPT09ICdGcmFtZScgfHwgdHlwZSA9PT0gJ011bHRpUGFnZScgfHwgdHlwZSA9PT0gJ0xpc3RCb3gnKSkgewogICAgICAgICAgaWYgKCFuZXh0SGlnaENvbnRyb2xTZXJpZXMuaW5jbHVkZXMoc2VsQ29udHJvbCkpIHsKICAgICAgICAgICAgbmV4dEhpZ2hDb250cm9sU2VyaWVzLnB1c2goc2VsQ29udHJvbCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFuZXh0SGlnaENvbnRyb2xTZXJpZXMuaW5jbHVkZXMobmV4dFNlbGVjdGVkQ29udHJvbCkpIHsKICAgICAgICAgICAgbmV4dEhpZ2hDb250cm9sU2VyaWVzLnB1c2gobmV4dFNlbGVjdGVkQ29udHJvbCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnRnJhbWUnIHx8IHR5cGUgPT09ICdNdWx0aVBhZ2UnIHx8IHR5cGUgPT09ICdMaXN0Qm94JykgewogICAgICAgICAgaWYgKE9iamVjdC5rZXlzKG5leHRIaWdoQ29udHJvbFNlcmllcykubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBFeGNoYWdlSW5kZXggPSB1c2VyRGF0YVtuZXh0SGlnaENvbnRyb2xTZXJpZXNbMF1dLmV4dHJhRGF0YXMuekluZGV4OwogICAgICAgICAgICBjb25zdCBzd2FwVGFiSW5kZXggPSB1c2VyRGF0YVtuZXh0U2VsZWN0ZWRDb250cm9sXS5leHRyYURhdGFzLnpJbmRleDsKCiAgICAgICAgICAgIGlmIChzd2FwVGFiSW5kZXggPD0gdXNlckRhdGFbY29udGFpbmVyXS5jb250cm9scy5sZW5ndGgpIHsKICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHVzZXJEYXRhW2NvbnRhaW5lcl0uY29udHJvbHMuZmluZEluZGV4KHZhbCA9PiB1c2VyRGF0YVt2YWxdLmV4dHJhRGF0YXMuekluZGV4ID09PSBzd2FwVGFiSW5kZXgpOwogICAgICAgICAgICAgIHRoaXMudXBkYXRlRXh0cmFEYXRhcyh1c2VyRGF0YVtjb250YWluZXJdLmNvbnRyb2xzW2luZGV4XSwgJ3pJbmRleCcsIHRlbXBFeGNoYWdlSW5kZXgpOwogICAgICAgICAgICAgIHRoaXMudXBkYXRlRXh0cmFEYXRhcyhuZXh0SGlnaENvbnRyb2xTZXJpZXNbMF0sICd6SW5kZXgnLCBzd2FwVGFiSW5kZXggLSAobmV4dEhpZ2hDb250cm9sU2VyaWVzLmxlbmd0aCAtIDEpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm9yIChsZXQgaiA9IDE7IGogPCBuZXh0SGlnaENvbnRyb2xTZXJpZXMubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgICBjb25zdCB1cGRhdGVJbmRleCA9IHVzZXJEYXRhW25leHRIaWdoQ29udHJvbFNlcmllc1tqXV0uZXh0cmFEYXRhcy56SW5kZXggKyAxOwogICAgICAgICAgICAgIHRoaXMudXBkYXRlRXh0cmFEYXRhcyhuZXh0SGlnaENvbnRyb2xTZXJpZXNbal0sICd6SW5kZXgnLCB1cGRhdGVJbmRleCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHRIaWdoQ29udHJvbFNlcmllcyA9IFtdOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc3Qgc3dhcFRhYkluZGV4ID0gdXNlckRhdGFbbmV4dFNlbGVjdGVkQ29udHJvbF0uZXh0cmFEYXRhcy56SW5kZXg7CgogICAgICAgICAgICBpZiAoc3dhcFRhYkluZGV4IDw9IHVzZXJEYXRhW2NvbnRhaW5lcl0uY29udHJvbHMubGVuZ3RoCiAgICAgICAgICAgIC8qICYmIHN3YXBUYWJJbmRleCA+IDAgKi8KICAgICAgICAgICAgKSB7CiAgICAgICAgICAgICAgICBjb25zdCBpbmRleCA9IHVzZXJEYXRhW2NvbnRhaW5lcl0uY29udHJvbHMuZmluZEluZGV4KHZhbCA9PiB1c2VyRGF0YVt2YWxdLmV4dHJhRGF0YXMuekluZGV4ID09PSBzd2FwVGFiSW5kZXgpOwogICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKHNlbENvbnRyb2wsICd6SW5kZXgnLCBzd2FwVGFiSW5kZXgpOwogICAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKG5leHRTZWxlY3RlZENvbnRyb2wsICd6SW5kZXgnLCB0ZW1wWkluZGV4KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQoKICBzZW5kQmFja3dhcmQoKSB7CiAgICBjb25zdCB1c2VyRGF0YSA9IHRoaXMudXNlcmZvcm1EYXRhW3RoaXMudXNlckZvcm1JZF07CiAgICBjb25zdCBoaWdoUHJvckNvbnRyb2wgPSBbXTsKICAgIGNvbnN0IGxvd1Byb3JDb250cm9sID0gW107CiAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmdldENvbnRhaW5lckxpc3QodGhpcy5nZXRTZWxlY3RlZENvbnRyb2xzRGF0YXNbMF0pWzBdOwogICAgY29uc3QgY29udGFpbmVyQ29udHJvbHMgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdW2NvbnRhaW5lcl0uY29udHJvbHM7CgogICAgZm9yIChjb25zdCBpbmRleCBpbiBjb250YWluZXJDb250cm9scykgewogICAgICBjb25zdCBjbnRybERhdGEgPSB0aGlzLnVzZXJmb3JtRGF0YVt0aGlzLnVzZXJGb3JtSWRdW2NvbnRhaW5lckNvbnRyb2xzW2luZGV4XV07CgogICAgICBpZiAoY250cmxEYXRhLnR5cGUgPT09ICdNdWx0aVBhZ2UnIHx8IGNudHJsRGF0YS50eXBlID09PSAnRnJhbWUnIHx8IGNudHJsRGF0YS50eXBlID09PSAnTGlzdEJveCcpIHsKICAgICAgICBoaWdoUHJvckNvbnRyb2wucHVzaChjb250YWluZXJDb250cm9sc1tpbmRleF0pOwogICAgICB9IGVsc2UgewogICAgICAgIGxvd1Byb3JDb250cm9sLnB1c2goY29udGFpbmVyQ29udHJvbHNbaW5kZXhdKTsKICAgICAgfQogICAgfQoKICAgIGxldCBuZXh0U2VsY3RlZFNlcmllcyA9IFtdOwogICAgbGV0IG5leHRIaWdoQ29udHJvbFNlcmllcyA9IFtdOwogICAgY29uc3QgZ2V0U2VsQ29udHJvbCA9IFsuLi50aGlzLmdldFNlbGVjdGVkQ29udHJvbHNEYXRhc107CiAgICBnZXRTZWxDb250cm9sLnNvcnQoKGEsIGIpID0+IHsKICAgICAgcmV0dXJuIHVzZXJEYXRhW2FdLmV4dHJhRGF0YXMuekluZGV4IC0gdXNlckRhdGFbYl0uZXh0cmFEYXRhcy56SW5kZXg7CiAgICB9KTsKCiAgICBmb3IgKGNvbnN0IHNlbENvbnRyb2wgb2YgZ2V0U2VsQ29udHJvbCkgewogICAgICBjb25zdCB0eXBlID0gdXNlckRhdGFbc2VsQ29udHJvbF0udHlwZTsKICAgICAgY29uc3QgdGVtcFpJbmRleCA9IHVzZXJEYXRhW3NlbENvbnRyb2xdLmV4dHJhRGF0YXMuekluZGV4OwogICAgICBjb25zdCBjb250cm9sSW5kZXggPSBPYmplY3Qua2V5cyh1c2VyRGF0YSkuZmluZEluZGV4KCh2YWwsIGluZGV4KSA9PiB7CiAgICAgICAgcmV0dXJuICd6SW5kZXgnIGluIHVzZXJEYXRhW3ZhbF0uZXh0cmFEYXRhcyAmJiB1c2VyRGF0YVt2YWxdLmV4dHJhRGF0YXMuekluZGV4ID09PSB0ZW1wWkluZGV4IC0gMTsKICAgICAgfSk7CiAgICAgIGNvbnN0IG5leHRTZWxlY3RlZENvbnRyb2wgPSBjb250cm9sSW5kZXggIT09IC0xID8gT2JqZWN0LmtleXModXNlckRhdGEpW2NvbnRyb2xJbmRleF0gOiAnJzsKICAgICAgY29uc3QgbmV4dENvbnRyb2xUeXBlID0gdXNlckRhdGFbbmV4dFNlbGVjdGVkQ29udHJvbF0udHlwZTsKCiAgICAgIGlmIChuZXh0U2VsZWN0ZWRDb250cm9sICE9PSAnJyAmJiAhaGlnaFByb3JDb250cm9sLmluY2x1ZGVzKHNlbENvbnRyb2wpKSB7CiAgICAgICAgaWYgKGdldFNlbENvbnRyb2wuaW5jbHVkZXMobmV4dFNlbGVjdGVkQ29udHJvbCkpIHsKICAgICAgICAgIGlmICghbmV4dFNlbGN0ZWRTZXJpZXMuaW5jbHVkZXMoc2VsQ29udHJvbCkpIHsKICAgICAgICAgICAgbmV4dFNlbGN0ZWRTZXJpZXMucHVzaChzZWxDb250cm9sKTsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoIW5leHRTZWxjdGVkU2VyaWVzLmluY2x1ZGVzKG5leHRTZWxlY3RlZENvbnRyb2wpKSB7CiAgICAgICAgICAgIG5leHRTZWxjdGVkU2VyaWVzLnB1c2gobmV4dFNlbGVjdGVkQ29udHJvbCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhuZXh0U2VsY3RlZFNlcmllcykubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgICAgIGNvbnN0IHRlbXBFeGNoYWdlSW5kZXggPSB1c2VyRGF0YVtuZXh0U2VsY3RlZFNlcmllc1swXV0uZXh0cmFEYXRhcy56SW5kZXg7CiAgICAgICAgICAgIGNvbnN0IHN3YXBUYWJJbmRleCA9IHVzZXJEYXRhW25leHRTZWxlY3RlZENvbnRyb2xdLmV4dHJhRGF0YXMuekluZGV4OwoKICAgICAgICAgICAgaWYgKHN3YXBUYWJJbmRleCA8PSB1c2VyRGF0YVtjb250YWluZXJdLmNvbnRyb2xzLmxlbmd0aCAmJiBzd2FwVGFiSW5kZXggPiAwKSB7CiAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSB1c2VyRGF0YVtjb250YWluZXJdLmNvbnRyb2xzLmZpbmRJbmRleCh2YWwgPT4gdXNlckRhdGFbdmFsXS5leHRyYURhdGFzLnpJbmRleCA9PT0gc3dhcFRhYkluZGV4KTsKICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXModXNlckRhdGFbY29udGFpbmVyXS5jb250cm9sc1tpbmRleF0sICd6SW5kZXgnLCB0ZW1wRXhjaGFnZUluZGV4KTsKICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXMobmV4dFNlbGN0ZWRTZXJpZXNbMF0sICd6SW5kZXgnLCBuZXh0U2VsY3RlZFNlcmllcy5sZW5ndGggKyAxIC0gc3dhcFRhYkluZGV4KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgZm9yIChsZXQgaiA9IDE7IGogPCBuZXh0U2VsY3RlZFNlcmllcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUluZGV4ID0gdXNlckRhdGFbbmV4dFNlbGN0ZWRTZXJpZXNbal1dLmV4dHJhRGF0YXMuekluZGV4IC0gMTsKICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXMobmV4dFNlbGN0ZWRTZXJpZXNbal0sICd6SW5kZXgnLCB1cGRhdGVJbmRleCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIG5leHRTZWxjdGVkU2VyaWVzID0gW107CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBzd2FwVGFiSW5kZXggPSB1c2VyRGF0YVtuZXh0U2VsZWN0ZWRDb250cm9sXS5leHRyYURhdGFzLnpJbmRleDsKCiAgICAgICAgICAgIGlmIChzd2FwVGFiSW5kZXggPD0gdXNlckRhdGFbY29udGFpbmVyXS5jb250cm9scy5sZW5ndGggJiYgc3dhcFRhYkluZGV4ID4gMCkgewogICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdXNlckRhdGFbY29udGFpbmVyXS5jb250cm9scy5maW5kSW5kZXgodmFsID0+IHVzZXJEYXRhW3ZhbF0uZXh0cmFEYXRhcy56SW5kZXggPT09IHN3YXBUYWJJbmRleCk7CiAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKHNlbENvbnRyb2wsICd6SW5kZXgnLCBzd2FwVGFiSW5kZXgpOwogICAgICAgICAgICAgIHRoaXMudXBkYXRlRXh0cmFEYXRhcyhuZXh0U2VsZWN0ZWRDb250cm9sLCAnekluZGV4JywgdGVtcFpJbmRleCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSBpZiAoIWxvd1Byb3JDb250cm9sLmluY2x1ZGVzKG5leHRTZWxlY3RlZENvbnRyb2wpICYmICh0eXBlID09PSAnRnJhbWUnIHx8IHR5cGUgPT09ICdNdWx0aVBhZ2UnIHx8IHR5cGUgPT09ICdMaXN0Qm94JykpIHsKICAgICAgICBpZiAoZ2V0U2VsQ29udHJvbC5pbmNsdWRlcyhuZXh0U2VsZWN0ZWRDb250cm9sKSkgewogICAgICAgICAgaWYgKCFuZXh0SGlnaENvbnRyb2xTZXJpZXMuaW5jbHVkZXMoc2VsQ29udHJvbCkpIHsKICAgICAgICAgICAgbmV4dEhpZ2hDb250cm9sU2VyaWVzLnB1c2goc2VsQ29udHJvbCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFuZXh0SGlnaENvbnRyb2xTZXJpZXMuaW5jbHVkZXMobmV4dFNlbGVjdGVkQ29udHJvbCkpIHsKICAgICAgICAgICAgbmV4dEhpZ2hDb250cm9sU2VyaWVzLnB1c2gobmV4dFNlbGVjdGVkQ29udHJvbCk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhuZXh0SGlnaENvbnRyb2xTZXJpZXMpLmxlbmd0aCAhPT0gMCkgewogICAgICAgICAgICBjb25zdCB0ZW1wRXhjaGFnZUluZGV4ID0gdXNlckRhdGFbbmV4dEhpZ2hDb250cm9sU2VyaWVzWzBdXS5leHRyYURhdGFzLnpJbmRleDsKICAgICAgICAgICAgY29uc3Qgc3dhcFRhYkluZGV4ID0gdXNlckRhdGFbbmV4dFNlbGVjdGVkQ29udHJvbF0uZXh0cmFEYXRhcy56SW5kZXg7CgogICAgICAgICAgICBpZiAoc3dhcFRhYkluZGV4IDw9IHVzZXJEYXRhW2NvbnRhaW5lcl0uY29udHJvbHMubGVuZ3RoKSB7CiAgICAgICAgICAgICAgY29uc3QgaW5kZXggPSB1c2VyRGF0YVtjb250YWluZXJdLmNvbnRyb2xzLmZpbmRJbmRleCh2YWwgPT4gdXNlckRhdGFbdmFsXS5leHRyYURhdGFzLnpJbmRleCA9PT0gc3dhcFRhYkluZGV4KTsKICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXModXNlckRhdGFbY29udGFpbmVyXS5jb250cm9sc1tpbmRleF0sICd6SW5kZXgnLCB0ZW1wRXhjaGFnZUluZGV4KTsKICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUV4dHJhRGF0YXMobmV4dEhpZ2hDb250cm9sU2VyaWVzWzBdLCAnekluZGV4JywgbmV4dEhpZ2hDb250cm9sU2VyaWVzLmxlbmd0aCArIDEgLSBzd2FwVGFiSW5kZXgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBmb3IgKGxldCBqID0gMTsgaiA8IG5leHRIaWdoQ29udHJvbFNlcmllcy5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgIGNvbnN0IHVwZGF0ZUluZGV4ID0gdXNlckRhdGFbbmV4dEhpZ2hDb250cm9sU2VyaWVzW2pdXS5leHRyYURhdGFzLnpJbmRleCAtIDE7CiAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKG5leHRIaWdoQ29udHJvbFNlcmllc1tqXSwgJ3pJbmRleCcsIHVwZGF0ZUluZGV4KTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgbmV4dEhpZ2hDb250cm9sU2VyaWVzID0gW107CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb25zdCBzd2FwVGFiSW5kZXggPSB1c2VyRGF0YVtuZXh0U2VsZWN0ZWRDb250cm9sXS5leHRyYURhdGFzLnpJbmRleDsKCiAgICAgICAgICAgIGlmIChzd2FwVGFiSW5kZXggPD0gdXNlckRhdGFbY29udGFpbmVyXS5jb250cm9scy5sZW5ndGggJiYgc3dhcFRhYkluZGV4ID4gMCkgewogICAgICAgICAgICAgIGNvbnN0IGluZGV4ID0gdXNlckRhdGFbY29udGFpbmVyXS5jb250cm9scy5maW5kSW5kZXgodmFsID0+IHVzZXJEYXRhW3ZhbF0uZXh0cmFEYXRhcy56SW5kZXggPT09IHN3YXBUYWJJbmRleCk7CiAgICAgICAgICAgICAgdGhpcy51cGRhdGVFeHRyYURhdGFzKHNlbENvbnRyb2wsICd6SW5kZXgnLCBzd2FwVGFiSW5kZXgpOwogICAgICAgICAgICAgIHRoaXMudXBkYXRlRXh0cmFEYXRhcyhuZXh0U2VsZWN0ZWRDb250cm9sLCAnekluZGV4JywgdGVtcFpJbmRleCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cgp9OwoKX19kZWNvcmF0ZShbQWN0aW9uKCdmZC9hZGRVc2VyZm9ybScpXSwgSGVhZGVyLnByb3RvdHlwZSwgImFkZENvbnRyb2wiLCB2b2lkIDApOwoKX19kZWNvcmF0ZShbQWN0aW9uKCdmZC9jaGFuZ2VSdW5Nb2RlJyldLCBIZWFkZXIucHJvdG90eXBlLCAiY2hhbmdlUnVuTW9kZSIsIHZvaWQgMCk7CgpfX2RlY29yYXRlKFtTdGF0ZShzdGF0ZSA9PiBzdGF0ZS5mZC5zZWxlY3RlZENvbnRyb2xzKV0sIEhlYWRlci5wcm90b3R5cGUsICJzZWxlY3RlZENvbnRyb2xzIiwgdm9pZCAwKTsKCl9fZGVjb3JhdGUoW1N0YXRlKHN0YXRlID0+IHN0YXRlLmZkLnVzZXJmb3JtRGF0YSldLCBIZWFkZXIucHJvdG90eXBlLCAidXNlcmZvcm1EYXRhIiwgdm9pZCAwKTsKCl9fZGVjb3JhdGUoW1N0YXRlKHN0YXRlID0+IHN0YXRlLmZkLmlzUnVuTW9kZSldLCBIZWFkZXIucHJvdG90eXBlLCAiaXNSdW5Nb2RlIiwgdm9pZCAwKTsKCl9fZGVjb3JhdGUoW0FjdGlvbignZmQvdXBkYXRlQ29udHJvbEV4dHJhRGF0YScpXSwgSGVhZGVyLnByb3RvdHlwZSwgInVwZGF0ZUNvbnRyb2xFeHRyYURhdGEiLCB2b2lkIDApOwoKSGVhZGVyID0gX19kZWNvcmF0ZShbQ29tcG9uZW50KHsKICBuYW1lOiAnSGVhZGVyJywKICBjb21wb25lbnRzOiB7CiAgICBGaWxlU2F2ZUxvZ28sCiAgICBDdXRMb2dvLAogICAgQ29weUxvZ28sCiAgICBQYXN0ZUxvZ28sCiAgICBGaW5kTG9nbywKICAgIFVuZG9Mb2dvLAogICAgUmVkb0xvZ28sCiAgICBEZXNpZ25Nb2RlTG9nbywKICAgIFBqRXhwbG9yZXJMb2dvLAogICAgUGpQcm9wZXJ0eUxvZ28sCiAgICBPYmpCcm93c2VyTG9nbywKICAgIFRvb2xCb3hMb2dvLAogICAgVXNlckZvcm1Mb2dvLAogICAgQ29kZUxvZ28sCiAgICBPYmplY3RMb2dvLAogICAgSGVscExvZ28sCiAgICBGRFNWR0ltYWdlCiAgfQp9KV0sIEhlYWRlcik7CmV4cG9ydCBkZWZhdWx0IEhlYWRlcjs="},{"version":3,"sources":["/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/mobiotics/Projects/hancom/FormcontrolLatest/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/mobiotics/Projects/hancom/FormcontrolLatest/src/FormDesigner/components/organisms/FDHeader/index.vue?vue&type=script&lang=ts&"],"names":[],"mappings":"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","sourcesContent":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\r\nimport { Component, Vue } from 'vue-property-decorator'\r\nimport { State, Action } from 'vuex-class'\r\nimport {\r\n  IaddUserform,\r\n  IupdateControlExtraData\r\n} from '@/storeModules/fd/actions'\r\nimport { ControlPropertyData } from '@/FormDesigner/models/ControlsTableProperties/ControlPropertyData'\r\nimport CutLogo from '../../../../assets/cut.svg'\r\nimport FileSaveLogo from '../../../../assets/file-save.svg'\r\nimport CopyLogo from '../../../../assets/copy.svg'\r\nimport PasteLogo from '../../../../assets/paste.svg'\r\nimport FindLogo from '../../../../assets/find.svg'\r\nimport UndoLogo from '../../../../assets/undo.svg'\r\nimport RedoLogo from '../../../../assets/redo.svg'\r\nimport DesignModeLogo from '../../../../assets/design-mode.svg'\r\nimport PjExplorerLogo from '../../../../assets/pj-explorer.svg'\r\nimport PjPropertyLogo from '../../../../assets/pj-property.svg'\r\nimport ObjBrowserLogo from '../../../../assets/obj-browser.svg'\r\nimport ToolBoxLogo from '../../../../assets/tool-box.svg'\r\nimport UserFormLogo from '../../../../assets/user-from.svg'\r\nimport HelpLogo from '../../../../assets/help.svg'\r\nimport CodeLogo from '../../../../assets/view-code.svg'\r\nimport ObjectLogo from '../../../../assets/view-object.svg'\r\nimport FDSVGImage from '@/FormDesigner/components/atoms/FDSVGImage/index.vue'\r\nimport { EventBus } from '@/FormDesigner/event-bus'\r\nimport FDCommonMethod from '@/api/abstract/FormDesigner/FDCommonMethod'\r\n\r\n@Component({\r\n  name: 'Header',\r\n  components: {\r\n    FileSaveLogo,\r\n    CutLogo,\r\n    CopyLogo,\r\n    PasteLogo,\r\n    FindLogo,\r\n    UndoLogo,\r\n    RedoLogo,\r\n    DesignModeLogo,\r\n    PjExplorerLogo,\r\n    PjPropertyLogo,\r\n    ObjBrowserLogo,\r\n    ToolBoxLogo,\r\n    UserFormLogo,\r\n    CodeLogo,\r\n    ObjectLogo,\r\n    HelpLogo,\r\n    FDSVGImage\r\n  }\r\n})\r\nexport default class Header extends FDCommonMethod {\r\n  displaySubMenu: boolean = false;\r\n  @Action('fd/addUserform') addControl!: (payload: IaddUserform) => void;\r\n  @Action('fd/changeRunMode') changeRunMode!: (payload: boolean) => void;\r\n\r\n  @State((state) => state.fd.selectedControls)\r\n  selectedControls!: fdState['selectedControls'];\r\n  @State((state) => state.fd.userformData) userformData!: userformData;\r\n  @State((state) => state.fd.isRunMode) isRunMode!: boolean;\r\n  @Action('fd/updateControlExtraData') updateControlExtraData!: (\r\n    payload: IupdateControlExtraData\r\n  ) => void;\r\n  propControlData = {};\r\n  userFormId = 'ID_USERFORM1';\r\n  gridSize: number = 9\r\n  insertUserForm () {\r\n    this.propControlData = this.userformData\r\n    const userform = new ControlPropertyData()\r\n    const userFormId = `ID_USERFORM${\r\n      Object.keys(this.userformData).length + 1\r\n    }`\r\n    const Name = `UserForm${Object.keys(this.userformData).length + 1}`\r\n    const Caption = `UserForm${Object.keys(this.userformData).length + 1}`\r\n    const ID = Object.keys(this.userformData).length + 1\r\n    this.addControl({\r\n      target: this,\r\n      key: userFormId,\r\n      value: {\r\n        properties: {\r\n          ...userform.data.UserForm,\r\n          Name: Name,\r\n          ID: ID,\r\n          Caption: Caption\r\n        },\r\n        controls: [],\r\n        extraDatas: { display: 'none' },\r\n        type: 'Userform'\r\n      }\r\n    })\r\n  }\r\n  subMenuDisplay () {\r\n    this.displaySubMenu = !this.displaySubMenu\r\n  }\r\n  clickChangeMode () {\r\n    this.changeRunMode(!this.isRunMode)\r\n  }\r\n  makeEqual (type: keyof controlProperties) {\r\n    const usrFrmData = this.userformData[this.userFormId]\r\n    const ctrlSel = this.selectedControls[this.userFormId].selected\r\n    const ctrlContainer = this.selectedControls[this.userFormId].container[0]\r\n    const controls = usrFrmData[ctrlContainer].controls\r\n    let divstyle: Array<IGroupStyle> = []\r\n    let getGroupIndex = -1\r\n    EventBus.$emit('getGroupSize', (divstayleArray: Array<IGroupStyle>) => {\r\n      divstyle = divstayleArray\r\n    })\r\n    if (ctrlSel[0].startsWith('group')) {\r\n      getGroupIndex = divstyle.findIndex((val) => val.groupName === ctrlSel[0])\r\n    }\r\n    let propValue = 0\r\n    const leftArray: string[] = []\r\n    const rightArray: string[] = []\r\n    for (let index = 1; index < ctrlSel.length; index++) {\r\n      const selLeft = ctrlSel[0].startsWith('group')\r\n        ? parseInt(divstyle[getGroupIndex].left!)\r\n        : usrFrmData[ctrlSel[0]].properties.Left\r\n      const selTop = ctrlSel[0].startsWith('group')\r\n        ? parseInt(divstyle[getGroupIndex].top!)\r\n        : usrFrmData[ctrlSel[0]].properties.Top\r\n      if (!ctrlSel[index].startsWith('group')) {\r\n        const ctrlProp = usrFrmData[ctrlSel[index]].properties\r\n        if (type === 'Left') {\r\n          if (ctrlProp.Left! <= selLeft!) {\r\n            leftArray.push(ctrlSel[index])\r\n          } else {\r\n            rightArray.push(ctrlSel[index])\r\n          }\r\n        } else if (type === 'Top') {\r\n          if (ctrlProp.Top! <= selTop!) {\r\n            leftArray.push(ctrlSel[index])\r\n          } else {\r\n            rightArray.push(ctrlSel[index])\r\n          }\r\n        }\r\n      } else {\r\n        EventBus.$emit('getGroupSize', (divstayleArray: Array<IGroupStyle>) => {\r\n          divstyle = divstayleArray\r\n        })\r\n        const getIndex = divstyle.findIndex(\r\n          (val) => val.groupName === ctrlSel[index]\r\n        )\r\n        const groupLeft = parseInt(divstyle[getIndex].left!)\r\n        const groupTop = parseInt(divstyle[getIndex].top!)\r\n        const groupConrol = this.getGroupControl(ctrlSel[index])\r\n        if (type === 'Left') {\r\n          if (groupLeft <= selLeft!) {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Left!) === groupLeft) {\r\n                leftArray.push(ctrl)\r\n              }\r\n            }\r\n          } else {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Left!) === groupLeft) {\r\n                rightArray.push(ctrl)\r\n              }\r\n            }\r\n          }\r\n        } else if (type === 'Top') {\r\n          if (groupTop <= selTop!) {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Top!) === groupTop) {\r\n                leftArray.push(ctrl)\r\n              }\r\n            }\r\n          } else {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Top!) === groupTop) {\r\n                rightArray.push(ctrl)\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (ctrlSel[0].startsWith('group')) {\r\n      const getIndex = divstyle.findIndex(\r\n        (val) => val.groupName === ctrlSel[0]\r\n      )\r\n      const groupLeft = parseInt(divstyle[getIndex].left!)\r\n      const groupTop = parseInt(divstyle[getIndex].top!)\r\n      const groupConrol = this.getGroupControl(ctrlSel[0])\r\n      if (type === 'Left') {\r\n        for (let ctrl of groupConrol) {\r\n          const prop = this.userformData[this.userFormId][ctrl].properties\r\n          if (Math.floor(prop.Left!) === groupLeft) {\r\n            leftArray.push(ctrl)\r\n            rightArray.push(ctrl)\r\n          }\r\n        }\r\n      } else if (type === 'Top') {\r\n        for (let ctrl of groupConrol) {\r\n          const prop = this.userformData[this.userFormId][ctrl].properties\r\n          if (Math.floor(prop.Top!) === groupTop) {\r\n            leftArray.push(ctrl)\r\n            rightArray.push(ctrl)\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      leftArray.unshift(ctrlSel[0])\r\n      rightArray.push(ctrlSel[0])\r\n    }\r\n    if (type === 'Left') {\r\n      leftArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Left! - usrFrmData[b].properties.Left!\r\n      })\r\n      rightArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Left! - usrFrmData[b].properties.Left!\r\n      })\r\n    } else if (type === 'Top') {\r\n      leftArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Top! - usrFrmData[b].properties.Top!\r\n      })\r\n      rightArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Top! - usrFrmData[b].properties.Top!\r\n      })\r\n    }\r\n    let leftControl = { ...usrFrmData[leftArray[0]].properties }\r\n    if (leftControl.GroupID !== '') {\r\n      const groupIndex = divstyle.findIndex(\r\n        (val) => val.groupName === leftControl.GroupID\r\n      )\r\n      const groupSize = divstyle[groupIndex]\r\n      leftControl = {\r\n        ...leftControl,\r\n        Width: parseInt(divstyle[groupIndex].width!),\r\n        Height: parseInt(divstyle[groupIndex].height!),\r\n        Left: parseInt(divstyle[groupIndex].left!),\r\n        Top: parseInt(divstyle[groupIndex].top!)\r\n      }\r\n    }\r\n    let rightControl = {\r\n      ...usrFrmData[rightArray[rightArray.length - 1]].properties\r\n    }\r\n    if (rightControl.GroupID !== '') {\r\n      const groupIndex = divstyle.findIndex(\r\n        (val) => val.groupName === rightControl.GroupID\r\n      )\r\n      const groupSize = divstyle[groupIndex]\r\n      rightControl = {\r\n        ...leftControl,\r\n        Width: parseInt(divstyle[groupIndex].width!),\r\n        Height: parseInt(divstyle[groupIndex].height!),\r\n        Left: parseInt(divstyle[groupIndex].left!),\r\n        Top: parseInt(divstyle[groupIndex].top!)\r\n      }\r\n    }\r\n    let totalSize = 0\r\n    for (let index = 0; index < ctrlSel.length; index++) {\r\n      if (type === 'Left') {\r\n        if (!ctrlSel[index].startsWith('group')) {\r\n          const ctrlProp = usrFrmData[ctrlSel[index]].properties\r\n          totalSize = totalSize + ctrlProp.Width!\r\n        } else {\r\n          const groupIndex = divstyle.findIndex(\r\n            (val) => val.groupName === ctrlSel[index]\r\n          )\r\n          totalSize = totalSize + parseInt(divstyle[groupIndex].width!)\r\n        }\r\n      } else if (type === 'Top') {\r\n        if (!ctrlSel[index].startsWith('group')) {\r\n          const ctrlProp = usrFrmData[ctrlSel[index]].properties\r\n          totalSize = totalSize + ctrlProp.Height!\r\n        } else {\r\n          const groupIndex = divstyle.findIndex(\r\n            (val) => val.groupName === ctrlSel[index]\r\n          )\r\n          totalSize = totalSize + parseInt(divstyle[groupIndex].height!)\r\n        }\r\n      }\r\n    }\r\n    let diffrence = 0\r\n    if (type === 'Left') {\r\n      diffrence =\r\n        (rightControl.Left! +\r\n          rightControl.Width! -\r\n          leftControl.Left! -\r\n          totalSize) /\r\n        (ctrlSel.length - 1)\r\n    } else if (type === 'Top') {\r\n      diffrence =\r\n        (rightControl.Top! +\r\n          rightControl.Height! -\r\n          leftControl.Top! -\r\n          totalSize) /\r\n        (ctrlSel.length - 1)\r\n    }\r\n    const unique = () => {\r\n      var a = leftArray.concat(rightArray)\r\n      for (var i = 0; i < a.length; ++i) {\r\n        for (var j = i + 1; j < a.length; ++j) {\r\n          if (a[i] === a[j]) {\r\n            a.splice(j--, 1)\r\n          }\r\n        }\r\n      }\r\n      return a\r\n    }\r\n    const combineArray = unique()\r\n    for (let index = 1; index < combineArray.length - 1; index++) {\r\n      const prevCtrlProp = usrFrmData[combineArray[index - 1]].properties\r\n      const ctrlProp = usrFrmData[combineArray[index]].properties\r\n      let prevIndex = -1\r\n      const controlPropIndex = -1\r\n      if (type === 'Left') {\r\n        if (prevCtrlProp.GroupID === '' && ctrlProp.GroupID === '') {\r\n          propValue = prevCtrlProp.Left! + prevCtrlProp.Width! + diffrence\r\n          this.updateControlProperty(type, propValue, combineArray[index])\r\n        } else {\r\n          if (prevCtrlProp.GroupID !== '') {\r\n            prevIndex = divstyle.findIndex(\r\n              (val) => val.groupName === prevCtrlProp.GroupID\r\n            )\r\n            propValue =\r\n              parseInt(divstyle[prevIndex].left!) +\r\n              parseInt(divstyle[prevIndex].width!) +\r\n              diffrence\r\n          } else {\r\n            propValue = prevCtrlProp.Left! + prevCtrlProp.Width! + diffrence\r\n          }\r\n          if (ctrlProp.GroupID !== '') {\r\n            const getIndex = divstyle.findIndex(\r\n              (val) => val.groupName === ctrlProp.GroupID\r\n            )\r\n            EventBus.$emit('updasteGroupSize', type, propValue, getIndex)\r\n          } else {\r\n            this.updateControlProperty(type, propValue, combineArray[index])\r\n          }\r\n        }\r\n      } else {\r\n        if (type === 'Top') {\r\n          if (prevCtrlProp.GroupID === '' && ctrlProp.GroupID === '') {\r\n            propValue = prevCtrlProp.Top! + prevCtrlProp.Height! + diffrence\r\n            this.updateControlProperty(type, propValue, combineArray[index])\r\n          } else {\r\n            if (prevCtrlProp.GroupID !== '') {\r\n              prevIndex = divstyle.findIndex(\r\n                (val) => val.groupName === prevCtrlProp.GroupID\r\n              )\r\n              propValue =\r\n                parseInt(divstyle[prevIndex].top!) +\r\n                parseInt(divstyle[prevIndex].height!) +\r\n                diffrence\r\n            } else {\r\n              propValue = prevCtrlProp.Top! + prevCtrlProp.Height! + diffrence\r\n            }\r\n            if (ctrlProp.GroupID !== '') {\r\n              const getIndex = divstyle.findIndex(\r\n                (val) => val.groupName === ctrlProp.GroupID\r\n              )\r\n              EventBus.$emit('updasteGroupSize', type, propValue, getIndex)\r\n            } else {\r\n              this.updateControlProperty(type, propValue, combineArray[index])\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  bringFront () {\r\n    const userData = this.userformData[this.userFormId]\r\n    const highProrControl: string[] = []\r\n    const lowProrControl: string[] = []\r\n    const container = this.getContainerList(this.getSelectedControlsDatas![0])[0]\r\n    const containerControls = this.userformData[this.userFormId][container].controls\r\n    for (const index in containerControls) {\r\n      const cntrlData = this.userformData[this.userFormId][containerControls[index]]\r\n      if (cntrlData.type === 'MultiPage' || cntrlData.type === 'Frame' || cntrlData.type === 'ListBox') {\r\n        highProrControl.push(containerControls[index])\r\n      } else {\r\n        lowProrControl.push(containerControls[index])\r\n      }\r\n    }\r\n    lowProrControl.sort((a, b) => {\r\n      return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n    })\r\n    let getLowPropHighestIndex: string = lowProrControl[lowProrControl.length - 1]\r\n    highProrControl.sort((a, b) => {\r\n      return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n    })\r\n    let getHighPropHighestIndex = highProrControl[highProrControl.length - 1]\r\n    const lowSeriesControl: string[] = []\r\n    const highSeriesControl: string[] = []\r\n    const getSelControl = [...this.getSelectedControlsDatas!]\r\n    getSelControl.sort((a, b) => {\r\n      return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n    })\r\n    for (const selControl of getSelControl) {\r\n      if (lowProrControl.includes(selControl)) {\r\n        lowSeriesControl.push(selControl)\r\n      } else {\r\n        highSeriesControl.push(selControl)\r\n      }\r\n    }\r\n    const setLowPropHighIndex = (control: string) => {\r\n      if (lowSeriesControl.length > 0 && lowSeriesControl.includes(control)) {\r\n        lowSeriesControl.pop()\r\n        const Index = lowProrControl.findIndex(val => userData[getLowPropHighestIndex!].extraDatas!.zIndex! - 1 === userData[val].extraDatas!.zIndex)\r\n        getLowPropHighestIndex = Index !== -1 ? lowProrControl[Index] : ''\r\n        if (Index !== -1) {\r\n          setLowPropHighIndex(getLowPropHighestIndex)\r\n        }\r\n      }\r\n    }\r\n    setLowPropHighIndex(getLowPropHighestIndex)\r\n    lowSeriesControl.sort((a, b) => {\r\n      return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n    })\r\n    if (lowSeriesControl.length > 0) {\r\n      const lowestZIndex = userData[lowSeriesControl[0]].extraDatas!.zIndex!\r\n      let nextSeries: string[] = []\r\n      let count = lowSeriesControl.length - 1\r\n      const diff = userData[getLowPropHighestIndex].extraDatas!.zIndex! - userData[lowSeriesControl[lowSeriesControl.length - 1]].extraDatas!.zIndex!\r\n      for (const ctrl of lowSeriesControl) {\r\n        const nextControl = lowSeriesControl.findIndex(val => 'zIndex' in userData[val].extraDatas! && (userData[ctrl].extraDatas!.zIndex! + 1 === userData[val].extraDatas!.zIndex!))\r\n        if (nextControl !== -1) {\r\n          nextSeries.push(ctrl)\r\n          count = count - 1\r\n        } else {\r\n          const difference = userData[getLowPropHighestIndex].extraDatas!.zIndex! - count\r\n          this.updateExtraDatas(ctrl, 'zIndex', difference)\r\n          if (nextSeries.length > 0) {\r\n            for (let i = 0; i < nextSeries.length; i++) {\r\n              const diff = userData[ctrl].extraDatas!.zIndex! - (nextSeries.length - i)\r\n              this.updateExtraDatas(nextSeries[i], 'zIndex', diff)\r\n            }\r\n            nextSeries = []\r\n          }\r\n          count = count - 1\r\n        }\r\n      }\r\n      let counter = 0\r\n      for (const ctrl of lowProrControl) {\r\n        if (!this.getSelectedControlsDatas!.includes(ctrl)) {\r\n          counter = counter + 1\r\n          this.updateExtraDatas(ctrl, 'zIndex', counter)\r\n        }\r\n      }\r\n    }\r\n\r\n    const setHighPropHighIndex = (control: string) => {\r\n      if (highSeriesControl.length > 0 && highSeriesControl.includes(control)) {\r\n        highSeriesControl.pop()\r\n        const Index = highProrControl.findIndex(val => userData[getHighPropHighestIndex!].extraDatas!.zIndex! - 1 === userData[val].extraDatas!.zIndex)\r\n        getHighPropHighestIndex = Index !== -1 ? highProrControl[Index] : ''\r\n        if (Index !== -1) {\r\n          setHighPropHighIndex(getHighPropHighestIndex)\r\n        }\r\n      }\r\n    }\r\n    setHighPropHighIndex(getHighPropHighestIndex)\r\n    highSeriesControl.sort((a, b) => {\r\n      return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n    })\r\n    if (highSeriesControl.length > 0) {\r\n      const highestZIndex = userData[highSeriesControl[0]].extraDatas!.zIndex!\r\n      let nextSeries: string[] = []\r\n      let count = highSeriesControl.length - 1\r\n      const diff = userData[getHighPropHighestIndex].extraDatas!.zIndex! - userData[highSeriesControl[highSeriesControl.length - 1]].extraDatas!.zIndex!\r\n      for (const ctrl of highSeriesControl) {\r\n        const nextControl = highSeriesControl.findIndex(val => 'zIndex' in userData[val].extraDatas! && (userData[ctrl].extraDatas!.zIndex! + 1 === userData[val].extraDatas!.zIndex!))\r\n        if (nextControl !== -1) {\r\n          nextSeries.push(ctrl)\r\n          count = count - 1\r\n        } else {\r\n          const difference = userData[getHighPropHighestIndex].extraDatas!.zIndex! - count\r\n          this.updateExtraDatas(ctrl, 'zIndex', difference)\r\n          if (nextSeries.length > 0) {\r\n            for (let i = 0; i < nextSeries.length; i++) {\r\n              const diff = userData[ctrl].extraDatas!.zIndex! - (nextSeries.length - i)\r\n              this.updateExtraDatas(nextSeries[i], 'zIndex', diff)\r\n            }\r\n            nextSeries = []\r\n          }\r\n          count = count - 1\r\n        }\r\n      }\r\n      let counter = 0\r\n      for (const ctrl of highProrControl) {\r\n        if (!this.getSelectedControlsDatas!.includes(ctrl)) {\r\n          counter = counter + 1\r\n          this.updateExtraDatas(ctrl, 'zIndex', counter)\r\n        }\r\n      }\r\n    }\r\n  }\r\n  sendBack () {\r\n    const userData = this.userformData[this.userFormId]\r\n    const highProrControl: string[] = []\r\n    const lowProrControl: string[] = []\r\n    const container = this.getContainerList(this.getSelectedControlsDatas![0])[0]\r\n    const containerControls = this.userformData[this.userFormId][container].controls\r\n    for (const index in containerControls) {\r\n      const cntrlData = this.userformData[this.userFormId][containerControls[index]]\r\n      if (cntrlData.type === 'MultiPage' || cntrlData.type === 'Frame' || cntrlData.type === 'ListBox') {\r\n        highProrControl.push(containerControls[index])\r\n      } else {\r\n        lowProrControl.push(containerControls[index])\r\n      }\r\n    }\r\n    lowProrControl.sort((a, b) => {\r\n      return userData[b].extraDatas!.zIndex! - userData[a].extraDatas!.zIndex!\r\n    })\r\n    let getLowPropHighestIndex: string = lowProrControl[lowProrControl.length - 1]\r\n    highProrControl.sort((a, b) => {\r\n      return userData[b].extraDatas!.zIndex! - userData[a].extraDatas!.zIndex!\r\n    })\r\n    let getHighPropHighestIndex = highProrControl[highProrControl.length - 1]\r\n    const lowSeriesControl: string[] = []\r\n    const highSeriesControl: string[] = []\r\n    const getSelControl = [...this.getSelectedControlsDatas!]\r\n    getSelControl.sort((a, b) => {\r\n      return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n    })\r\n    for (const selControl of getSelControl) {\r\n      if (lowProrControl.includes(selControl)) {\r\n        lowSeriesControl.push(selControl)\r\n      } else {\r\n        highSeriesControl.push(selControl)\r\n      }\r\n    }\r\n    const setLowPropHighIndex = (control: string) => {\r\n      if (lowSeriesControl.length > 0 && lowSeriesControl.includes(control)) {\r\n        lowSeriesControl.pop()\r\n        const Index = lowProrControl.findIndex(val => userData[getLowPropHighestIndex!].extraDatas!.zIndex! + 1 === userData[val].extraDatas!.zIndex)\r\n        getLowPropHighestIndex = Index !== -1 ? lowProrControl[Index] : ''\r\n        if (Index !== -1) {\r\n          setLowPropHighIndex(getLowPropHighestIndex)\r\n        }\r\n      }\r\n    }\r\n    setLowPropHighIndex(getLowPropHighestIndex)\r\n    if (lowSeriesControl.length > 0) {\r\n      lowSeriesControl.sort((a, b) => {\r\n        return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n      })\r\n      let count = userData[getLowPropHighestIndex].extraDatas!.zIndex!\r\n      for (const ctrl of lowSeriesControl) {\r\n        this.updateExtraDatas(ctrl, 'zIndex', count)\r\n        count = count + 1\r\n      }\r\n      let counter = userData[lowSeriesControl[lowSeriesControl.length - 1]].extraDatas!.zIndex!\r\n      for (let i = lowProrControl.length - 1; i >= 0; i--) {\r\n        if (!this.getSelectedControlsDatas!.includes(lowProrControl[i])) {\r\n          counter = counter + 1\r\n          this.updateExtraDatas(lowProrControl[i], 'zIndex', counter)\r\n        }\r\n      }\r\n    }\r\n\r\n    const setHighPropHighIndex = (control: string) => {\r\n      if (highSeriesControl.length > 0 && highSeriesControl.includes(control)) {\r\n        highSeriesControl.shift()\r\n        const Index = highProrControl.findIndex(val => userData[getHighPropHighestIndex!].extraDatas!.zIndex! + 1 === userData[val].extraDatas!.zIndex)\r\n        getHighPropHighestIndex = Index !== -1 ? highProrControl[Index] : ''\r\n        if (Index !== -1) {\r\n          setHighPropHighIndex(getHighPropHighestIndex)\r\n        }\r\n      }\r\n    }\r\n    setHighPropHighIndex(getHighPropHighestIndex)\r\n    if (highSeriesControl.length > 0) {\r\n      highSeriesControl.sort((a, b) => {\r\n        return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n      })\r\n      let count = userData[getHighPropHighestIndex].extraDatas!.zIndex!\r\n      for (const ctrl of highSeriesControl) {\r\n        this.updateExtraDatas(ctrl, 'zIndex', count)\r\n        count = count + 1\r\n      }\r\n      let counter = userData[highSeriesControl[highSeriesControl.length - 1]].extraDatas!.zIndex!\r\n      for (let i = highProrControl.length - 1; i >= 0; i--) {\r\n        if (!this.getSelectedControlsDatas!.includes(highProrControl[i])) {\r\n          counter = counter + 1\r\n          this.updateExtraDatas(highProrControl[i], 'zIndex', counter)\r\n        }\r\n      }\r\n    }\r\n  }\r\n  groupControl () {\r\n    EventBus.$emit('groupControl', 'group')\r\n  }\r\n  unGroupControl () {\r\n    EventBus.$emit('groupControl', 'ungroup')\r\n  }\r\n  sizeToFit () {\r\n    const usrFrmData = this.userformData[this.userFormId]\r\n    const ctrlSel = this.selectedControls[this.userFormId].selected\r\n    const sizeToFitArr: string[] = []\r\n    const sizeToFitVal: boolean[] = []\r\n    for (let index = 0; index < ctrlSel.length; index++) {\r\n      if (!ctrlSel[index].startsWith('group')) {\r\n        const controlprop = usrFrmData[ctrlSel[index]].properties\r\n        if ('AutoSize' in controlprop) {\r\n          sizeToFitArr.push(ctrlSel[index])\r\n          sizeToFitVal.push(controlprop.AutoSize!)\r\n          this.updateControlProperty('AutoSize', true, ctrlSel[index])\r\n        }\r\n      }\r\n    }\r\n    setTimeout(() => {\r\n      for (let index = 0; index < sizeToFitArr.length; index++) {\r\n        if (!sizeToFitArr[index].startsWith('group')) {\r\n          const controlprop = usrFrmData[sizeToFitArr[index]].properties\r\n          if ('AutoSize' in controlprop) {\r\n            this.updateControlProperty(\r\n              'AutoSize',\r\n              sizeToFitVal[index],\r\n              sizeToFitArr[index]\r\n            )\r\n          }\r\n        }\r\n      }\r\n    }, 100)\r\n  }\r\n  convertToGridSize (val: number) {\r\n    const gridSize = 9\r\n    return Math.round(val / gridSize) * gridSize\r\n  }\r\n  sizeToGrid () {\r\n    let divstyle: Array<IGroupStyle> = []\r\n    const usrFrmData = this.userformData[this.userFormId]\r\n    const ctrlSel = this.selectedControls[this.userFormId].selected\r\n    let ctrlContainer = this.selectedControls[this.userFormId].container[0]\r\n    for (let index = 0; index < ctrlSel.length; index++) {\r\n      if (!ctrlSel[index].startsWith('group')) {\r\n        const controlprop = usrFrmData[ctrlSel[index]].properties\r\n        this.updateControlProperty(\r\n          'Left',\r\n          this.convertToGridSize(controlprop.Left!),\r\n          ctrlSel[index]\r\n        )\r\n        this.updateControlProperty(\r\n          'Top',\r\n          this.convertToGridSize(controlprop.Top!),\r\n          ctrlSel[index]\r\n        )\r\n        this.updateControlProperty(\r\n          'Width',\r\n          this.convertToGridSize(controlprop.Width!),\r\n          ctrlSel[index]\r\n        )\r\n        this.updateControlProperty(\r\n          'Height',\r\n          this.convertToGridSize(controlprop.Height!),\r\n          ctrlSel[index]\r\n        )\r\n      } else {\r\n        EventBus.$emit('getGroupSize', (divstayleArray: Array<IGroupStyle>) => {\r\n          divstyle = divstayleArray\r\n        })\r\n        const getIndex = divstyle.findIndex(\r\n          (val) => val.groupName === ctrlSel[index]\r\n        )\r\n        EventBus.$emit('updasteGroupSize', 'GroupID', 0, getIndex)\r\n      }\r\n    }\r\n  }\r\n  incDecspacing (type: keyof controlProperties, value: number) {\r\n    const usrFrmData = this.userformData[this.userFormId]\r\n    const ctrlSel = this.selectedControls[this.userFormId].selected\r\n    const ctrlContainer = this.selectedControls[this.userFormId].container[0]\r\n    const controls = usrFrmData[ctrlContainer].controls\r\n    let divstyle: Array<IGroupStyle> = []\r\n    let getGroupIndex = -1\r\n    if (ctrlSel[0].startsWith('group')) {\r\n      EventBus.$emit('getGroupSize', (divstayleArray: Array<IGroupStyle>) => {\r\n        divstyle = divstayleArray\r\n      })\r\n      getGroupIndex = divstyle.findIndex((val) => val.groupName === ctrlSel[0])\r\n    }\r\n    const leftArray: string[] = []\r\n    const rightArray: string[] = []\r\n    for (let index = 1; index < ctrlSel.length; index++) {\r\n      const selLeft = ctrlSel[0].startsWith('group')\r\n        ? parseInt(divstyle[getGroupIndex].left!)\r\n        : usrFrmData[ctrlSel[0]].properties.Left\r\n      const selTop = ctrlSel[0].startsWith('group')\r\n        ? parseInt(divstyle[getGroupIndex].top!)\r\n        : usrFrmData[ctrlSel[0]].properties.Top\r\n      if (!ctrlSel[index].startsWith('group')) {\r\n        const ctrlProp = usrFrmData[ctrlSel[index]].properties\r\n        if (type === 'Left') {\r\n          if (ctrlProp.Left! <= selLeft!) {\r\n            leftArray.push(ctrlSel[index])\r\n          } else {\r\n            rightArray.push(ctrlSel[index])\r\n          }\r\n        } else if (type === 'Top') {\r\n          if (ctrlProp.Top! <= selTop!) {\r\n            leftArray.push(ctrlSel[index])\r\n          } else {\r\n            rightArray.push(ctrlSel[index])\r\n          }\r\n        }\r\n      } else {\r\n        EventBus.$emit('getGroupSize', (divstayleArray: Array<IGroupStyle>) => {\r\n          divstyle = divstayleArray\r\n        })\r\n        const getIndex = divstyle.findIndex(\r\n          (val) => val.groupName === ctrlSel[index]\r\n        )\r\n        const groupLeft = parseInt(divstyle[getIndex].left!)\r\n        const groupTop = parseInt(divstyle[getIndex].top!)\r\n        const groupConrol = this.getGroupControl(ctrlSel[index])\r\n        if (type === 'Left') {\r\n          if (groupLeft <= selLeft!) {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Left!) === groupLeft) {\r\n                leftArray.push(ctrl)\r\n              }\r\n            }\r\n          } else {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Left!) === groupLeft) {\r\n                rightArray.push(ctrl)\r\n              }\r\n            }\r\n          }\r\n        } else if (type === 'Top') {\r\n          if (groupTop <= selTop!) {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Top!) === groupTop) {\r\n                leftArray.push(ctrl)\r\n              }\r\n            }\r\n          } else {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Top!) === groupTop) {\r\n                rightArray.push(ctrl)\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (ctrlSel[0].startsWith('group')) {\r\n      const getIndex = divstyle.findIndex(\r\n        (val) => val.groupName === ctrlSel[0]\r\n      )\r\n      const groupLeft = parseInt(divstyle[getIndex].left!)\r\n      const groupTop = parseInt(divstyle[getIndex].top!)\r\n      const groupConrol = this.getGroupControl(ctrlSel[0])\r\n      if (type === 'Left') {\r\n        for (let ctrl of groupConrol) {\r\n          const prop = this.userformData[this.userFormId][ctrl].properties\r\n          if (Math.floor(prop.Left!) === groupLeft) {\r\n            leftArray.push(ctrl)\r\n            rightArray.push(ctrl)\r\n          }\r\n        }\r\n      } else if (type === 'Top') {\r\n        for (let ctrl of groupConrol) {\r\n          const prop = this.userformData[this.userFormId][ctrl].properties\r\n          if (Math.floor(prop.Top!) === groupTop) {\r\n            leftArray.push(ctrl)\r\n            rightArray.push(ctrl)\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      leftArray.unshift(ctrlSel[0])\r\n      rightArray.push(ctrlSel[0])\r\n    }\r\n    if (type === 'Left') {\r\n      leftArray.sort((a, b) => {\r\n        return usrFrmData[b].properties.Left! - usrFrmData[a].properties.Left!\r\n      })\r\n      rightArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Left! - usrFrmData[b].properties.Left!\r\n      })\r\n    } else if (type === 'Top') {\r\n      leftArray.sort((a, b) => {\r\n        return usrFrmData[b].properties.Top! - usrFrmData[a].properties.Top!\r\n      })\r\n      rightArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Top! - usrFrmData[b].properties.Top!\r\n      })\r\n    }\r\n    const groupIndex: number = divstyle.findIndex(\r\n      (val) => val.groupName === ctrlSel[0]\r\n    )\r\n    const isGroup = ctrlSel[0].startsWith('group')\r\n    const ctrlProp = !isGroup && usrFrmData[ctrlSel[0]].properties\r\n    const newObject = {\r\n      Left:\r\n        isGroup && groupIndex !== -1\r\n          ? parseInt(divstyle[groupIndex].left!)\r\n          : ctrlProp\r\n            ? ctrlProp.Left!\r\n            : 0,\r\n      Top:\r\n        isGroup && groupIndex !== -1\r\n          ? parseInt(divstyle[groupIndex].top!)\r\n          : ctrlProp\r\n            ? ctrlProp.Top!\r\n            : 0,\r\n      Width:\r\n        isGroup && groupIndex !== -1\r\n          ? parseInt(divstyle[groupIndex].width!)\r\n          : ctrlProp\r\n            ? ctrlProp.Width!\r\n            : 0,\r\n      Height:\r\n        isGroup && groupIndex !== -1\r\n          ? parseInt(divstyle[groupIndex].height!)\r\n          : ctrlProp\r\n            ? ctrlProp.Height!\r\n            : 0\r\n    }\r\n    let incDecValue = 0\r\n    let propValue = 0\r\n    for (let index = 1; index < leftArray.length; index++) {\r\n      const ctrlProp = usrFrmData[leftArray[index]].properties\r\n      let prevIndex = -1\r\n      let controlPropIndex = -1\r\n      if (type === 'Left') {\r\n        if (ctrlProp.GroupID === '') {\r\n          propValue = propValue + value\r\n          incDecValue = ctrlProp.Left! - propValue\r\n          this.updateControlProperty(type, this.convertToGridSize(incDecValue), leftArray[index])\r\n        } else {\r\n          if (ctrlProp.GroupID !== '') {\r\n            controlPropIndex = divstyle.findIndex((val) => val.groupName === ctrlProp.GroupID)\r\n            let incDecValue = 0\r\n            propValue = propValue + value\r\n            incDecValue = parseInt(divstyle[controlPropIndex].left!) - propValue\r\n            EventBus.$emit(\r\n              'updasteGroupSize',\r\n              type,\r\n              this.convertToGridSize(incDecValue),\r\n              controlPropIndex\r\n            )\r\n          }\r\n        }\r\n      } else if (type === 'Top') {\r\n        if (ctrlProp.GroupID === '') {\r\n          propValue = propValue + value\r\n          incDecValue = ctrlProp.Top! - propValue\r\n          this.updateControlProperty(type, this.convertToGridSize(incDecValue), leftArray[index])\r\n        } else {\r\n          if (ctrlProp.GroupID !== '') {\r\n            controlPropIndex = divstyle.findIndex((val) => val.groupName === ctrlProp.GroupID)\r\n            let incDecValue = 0\r\n            propValue = propValue + value\r\n            incDecValue = parseInt(divstyle[controlPropIndex].top!) - propValue\r\n            EventBus.$emit(\r\n              'updasteGroupSize',\r\n              type,\r\n              this.convertToGridSize(incDecValue),\r\n              controlPropIndex\r\n            )\r\n          }\r\n        }\r\n      }\r\n    }\r\n    propValue = 0\r\n    for (let index = 1; index < rightArray.length; index++) {\r\n      const ctrlProp = usrFrmData[rightArray[index]].properties\r\n      let prevIndex = -1\r\n      let controlPropIndex = -1\r\n      if (type === 'Left') {\r\n        if (ctrlProp.GroupID === '') {\r\n          propValue = propValue + value\r\n          incDecValue = ctrlProp.Left! + propValue\r\n          this.updateControlProperty(type, this.convertToGridSize(incDecValue), rightArray[index])\r\n        } else {\r\n          if (ctrlProp.GroupID !== '') {\r\n            controlPropIndex = divstyle.findIndex((val) => val.groupName === ctrlProp.GroupID)\r\n            propValue = propValue + value\r\n            incDecValue = parseInt(divstyle[controlPropIndex].left!) + propValue\r\n            EventBus.$emit(\r\n              'updasteGroupSize',\r\n              type,\r\n              this.convertToGridSize(incDecValue),\r\n              controlPropIndex\r\n            )\r\n          }\r\n        }\r\n      } else if (type === 'Top') {\r\n        if (ctrlProp.GroupID === '') {\r\n          let incDecValue = 0\r\n          propValue = propValue + value\r\n          incDecValue = ctrlProp.Top! + propValue\r\n          this.updateControlProperty(type, this.convertToGridSize(incDecValue), rightArray[index])\r\n        } else {\r\n          if (ctrlProp.GroupID !== '') {\r\n            controlPropIndex = divstyle.findIndex((val) => val.groupName === ctrlProp.GroupID)\r\n            let incDecValue = 0\r\n            propValue = propValue + value\r\n            incDecValue = parseInt(divstyle[controlPropIndex].top!) + propValue\r\n            EventBus.$emit(\r\n              'updasteGroupSize',\r\n              type,\r\n              this.convertToGridSize(incDecValue),\r\n              controlPropIndex\r\n            )\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  getGroupControl (groupName: string) {\r\n    const ctrlContainer = this.selectedControls[this.userFormId].container[0]\r\n    const usrFrmData = this.userformData[this.userFormId]\r\n    const controls = []\r\n    for (const control of usrFrmData[ctrlContainer].controls) {\r\n      if (usrFrmData[control].properties.GroupID === groupName) {\r\n        controls.push(control)\r\n      }\r\n    }\r\n    return controls\r\n  }\r\n  removeSpace (type: keyof controlProperties) {\r\n    const usrFrmData = this.userformData[this.userFormId]\r\n    const ctrlSel = this.selectedControls[this.userFormId].selected\r\n    const ctrlContainer = this.selectedControls[this.userFormId].container[0]\r\n    const controls = usrFrmData[ctrlContainer].controls\r\n    let divstyle: Array<IGroupStyle> = []\r\n    let getGroupIndex = -1\r\n    if (ctrlSel[0].startsWith('group')) {\r\n      EventBus.$emit('getGroupSize', (divstayleArray: Array<IGroupStyle>) => {\r\n        divstyle = divstayleArray\r\n      })\r\n      getGroupIndex = divstyle.findIndex((val) => val.groupName === ctrlSel[0])\r\n    }\r\n    let propValue = 0\r\n    const leftArray: string[] = []\r\n    const rightArray: string[] = []\r\n    for (let index = 1; index < ctrlSel.length; index++) {\r\n      const selLeft = ctrlSel[0].startsWith('group')\r\n        ? parseInt(divstyle[getGroupIndex].left!)\r\n        : usrFrmData[ctrlSel[0]].properties.Left\r\n      const selTop = ctrlSel[0].startsWith('group')\r\n        ? parseInt(divstyle[getGroupIndex].top!)\r\n        : usrFrmData[ctrlSel[0]].properties.Top\r\n      if (!ctrlSel[index].startsWith('group')) {\r\n        const ctrlProp = usrFrmData[ctrlSel[index]].properties\r\n        if (type === 'Left') {\r\n          if (ctrlProp.Left! <= selLeft!) {\r\n            leftArray.push(ctrlSel[index])\r\n          } else {\r\n            rightArray.push(ctrlSel[index])\r\n          }\r\n        } else if (type === 'Top') {\r\n          if (ctrlProp.Top! <= selTop!) {\r\n            leftArray.push(ctrlSel[index])\r\n          } else {\r\n            rightArray.push(ctrlSel[index])\r\n          }\r\n        }\r\n      } else {\r\n        EventBus.$emit('getGroupSize', (divstayleArray: Array<IGroupStyle>) => {\r\n          divstyle = divstayleArray\r\n        })\r\n        const getIndex = divstyle.findIndex(\r\n          (val) => val.groupName === ctrlSel[index]\r\n        )\r\n        const groupLeft = parseInt(divstyle[getIndex].left!)\r\n        const groupTop = parseInt(divstyle[getIndex].top!)\r\n        const groupConrol = this.getGroupControl(ctrlSel[index])\r\n        if (type === 'Left') {\r\n          if (groupLeft <= selLeft!) {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Left!) === groupLeft) {\r\n                leftArray.push(ctrl)\r\n              }\r\n            }\r\n          } else {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Left!) === groupLeft) {\r\n                rightArray.push(ctrl)\r\n              }\r\n            }\r\n          }\r\n        } else if (type === 'Top') {\r\n          if (groupTop <= selTop!) {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Top!) === groupTop) {\r\n                leftArray.push(ctrl)\r\n              }\r\n            }\r\n          } else {\r\n            for (let ctrl of groupConrol) {\r\n              const prop = this.userformData[this.userFormId][ctrl].properties\r\n              if (Math.floor(prop.Top!) === groupTop) {\r\n                rightArray.push(ctrl)\r\n              }\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (ctrlSel[0].startsWith('group')) {\r\n      const getIndex = divstyle.findIndex(\r\n        (val) => val.groupName === ctrlSel[0]\r\n      )\r\n      const groupLeft = parseInt(divstyle[getIndex].left!)\r\n      const groupTop = parseInt(divstyle[getIndex].top!)\r\n      const groupConrol = this.getGroupControl(ctrlSel[0])\r\n      if (type === 'Left') {\r\n        for (let ctrl of groupConrol) {\r\n          const prop = this.userformData[this.userFormId][ctrl].properties\r\n          if (Math.floor(prop.Left!) === groupLeft) {\r\n            leftArray.push(ctrl)\r\n            rightArray.push(ctrl)\r\n          }\r\n        }\r\n      } else if (type === 'Top') {\r\n        for (let ctrl of groupConrol) {\r\n          const prop = this.userformData[this.userFormId][ctrl].properties\r\n          if (Math.floor(prop.Top!) === groupTop) {\r\n            leftArray.push(ctrl)\r\n            rightArray.push(ctrl)\r\n          }\r\n        }\r\n      }\r\n    } else {\r\n      leftArray.unshift(ctrlSel[0])\r\n      rightArray.push(ctrlSel[0])\r\n    }\r\n    if (type === 'Left') {\r\n      leftArray.sort((a, b) => {\r\n        return usrFrmData[b].properties.Left! - usrFrmData[a].properties.Left!\r\n      })\r\n      rightArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Left! - usrFrmData[b].properties.Left!\r\n      })\r\n    } else if (type === 'Top') {\r\n      leftArray.sort((a, b) => {\r\n        return usrFrmData[b].properties.Top! - usrFrmData[a].properties.Top!\r\n      })\r\n      rightArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Top! - usrFrmData[b].properties.Top!\r\n      })\r\n    }\r\n    for (let index = 1; index < leftArray.length; index++) {\r\n      const prevCtrlProp = usrFrmData[leftArray[index - 1]].properties\r\n      const ctrlProp = usrFrmData[leftArray[index]].properties\r\n      let prevIndex = -1\r\n      let controlPropIndex = -1\r\n      if (type === 'Left') {\r\n        if (prevCtrlProp.GroupID === '' && ctrlProp.GroupID === '') {\r\n          propValue = prevCtrlProp.Left! - ctrlProp.Width!\r\n          this.updateControlProperty(type, propValue, leftArray[index])\r\n        } else {\r\n          if (prevCtrlProp.GroupID !== '') {\r\n            if (ctrlProp.GroupID === '') {\r\n              prevIndex = divstyle.findIndex(\r\n                (val) => val.groupName === prevCtrlProp.GroupID\r\n              )\r\n              propValue = parseInt(divstyle[prevIndex].left!) - ctrlProp.Width!\r\n              this.updateControlProperty(type, propValue, leftArray[index])\r\n            }\r\n          }\r\n          if (ctrlProp.GroupID !== '') {\r\n            controlPropIndex = divstyle.findIndex(\r\n              (val) => val.groupName === ctrlProp.GroupID\r\n            )\r\n            if (prevCtrlProp.GroupID === '') {\r\n              propValue =\r\n                prevCtrlProp.Left! -\r\n                parseInt(divstyle[controlPropIndex].width!)\r\n            } else {\r\n              prevIndex = divstyle.findIndex(\r\n                (val) => val.groupName === prevCtrlProp.GroupID\r\n              )\r\n              propValue =\r\n                parseInt(divstyle[prevIndex].left!) -\r\n                parseInt(divstyle[controlPropIndex].width!)\r\n            }\r\n            EventBus.$emit(\r\n              'updasteGroupSize',\r\n              type,\r\n              propValue,\r\n              controlPropIndex\r\n            )\r\n          }\r\n        }\r\n      } else if (type === 'Top') {\r\n        if (prevCtrlProp.GroupID === '' && ctrlProp.GroupID === '') {\r\n          propValue = prevCtrlProp.Top! - ctrlProp.Height!\r\n          this.updateControlProperty(type, propValue, leftArray[index])\r\n        } else {\r\n          if (prevCtrlProp.GroupID !== '') {\r\n            if (ctrlProp.GroupID === '') {\r\n              prevIndex = divstyle.findIndex(\r\n                (val) => val.groupName === prevCtrlProp.GroupID\r\n              )\r\n              propValue = parseInt(divstyle[prevIndex].top!) - ctrlProp.Height!\r\n              this.updateControlProperty(type, propValue, leftArray[index])\r\n            }\r\n          }\r\n          if (ctrlProp.GroupID !== '') {\r\n            controlPropIndex = divstyle.findIndex(\r\n              (val) => val.groupName === ctrlProp.GroupID\r\n            )\r\n            if (prevCtrlProp.GroupID === '') {\r\n              propValue =\r\n                prevCtrlProp.Top! -\r\n                parseInt(divstyle[controlPropIndex].height!)\r\n            } else {\r\n              prevIndex = divstyle.findIndex(\r\n                (val) => val.groupName === prevCtrlProp.GroupID\r\n              )\r\n              propValue =\r\n                parseInt(divstyle[prevIndex].top!) -\r\n                parseInt(divstyle[controlPropIndex].height!)\r\n            }\r\n            EventBus.$emit(\r\n              'updasteGroupSize',\r\n              type,\r\n              propValue,\r\n              controlPropIndex\r\n            )\r\n          }\r\n        }\r\n      }\r\n    }\r\n    for (let index = 1; index < rightArray.length; index++) {\r\n      const prevCtrlProp = usrFrmData[rightArray[index - 1]].properties\r\n      const ctrlProp = usrFrmData[rightArray[index]].properties\r\n      let prevIndex = -1\r\n      const controlPropIndex = -1\r\n      if (type === 'Left') {\r\n        if (prevCtrlProp.GroupID === '' && ctrlProp.GroupID === '') {\r\n          propValue = prevCtrlProp.Left! + prevCtrlProp.Width!\r\n          this.updateControlProperty(type, propValue, rightArray[index])\r\n        } else {\r\n          if (prevCtrlProp.GroupID !== '') {\r\n            prevIndex = divstyle.findIndex(\r\n              (val) => val.groupName === prevCtrlProp.GroupID\r\n            )\r\n            propValue =\r\n              parseInt(divstyle[prevIndex].left!) +\r\n              parseInt(divstyle[prevIndex].width!)\r\n          } else {\r\n            propValue = prevCtrlProp.Left! + prevCtrlProp.Width!\r\n          }\r\n          if (ctrlProp.GroupID !== '') {\r\n            const getIndex = divstyle.findIndex(\r\n              (val) => val.groupName === ctrlProp.GroupID\r\n            )\r\n            EventBus.$emit('updasteGroupSize', type, propValue, getIndex)\r\n          } else {\r\n            this.updateControlProperty(type, propValue, rightArray[index])\r\n          }\r\n        }\r\n      } else if (type === 'Top') {\r\n        if (prevCtrlProp.GroupID === '' && ctrlProp.GroupID === '') {\r\n          propValue = prevCtrlProp.Top! + prevCtrlProp.Height!\r\n          this.updateControlProperty(type, propValue, rightArray[index])\r\n        } else {\r\n          if (prevCtrlProp.GroupID !== '') {\r\n            prevIndex = divstyle.findIndex(\r\n              (val) => val.groupName === prevCtrlProp.GroupID\r\n            )\r\n            propValue =\r\n              parseInt(divstyle[prevIndex].top!) +\r\n              parseInt(divstyle[prevIndex].height!)\r\n          } else {\r\n            propValue = prevCtrlProp.Top! + prevCtrlProp.Height!\r\n          }\r\n          if (ctrlProp.GroupID !== '') {\r\n            const getIndex = divstyle.findIndex(\r\n              (val) => val.groupName === ctrlProp.GroupID\r\n            )\r\n            EventBus.$emit('updasteGroupSize', type, propValue, getIndex)\r\n          } else {\r\n            this.updateControlProperty(type, propValue, rightArray[index])\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  updatePropVal (propName: string, propValue: number) {\r\n    const ctrlSel = this.selectedControls[this.userFormId].selected\r\n    const usrFrmData = this.userformData[this.userFormId]\r\n    for (let index = 0; index < ctrlSel.length; index++) {\r\n      if (!ctrlSel[index].startsWith('group')) {\r\n        const curProp = usrFrmData[ctrlSel[index]].properties\r\n        if (propName === 'selCenter') {\r\n          const curCenter = curProp.Width! / 2\r\n          const value = propValue - curCenter\r\n          this.updateControlProperty('Left', value, ctrlSel[index])\r\n        }\r\n        if (propName === 'selMiddle') {\r\n          const curMiddle = curProp.Height! / 2\r\n          const value = propValue - curMiddle\r\n          this.updateControlProperty('Top', value, ctrlSel[index])\r\n        }\r\n      } else {\r\n        let divstyle: Array<IGroupStyle> = []\r\n        EventBus.$emit('getGroupSize', (divstayleArray: Array<IGroupStyle>) => {\r\n          divstyle = divstayleArray\r\n        })\r\n        const groupIndex = divstyle.findIndex(\r\n          (val) => val.groupName === ctrlSel[index]\r\n        )\r\n        const curProp = divstyle[groupIndex]\r\n        const left = parseInt(curProp.left!)\r\n        const top = parseInt(curProp.top!)\r\n        const width = parseInt(curProp.width!)\r\n        const height = parseInt(curProp.height!)\r\n        let value = -1\r\n        if (propName === 'selCenter') {\r\n          value = propValue - width! / 2\r\n          EventBus.$emit('updasteGroupSize', 'Left', value, groupIndex)\r\n        }\r\n        if (propName === 'selMiddle') {\r\n          value = propValue - height! / 2\r\n          EventBus.$emit('updasteGroupSize', 'Top', value, groupIndex)\r\n        }\r\n      }\r\n    }\r\n  }\r\n  centreInForm (value: string) {\r\n    let divstyle: Array<IGroupStyle> = []\r\n    const mainContainer = this.selectedControls[this.userFormId].container[0]\r\n    const usrFrmData = this.userformData[this.userFormId]\r\n    const ctrlProp = usrFrmData[mainContainer].properties\r\n    if (value === 'horizontal') {\r\n      const selCenter = ctrlProp.Left! + ctrlProp.Width! / 2\r\n      this.updatePropVal('selCenter', selCenter)\r\n    } else if (value === 'vertical') {\r\n      const selMiddle = ctrlProp.Top! + ctrlProp.Height! / 2\r\n      this.updatePropVal('selMiddle', selMiddle)\r\n    }\r\n  }\r\n  arrangeButton (type: string) {\r\n    const usrFrmData = this.userformData[this.userFormId]\r\n    const ctrlSel = this.selectedControls[this.userFormId].selected\r\n    let ctrlContainer = this.selectedControls[this.userFormId].container[0]\r\n    ctrlContainer =\r\n      usrFrmData[ctrlContainer].type === 'Page'\r\n        ? this.selectedControls[this.userFormId].container[1]\r\n        : ctrlContainer\r\n    const buttonArray = []\r\n    for (let index = 0; index < ctrlSel.length; index++) {\r\n      if (!ctrlSel[index].startsWith('group')) {\r\n        const controlprop = usrFrmData[ctrlSel[index]]\r\n        if (controlprop.type === 'CommandButton') {\r\n          buttonArray.push(ctrlSel[index])\r\n        }\r\n      }\r\n    }\r\n    if (type === 'bottom') {\r\n      buttonArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Left! - usrFrmData[b].properties.Left!\r\n      })\r\n    } else if (type === 'right') {\r\n      buttonArray.sort((a, b) => {\r\n        return usrFrmData[a].properties.Top! - usrFrmData[b].properties.Top!\r\n      })\r\n    }\r\n    const containerProp = usrFrmData[ctrlContainer].properties\r\n    let value: number = 0\r\n    const containerHeight = (usrFrmData[ctrlContainer].type === 'Userform')\r\n      ? 47 : usrFrmData[ctrlContainer].type === 'Frame' ? 27\r\n        : usrFrmData[ctrlContainer].type === 'MultiPage' ? 40 : 0\r\n    const containerWidth = 20\r\n    if (type === 'bottom') {\r\n      value = (containerProp.Height! - containerHeight) - usrFrmData[buttonArray[0]].properties.Height!\r\n      this.updateControlProperty('Top', value, buttonArray[0])\r\n      this.updateControlProperty('Left', 30, buttonArray[0])\r\n    } else if (type === 'right') {\r\n      value = (containerProp.Width! - containerWidth) - usrFrmData[buttonArray[0]].properties.Width!\r\n      this.updateControlProperty('Left', value, buttonArray[0])\r\n      this.updateControlProperty('Top', 20, buttonArray[0])\r\n    }\r\n\r\n    for (let index = 1; index < buttonArray.length; index++) {\r\n      const prevCtrlProp = usrFrmData[buttonArray[index - 1]].properties\r\n      const ctrlProp = usrFrmData[buttonArray[index]].properties\r\n      if (type === 'bottom') {\r\n        let propValue = prevCtrlProp.Left! + prevCtrlProp.Width! + 10\r\n        value =\r\n          (containerProp.Height! - containerHeight) -\r\n          usrFrmData[buttonArray[index]].properties.Height!\r\n        if (propValue + ctrlProp.Width! <= containerProp.Width! - containerWidth) {\r\n          this.updateControlProperty('Left', propValue, buttonArray[index])\r\n          this.updateControlProperty('Top', value, buttonArray[index])\r\n        } else {\r\n          propValue = containerProp.Width! - containerWidth - ctrlProp.Width!\r\n          this.updateControlProperty('Left', propValue, buttonArray[index])\r\n          this.updateControlProperty('Top', value, buttonArray[index])\r\n        }\r\n      } else if (type === 'right') {\r\n        let propValue = prevCtrlProp.Top! + prevCtrlProp.Height! + 10\r\n        value =\r\n          (containerProp.Width! - containerWidth) -\r\n          usrFrmData[buttonArray[index]].properties.Width!\r\n        if (propValue + ctrlProp.Height! <= containerProp.Height! - (containerHeight)) {\r\n          this.updateControlProperty('Top', propValue, buttonArray[index])\r\n          this.updateControlProperty('Left', value, buttonArray[index])\r\n        } else {\r\n          propValue = containerProp.Height! - containerHeight - ctrlProp.Height!\r\n          this.updateControlProperty('Top', propValue, buttonArray[index])\r\n          this.updateControlProperty('Left', value, buttonArray[index])\r\n        }\r\n      }\r\n    }\r\n  }\r\n  updateControlProperty (\r\n    propertyName: keyof controlProperties,\r\n    propertyValue: any,\r\n    controlId: string\r\n  ) {\r\n    this.updateControl({\r\n      userFormId: this.userFormId,\r\n      controlId: controlId,\r\n      propertyName: propertyName,\r\n      value: propertyValue\r\n    })\r\n  }\r\n  getdisableStyle (id: string) {\r\n    let disabled: boolean = true\r\n    const selected = this.selectedControls[this.userFormId].selected\r\n    const selContainer = this.selectedControls[this.userFormId].container\r\n    const userData = this.userformData[this.userFormId]\r\n    if (id === 'unGroup') {\r\n      let groupId: boolean = false\r\n      const selectedGroupArray = selected.filter(\r\n        (val: string) => val.startsWith('group') && val\r\n      )\r\n      if (selectedGroupArray.length === 1 && selected.length === 1) {\r\n        disabled = false\r\n      }\r\n    }\r\n    if (id === 'group') {\r\n      disabled = selected.length <= 1\r\n    }\r\n    if (id === 'sizeToGrid' || id === 'centreInForm') {\r\n      disabled = !(selected.length >= 1 && selected[0] !== selContainer[0])\r\n    }\r\n    if (id === 'sizeToFit') {\r\n      const selSelected = []\r\n      for (const control of this.selectedControls[this.userFormId].selected) {\r\n        if (!control.startsWith('group')) {\r\n          const type = this.userformData[this.userFormId][control].type\r\n          if (type !== 'MultiPage' && type !== 'Frame' && type !== 'ListBox' && type !== 'Page' && type !== 'TabStrip' && type !== 'Userform') {\r\n            selSelected.push(control)\r\n          }\r\n        }\r\n      }\r\n      disabled = !(selSelected.length >= 1)\r\n    }\r\n    if (id === 'order') {\r\n      disabled = !(selected.length >= 1 && userData[selContainer[0]].controls.length >= 2)\r\n    }\r\n    if (id === 'makeEqual') {\r\n      disabled = !(selected.length >= 3)\r\n    }\r\n    if (id === 'incDecspacing' || id === 'removeSpace') {\r\n      disabled = !(selected.length >= 2)\r\n    }\r\n    if (id === 'arrangeButton') {\r\n      const buttonArray = []\r\n      for (let index = 0; index < selected.length; index++) {\r\n        if (!selected[index].startsWith('group')) {\r\n          const controlprop = userData[selected[index]]\r\n          if (controlprop.type === 'CommandButton') {\r\n            buttonArray.push(selected[index])\r\n          }\r\n        }\r\n      }\r\n      disabled = !(buttonArray.length >= 1)\r\n    }\r\n    return disabled\r\n  }\r\n  bringForward () {\r\n    const userData = this.userformData[this.userFormId]\r\n    const highProrControl = []\r\n    const lowProrControl = []\r\n    const container = this.getContainerList(this.getSelectedControlsDatas![0])[0]\r\n    const containerControls = this.userformData[this.userFormId][container].controls\r\n    for (const index in containerControls) {\r\n      const cntrlData = this.userformData[this.userFormId][containerControls[index]]\r\n      if (cntrlData.type === 'MultiPage' || cntrlData.type === 'Frame' || cntrlData.type === 'ListBox') {\r\n        highProrControl.push(containerControls[index])\r\n      } else {\r\n        lowProrControl.push(containerControls[index])\r\n      }\r\n    }\r\n    let nextSelctedSeries: string[] = []\r\n    let nextHighControlSeries: string[] = []\r\n    const getSelControl = [...this.getSelectedControlsDatas!]\r\n    getSelControl.sort((a, b) => {\r\n      return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n    })\r\n    for (const selControl of getSelControl!) {\r\n      const type = userData[selControl].type\r\n      const tempZIndex = userData[selControl].extraDatas!.zIndex!\r\n      const controlIndex = Object.keys(userData).findIndex((val: string, index: number) => {\r\n        return 'zIndex' in userData[val].extraDatas! && (userData[val].extraDatas!.zIndex === tempZIndex + 1)\r\n      })\r\n      const nextSelectedControl = controlIndex !== -1 ? Object.keys(userData)[controlIndex] : ''\r\n      const nextControlType = userData[nextSelectedControl].type\r\n      if (nextSelectedControl !== '' && !highProrControl.includes(nextSelectedControl)) {\r\n        if (getSelControl!.includes(nextSelectedControl)) {\r\n          if (!nextSelctedSeries.includes(selControl)) {\r\n            nextSelctedSeries.push(selControl)\r\n          }\r\n          if (!nextSelctedSeries.includes(nextSelectedControl)) {\r\n            nextSelctedSeries.push(nextSelectedControl)\r\n          }\r\n        } else {\r\n          if (Object.keys(nextSelctedSeries).length !== 0) {\r\n            const tempExchageIndex = userData[nextSelctedSeries[0]].extraDatas!.zIndex!\r\n            const swapTabIndex = userData[nextSelectedControl].extraDatas!.zIndex!\r\n            if (swapTabIndex <= userData[container].controls.length /* && swapTabIndex > 0 */) {\r\n              const index = userData[container].controls.findIndex(\r\n                (val) => userData[val].extraDatas!.zIndex === swapTabIndex\r\n              )\r\n              this.updateExtraDatas(userData[container].controls[index], 'zIndex', tempExchageIndex)\r\n              this.updateExtraDatas(nextSelctedSeries[0], 'zIndex', swapTabIndex - (nextSelctedSeries!.length - 1))\r\n            }\r\n            for (let j = 1; j < nextSelctedSeries.length; j++) {\r\n              const updateIndex = userData[nextSelctedSeries[j]].extraDatas!.zIndex! + 1\r\n              this.updateExtraDatas(nextSelctedSeries[j], 'zIndex', updateIndex)\r\n            }\r\n            nextSelctedSeries = []\r\n          } else {\r\n            const swapTabIndex = userData[nextSelectedControl].extraDatas!.zIndex!\r\n            if (swapTabIndex <= userData[container].controls.length /* && swapTabIndex > 0 */) {\r\n              const index = userData[container].controls.findIndex(\r\n                (val) => userData[val].extraDatas!.zIndex === swapTabIndex\r\n              )\r\n              this.updateExtraDatas(selControl, 'zIndex', swapTabIndex)\r\n              this.updateExtraDatas(nextSelectedControl, 'zIndex', tempZIndex)\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        if (getSelControl!.includes(nextSelectedControl) && (type === 'Frame' || type === 'MultiPage' || type === 'ListBox')) {\r\n          if (!nextHighControlSeries.includes(selControl)) {\r\n            nextHighControlSeries.push(selControl)\r\n          }\r\n          if (!nextHighControlSeries.includes(nextSelectedControl)) {\r\n            nextHighControlSeries.push(nextSelectedControl)\r\n          }\r\n        } else if (type === 'Frame' || type === 'MultiPage' || type === 'ListBox') {\r\n          if (Object.keys(nextHighControlSeries).length !== 0) {\r\n            const tempExchageIndex = userData[nextHighControlSeries[0]].extraDatas!.zIndex!\r\n            const swapTabIndex = userData[nextSelectedControl].extraDatas!.zIndex!\r\n            if (swapTabIndex <= userData[container].controls.length) {\r\n              const index = userData[container].controls.findIndex(\r\n                (val) => userData[val].extraDatas!.zIndex === swapTabIndex\r\n              )\r\n              this.updateExtraDatas(userData[container].controls[index], 'zIndex', tempExchageIndex)\r\n              this.updateExtraDatas(nextHighControlSeries[0], 'zIndex', swapTabIndex - (nextHighControlSeries!.length - 1))\r\n            }\r\n            for (let j = 1; j < nextHighControlSeries.length; j++) {\r\n              const updateIndex = userData[nextHighControlSeries[j]].extraDatas!.zIndex! + 1\r\n              this.updateExtraDatas(nextHighControlSeries[j], 'zIndex', updateIndex)\r\n            }\r\n            nextHighControlSeries = []\r\n          } else {\r\n            const swapTabIndex = userData[nextSelectedControl].extraDatas!.zIndex!\r\n            if (swapTabIndex <= userData[container].controls.length /* && swapTabIndex > 0 */) {\r\n              const index = userData[container].controls.findIndex(\r\n                (val) => userData[val].extraDatas!.zIndex === swapTabIndex\r\n              )\r\n              this.updateExtraDatas(selControl, 'zIndex', swapTabIndex)\r\n              this.updateExtraDatas(nextSelectedControl, 'zIndex', tempZIndex)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  sendBackward () {\r\n    const userData = this.userformData[this.userFormId]\r\n    const highProrControl = []\r\n    const lowProrControl = []\r\n    const container = this.getContainerList(this.getSelectedControlsDatas![0])[0]\r\n    const containerControls = this.userformData[this.userFormId][container].controls\r\n    for (const index in containerControls) {\r\n      const cntrlData = this.userformData[this.userFormId][containerControls[index]]\r\n      if (cntrlData.type === 'MultiPage' || cntrlData.type === 'Frame' || cntrlData.type === 'ListBox') {\r\n        highProrControl.push(containerControls[index])\r\n      } else {\r\n        lowProrControl.push(containerControls[index])\r\n      }\r\n    }\r\n    let nextSelctedSeries: string[] = []\r\n    let nextHighControlSeries: string[] = []\r\n    const getSelControl = [...this.getSelectedControlsDatas!]\r\n    getSelControl.sort((a, b) => {\r\n      return userData[a].extraDatas!.zIndex! - userData[b].extraDatas!.zIndex!\r\n    })\r\n    for (const selControl of getSelControl) {\r\n      const type = userData[selControl].type\r\n      const tempZIndex = userData[selControl].extraDatas!.zIndex!\r\n      const controlIndex = Object.keys(userData).findIndex((val: string, index: number) => {\r\n        return 'zIndex' in userData[val].extraDatas! && (userData[val].extraDatas!.zIndex === tempZIndex - 1)\r\n      })\r\n      const nextSelectedControl = controlIndex !== -1 ? Object.keys(userData)[controlIndex] : ''\r\n      const nextControlType = userData[nextSelectedControl].type\r\n      if (nextSelectedControl !== '' && !highProrControl.includes(selControl)) {\r\n        if (getSelControl!.includes(nextSelectedControl)) {\r\n          if (!nextSelctedSeries.includes(selControl)) {\r\n            nextSelctedSeries.push(selControl)\r\n          }\r\n          if (!nextSelctedSeries.includes(nextSelectedControl)) {\r\n            nextSelctedSeries.push(nextSelectedControl)\r\n          }\r\n        } else {\r\n          if (Object.keys(nextSelctedSeries).length !== 0) {\r\n            const tempExchageIndex = userData[nextSelctedSeries[0]].extraDatas!.zIndex!\r\n            const swapTabIndex = userData[nextSelectedControl].extraDatas!.zIndex!\r\n            if (swapTabIndex <= userData[container].controls.length && swapTabIndex > 0) {\r\n              const index = userData[container].controls.findIndex(\r\n                (val) => userData[val].extraDatas!.zIndex === swapTabIndex\r\n              )\r\n              this.updateExtraDatas(userData[container].controls[index], 'zIndex', tempExchageIndex)\r\n              this.updateExtraDatas(nextSelctedSeries[0], 'zIndex', (nextSelctedSeries!.length + 1) - swapTabIndex)\r\n            }\r\n            for (let j = 1; j < nextSelctedSeries.length; j++) {\r\n              const updateIndex = userData[nextSelctedSeries[j]].extraDatas!.zIndex! - 1\r\n              this.updateExtraDatas(nextSelctedSeries[j], 'zIndex', updateIndex)\r\n            }\r\n            nextSelctedSeries = []\r\n          } else {\r\n            const swapTabIndex = userData[nextSelectedControl].extraDatas!.zIndex!\r\n            if (swapTabIndex <= userData[container].controls.length && swapTabIndex > 0) {\r\n              const index = userData[container].controls.findIndex(\r\n                (val) => userData[val].extraDatas!.zIndex === swapTabIndex\r\n              )\r\n              this.updateExtraDatas(selControl, 'zIndex', swapTabIndex)\r\n              this.updateExtraDatas(nextSelectedControl, 'zIndex', tempZIndex)\r\n            }\r\n          }\r\n        }\r\n      } else if (!lowProrControl.includes(nextSelectedControl) && (type === 'Frame' || type === 'MultiPage' || type === 'ListBox')) {\r\n        if (getSelControl!.includes(nextSelectedControl)) {\r\n          if (!nextHighControlSeries.includes(selControl)) {\r\n            nextHighControlSeries.push(selControl)\r\n          }\r\n          if (!nextHighControlSeries.includes(nextSelectedControl)) {\r\n            nextHighControlSeries.push(nextSelectedControl)\r\n          }\r\n        } else {\r\n          if (Object.keys(nextHighControlSeries).length !== 0) {\r\n            const tempExchageIndex = userData[nextHighControlSeries[0]].extraDatas!.zIndex!\r\n            const swapTabIndex = userData[nextSelectedControl].extraDatas!.zIndex!\r\n            if (swapTabIndex <= userData[container].controls.length) {\r\n              const index = userData[container].controls.findIndex(\r\n                (val) => userData[val].extraDatas!.zIndex === swapTabIndex\r\n              )\r\n              this.updateExtraDatas(userData[container].controls[index], 'zIndex', tempExchageIndex)\r\n              this.updateExtraDatas(nextHighControlSeries[0], 'zIndex', (nextHighControlSeries!.length + 1) - swapTabIndex)\r\n            }\r\n            for (let j = 1; j < nextHighControlSeries.length; j++) {\r\n              const updateIndex = userData[nextHighControlSeries[j]].extraDatas!.zIndex! - 1\r\n              this.updateExtraDatas(nextHighControlSeries[j], 'zIndex', updateIndex)\r\n            }\r\n            nextHighControlSeries = []\r\n          } else {\r\n            const swapTabIndex = userData[nextSelectedControl].extraDatas!.zIndex!\r\n            if (swapTabIndex <= userData[container].controls.length && swapTabIndex > 0) {\r\n              const index = userData[container].controls.findIndex(\r\n                (val) => userData[val].extraDatas!.zIndex === swapTabIndex\r\n              )\r\n              this.updateExtraDatas(selControl, 'zIndex', swapTabIndex)\r\n              this.updateExtraDatas(nextSelectedControl, 'zIndex', tempZIndex)\r\n            }\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n"],"sourceRoot":""}]}